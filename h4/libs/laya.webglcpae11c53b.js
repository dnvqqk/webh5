!function(t,e,i){i.un,i.uns;var _=i.static,r=i.class,a=i.getset,n=(i.__newvec,laya.maths.Arith,laya.maths.Bezier),s=laya.resource.Bitmap,o=(laya.filters.BlurFilter,laya.filters.BlurFilterGLRender),h=laya.utils.Browser,u=(laya.utils.Byte,laya.display.css.CacheStyle,laya.filters.ColorFilter),l=laya.utils.ColorUtils,c=i.Config,f=laya.resource.Context,d=laya.display.cmd.DrawCanvasCmd,E=laya.display.cmd.DrawImageCmd,A=(laya.events.Event,laya.display.cmd.FillTextCmd),D=laya.filters.Filter,R=laya.utils.FontInfo,m=(laya.filters.GlowFilter,laya.filters.GlowFilterGLRender),T=laya.display.Graphics,P=laya.resource.HTMLCanvas,v=(laya.utils.HTMLChar,laya.resource.HTMLImage),p=(laya.utils.Handler,laya.maths.Matrix),C=laya.display.Node,M=(laya.utils.PerfHUD,laya.maths.Point),O=laya.utils.Pool,S=laya.maths.Rectangle,g=laya.renders.Render,y=laya.renders.RenderSprite,L=laya.resource.Resource,b=(laya.resource.ResourceManager,laya.display.cmd.RestoreCmd),B=laya.display.cmd.RotateCmd,I=laya.utils.RunDriver,x=laya.display.cmd.SaveCmd,N=laya.display.cmd.ScaleCmd,F=laya.display.Sprite,w=(laya.display.SpriteConst,laya.display.css.SpriteStyle,laya.display.Stage),V=laya.utils.Stat,U=laya.utils.StringKey,W=laya.system.System,G=laya.display.Text,X=laya.resource.Texture,k=laya.display.cmd.TransformCmd,z=laya.display.cmd.TranslateCmd,Y=laya.utils.VectorGraphManager;laya.utils.WordText;i.interface("laya.webgl.submit.ISubmit"),i.interface("laya.webgl.canvas.save.ISaveData");var H=function(){function t(){}r(t,"laya.webgl.canvas.save.SaveBase");var e=t.prototype;return i.imps(e,{"laya.webgl.canvas.save.ISaveData":!0}),e.isSaveMark=function(){return!1},e.restore=function(e){this._dataObj[this._valueName]=this._value,t.POOL[t.POOL._length++]=this,this._newSubmit&&(e._curSubmit=pt.RENDERBASE)},t._createArray=function(){var t=[];return t._length=0,t},t._init=function(){var e=t._namemap={};return e[1]="ALPHA",e[2]="fillStyle",e[8]="font",e[256]="lineWidth",e[512]="strokeStyle",e[8192]="_mergeID",e[1024]=e[2048]=e[4096]=[],e[16384]="textBaseline",e[32768]="textAlign",e[65536]="_nBlendType",e[1048576]="shader",e[2097152]="filters",e[8388608]="_colorFiler",e},t.save=function(e,i,_,r){if((e._saveMark._saveuse&i)!==i){e._saveMark._saveuse|=i;var a=t.POOL,n=a._length>0?a[--a._length]:new t;n._value=_[n._valueName=t._namemap[i]],n._dataObj=_,n._newSubmit=r;var s=e._save;s[s._length++]=n}},t.POOL=laya.webgl.canvas.save.SaveBase._createArray(),t._namemap=t._init(),t}(),Z=function(){function t(e,i){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this.ref=1,this._cacheID=0,this.clipMatDir=[99999999,0,0,99999999],this.clipMatPos=[0,0],this.defines=new Gt,this.mainID=e,this.subID=i,this.textureHost=null,this.texture=null,this.color=null,this.colorAdd=null,this.u_mmat2=null,this._cacheID=e|i,this._inClassCache=t._cache[this._cacheID],e>0&&!this._inClassCache&&(this._inClassCache=t._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}r(t,"laya.webgl.shader.d2.value.Value2D");var e=t.prototype;return e.setValue=function(t){},e._ShaderWithCompile=function(){return te.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,re.create,this._attribLocation)},e.upload=function(){var t=yt;yt.worldMatrix4===yt.TEMPMAT4_ARRAY||this.defines.addInt(128),this.mmat=t.worldMatrix4;var e=te.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();e._shaderValueWidth!==t.width||e._shaderValueHeight!==t.height?(this.size[0]=t.width,this.size[1]=t.height,e._shaderValueWidth=t.width,e._shaderValueHeight=t.height,e.upload(this,null)):e.upload(this,e._params2dQuick2||e._make2dQuick2())},e.setFilters=function(t){if(this.filters=t,t)for(var e,i=t.length,_=0;_<i;_++)(e=t[_])&&(this.defines.add(e.type),e.action.setValue(this))},e.clear=function(){this.defines._value=this.subID+(bt.shaderHighPrecision?1024:0)},e.release=function(){--this.ref<1&&(this._inClassCache&&(this._inClassCache[this._inClassCache._length++]=this),this.clear(),this.filters=null,this.ref=1)},t._initone=function(e,i){t._typeClass[e]=i,t._cache[e]=[],t._cache[e]._length=0},t.__init__=function(){t._initone(4,wt),t._initone(256,Ft),t._initone(512,Nt),t._initone(1,Vt),t._initone(65,qt),t._initone(9,Vt)},t.create=function(e,i){var _=t._cache[e|i];return _._length?_[--_._length]:new t._typeClass[e|i](i)},t._cache=[],t._typeClass=[],t.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t}(),j=(function(){function t(){this._paramData=new ParamData(4,!0)}r(t,"laya.layagl.cmdNative.AlphaCmdNative");var e=t.prototype;e.recover=function(){O.recover("AlphaCmd",this)},e.run=function(t,e,i){t.alpha(this._alpha)},a(0,e,"cmdID",function(){return"Alpha"}),a(0,e,"alpha",function(){return this._alpha},function(t){t=(t=t>1?1:t)<0?0:t,this._alpha=t;var e=16777215;e|=255*t<<24,this._paramData._int32Data[0]=e,$.syncBufferToRenderThread(this._paramData)}),t.create=function(e){var i=O.getItemByClass("AlphaCmd",t),_=i._graphicsCmdEncoder=this._commandEncoder;return i.alpha=e,_.setGlobalValueEx(it.GLOBALVALUE_DRAWTEXTURE_COLOR,15,i._paramData.getPtrID(),0),$.syncBufferToRenderThread(_),i},t.ID="Alpha"}(),function(){function t(){this._graphicsCmdEncoder=null,this._paramData=new ParamData(16,!0)}r(t,"laya.layagl.cmdNative.ClipRectCmdNative");var e=t.prototype;e.recover=function(){O.recover("ClipRectCmd",this)},a(0,e,"cmdID",function(){return"ClipRect"}),a(0,e,"width",function(){return 0},function(t){}),a(0,e,"x",function(){return 0},function(t){}),a(0,e,"y",function(){return 0},function(t){}),a(0,e,"height",function(){return 0},function(t){}),t.create=function(e,i,_,r){var a=O.getItemByClass("ClipRectCmd",t);a._graphicsCmdEncoder=this._commandEncoder;var n=a._graphicsCmdEncoder,s=a._paramData._float32Data;s[0]=e,s[1]=i,s[2]=_,s[3]=r;var o=a._paramData.getPtrID();return $.syncBufferToRenderThread(a._paramData),n.setClipValueEx(it.GLOBALVALUE_CLIP_MAT_DIR,it.GLOBALVALUE_CLIP_MAT_POS,it.GLOBALVALUE_MATRIX32,o),$.syncBufferToRenderThread(n),a},t.ID="ClipRect"}(),function(){function t(){this._graphicsCmdEncoder=null,this._index=0,this._paramData=null,this._texture=null,this._x=NaN,this._y=NaN,this._width=NaN,this._height=NaN}r(t,"laya.layagl.cmdNative.DrawCanvasCmdNative");var e=t.prototype;return e.recover=function(){this._graphicsCmdEncoder=null,O.recover("DrawCanvasCmd",this)},a(0,e,"cmdID",function(){return"DrawCanvasCmd"}),a(0,e,"y",function(){return this._y},function(e){this._y=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_+1]=this._y,i[t._PARAM_VB_POS_+7]=this._y,i[t._PARAM_VB_POS_+13]=this._y+this._height,i[t._PARAM_VB_POS_+19]=this._y+this._height,i[t._PARAM_CLIP_SIZE+1]=e+16,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"texture",function(){return this._texture},function(e){this._texture=e,this._paramData._int32Data[t._PARAM_TEXTURE_POS_]=this._texture._getSource().id;var i=this._paramData._float32Data,_=ie.flipyuv;i[t._PARAM_VB_POS_+2]=_[0],i[t._PARAM_VB_POS_+3]=_[1],i[t._PARAM_VB_POS_+8]=_[2],i[t._PARAM_VB_POS_+9]=_[3],i[t._PARAM_VB_POS_+14]=_[4],i[t._PARAM_VB_POS_+15]=_[5],i[t._PARAM_VB_POS_+20]=_[6],i[t._PARAM_VB_POS_+21]=_[7],$.syncBufferToRenderThread(this._paramData)}),a(0,e,"width",function(){return this._width},function(e){this._width=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_]=this._x,i[t._PARAM_VB_POS_+6]=this._x+this._width,i[t._PARAM_VB_POS_+12]=this._x+this._width,i[t._PARAM_VB_POS_+18]=this._x,i[t._PARAM_CLIP_SIZE+2]=e-32,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"x",function(){return this._x},function(e){this._x=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_]=this._x,i[t._PARAM_VB_POS_+6]=this._x+this._width,i[t._PARAM_VB_POS_+12]=this._x+this._width,i[t._PARAM_VB_POS_+18]=this._x,i[t._PARAM_CLIP_SIZE]=e+16,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"height",function(){return this._height},function(e){this._height=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_+1]=this._y,i[t._PARAM_VB_POS_+7]=this._y,i[t._PARAM_VB_POS_+13]=this._y+this._height,i[t._PARAM_VB_POS_+19]=this._y+this._height,i[t._PARAM_CLIP_SIZE+3]=e-32,$.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i,_,r,a){var n=O.getItemByClass("DrawCanvasCmd",t);n._graphicsCmdEncoder=this._commandEncoder,t.createCommandEncoder(),n._paramData||(n._paramData=new ParamData(132,!0)),n._texture=e,n._x=i,n._y=_,n._width=r,n._height=a,t.setParamData(n._paramData,e,i,_,r,a);var s=t._DRAW_CANVAS_CMD_ENCODER_.getPtrID(),o=n._paramData.getPtrID();return n._graphicsCmdEncoder.useCommandEncoder(s,o,-1),$.syncBufferToRenderThread(n._graphicsCmdEncoder),n},t.createCommandEncoder=function(){t._DRAW_CANVAS_CMD_ENCODER_||((t._DRAW_CANVAS_CMD_ENCODER_=$.instance.createCommandEncoder(124,32,!0)).useProgramEx(it.PROGRAMEX_DRAWTEXTURE),t._DRAW_CANVAS_CMD_ENCODER_.useVDO(it.VDO_MESHQUADTEXTURE),t._DRAW_CANVAS_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_CANVAS_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_CANVAS_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_CANVAS_CMD_ENCODER_.uniformTextureByParamData(0,4,4*t._PARAM_TEXTURE_POS_),t._DRAW_CANVAS_CMD_ENCODER_.setRectMeshByParamData(12,4*t._PARAM_VB_POS_,16),t._DRAW_CANVAS_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_CANVAS_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._DRAW_CANVAS_CMD_ENCODER_))},t.setParamData=function(e,i,_,r,a,n){var s=e._float32Data,o=e._int32Data;o[0]=3,o[1]=33984,o[t._PARAM_TEXTURE_POS_]=i._getSource().id,o[3]=1,o[4]=96;var h=0!=a?a:i.width,u=0!=n?n:i.height,l=ie.flipyuv,c=t._PARAM_VB_POS_;s[c++]=_,s[c++]=r,s[c++]=l[0],s[c++]=l[1],o[c++]=4294967295,o[c++]=4294967295,s[c++]=_+h,s[c++]=r,s[c++]=l[2],s[c++]=l[3],o[c++]=4294967295,o[c++]=4294967295,s[c++]=_+h,s[c++]=r+u,s[c++]=l[4],s[c++]=l[5],o[c++]=4294967295,o[c++]=4294967295,s[c++]=_,s[c++]=r+u,s[c++]=l[6],s[c++]=l[7],o[c++]=4294967295,o[c++]=4294967295,s[t._PARAM_CLIP_SIZE]=_+16,s[t._PARAM_CLIP_SIZE+1]=r+16,s[t._PARAM_CLIP_SIZE+2]=a-32,s[t._PARAM_CLIP_SIZE+3]=n-32,$.syncBufferToRenderThread(e)},t.ID="DrawCanvasCmd",t._DRAW_CANVAS_CMD_ENCODER_=null,t._PARAM_TEXTURE_POS_=2,t._PARAM_VB_POS_=5,t._PARAM_CLIP_SIZE=29,t}()),K=(function(){function t(){this._graphicsCmdEncoder=null,this._paramData=null,this._paramID=null,this._x=NaN,this._y=NaN,this._radius=NaN,this._fillColor=null,this._lineColor=null,this._lineWidth=NaN,this._vertNum=0,this._line_vertNum=0,this.ibBuffer=null,this.vbBuffer=null,this.line_ibBuffer=null,this.line_vbBuffer=null,this._ibSize=0,this._vbSize=0,this._line_ibSize=0,this._line_vbSize=0,this._cmdCurrentPos=0,this._points=[],this._linePoints=[],this._line_vbArray=[],this._line_ibArray=[]}r(t,"laya.layagl.cmdNative.DrawCircleCmdNative");var e=t.prototype;e._arc=function(t,e,i,_,r){void 0===_&&(_=!1),void 0===r&&(r=!0);var a=[],n=0,s=0,o=0,h=0,u=0,l=0,c=0,f=0;if(s=2*Math.PI-0,_)if(Math.abs(s)>=2*Math.PI)s=2*-Math.PI;else for(;s>0;)s-=2*Math.PI;else if(Math.abs(s)>=2*Math.PI)s=2*Math.PI;else for(;s<0;)s+=2*Math.PI;o=s/(f=i<101?Math.max(10,s*i/5):i<201?Math.max(10,s*i/20):Math.max(10,s*i/40))/2,h=Math.abs(4/3*(1-Math.cos(o))/Math.sin(o)),_&&(h=-h);for(c=0;c<=f;c++)n=0+s*(c/f),u=t+Math.cos(n)*i,l=e+Math.sin(n)*i,a.push(u),a.push(l);return a},e.recover=function(){this._fillColor=null,this._lineColor=null,this._points=null,this._linePoints=null,O.recover("DrawCircleCmd",this)},a(0,e,"lineColor",function(){return this._lineColor},function(e){!this._lineColor&&this._lineWidth&&(this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_CIRCLE_LINES_CMD_ENCODER_.getPtrID(),$.syncBufferToRenderThread(this._graphicsCmdEncoder)),this._lineColor=e,this._linePoints.length=0,this._line_ibArray.length=0,this._line_vbArray.length=0;for(var i=0;i<this._points.length;i++)this._linePoints.push(this._points[i]);this._linePoints.push(this._points[0]),this._linePoints.push(this._points[1]),Tt.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length;var _=this._line_vertNum;(!this.line_ibBuffer||this.line_ibBuffer.getByteLength()<3*(this._line_vertNum-2)*2)&&(this.line_ibBuffer=new ParamData(3*(_-2)*2,!0,!0)),this._line_ibSize=3*(this._line_vertNum-2)*2;for(var r=this.line_ibBuffer._int16Data,a=0,n=0;n<3*(this._line_vertNum-2);n++)r[a++]=this._line_ibArray[n];(!this.line_vbBuffer||this.line_vbBuffer.getByteLength()<3*this._line_vertNum*4)&&(this.line_vbBuffer=new ParamData(3*_*4,!0)),this._line_vbSize=3*this._line_vertNum*4;var s=l.create(e).numColor,o=this.line_vbBuffer._float32Data,h=this.line_vbBuffer._int32Data,u=0;for(i=0;i<this._line_vertNum;i++)o[u++]=this._line_vbArray[2*i]+this.x,o[u++]=this._line_vbArray[2*i+1]+this.y,h[u++]=s;var c=this._paramData._int32Data;c[t._PARAM_LINE_VB_POS_]=this.line_vbBuffer.getPtrID(),c[t._PARAM_LINE_IB_POS_]=this.line_ibBuffer.getPtrID(),c[t._PARAM_LINE_VB_SIZE_POS_]=this._line_vbSize,c[t._PARAM_LINE_IB_SIZE_POS_]=this._line_ibSize,$.syncBufferToRenderThread(this.line_vbBuffer),$.syncBufferToRenderThread(this.line_ibBuffer),$.syncBufferToRenderThread(this._paramData)}),a(0,e,"cmdID",function(){return"DrawCircle"}),a(0,e,"fillColor",function(){return this._fillColor},function(t){this._fillColor=t;for(var e=l.create(this._fillColor).numColor,i=this.vbBuffer._int32Data,_=0,r=0;r<this._vertNum;r++)_++,_++,i[_++]=e;$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"x",function(){return this._x},function(t){this._x=t;for(var e=this.vbBuffer._float32Data,i=0,_=0;_<this._vertNum;_++)e[i++]=this._points[2*_]+this._x,i++,i++;if(this._lineColor){var r=this.line_vbBuffer._float32Data;for(i=0,_=0;_<this._line_vertNum;_++)r[i++]=this._line_vbArray[2*_]+this._x,i++,i++;$.syncBufferToRenderThread(this.line_vbBuffer)}$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"y",function(){return this._y},function(t){this._y=t;for(var e=this.vbBuffer._float32Data,i=0,_=0;_<this._vertNum;_++)i++,e[i++]=this._points[2*_+1]+this._y,i++;if(this._lineColor){var r=this.line_vbBuffer._float32Data;for(i=0,_=0;_<this._line_vertNum;_++)i++,r[i++]=this._line_vbArray[2*_+1]+this._y,i++;$.syncBufferToRenderThread(this.line_vbBuffer)}$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"radius",function(){return this._radius},function(e){this._points=this._arc(0,0,e),this._vertNum=this._points.length/2;var i=this._vertNum,_=0;this._linePoints.length=0,this._line_ibArray.length=0,this._line_vbArray.length=0;var r=this._vertNum-2;(!this.ibBuffer||this.ibBuffer.getByteLength()<3*r*2)&&(this.ibBuffer=new ParamData(3*r*2,!0,!0)),this._ibSize=3*r*2;for(var a=this.ibBuffer._int16Data,n=0,s=0;s<r;s++)a[n++]=0,a[n++]=s+1+0,a[n++]=s+2+0;(!this.vbBuffer||this.vbBuffer.getByteLength()<3*this._vertNum*4)&&(this.vbBuffer=new ParamData(3*i*4,!0)),this._vbSize=3*this._vertNum*4;for(var o=l.create(this._fillColor).numColor,h=this.vbBuffer._float32Data,u=this.vbBuffer._int32Data,c=0,f=0;f<this._vertNum;f++)h[c++]=this._points[2*f]+this._x,h[c++]=this._points[2*f+1]+this._y,u[c++]=o;if(this._lineColor){for(f=0;f<this._points.length;f++)this._linePoints.push(this._points[f]);this._linePoints.push(this._points[0]),this._linePoints.push(this._points[1]),Tt.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length,_=this._line_vertNum,(!this.line_ibBuffer||this.line_ibBuffer.getByteLength()<3*(this._line_vertNum-2)*2)&&(this.line_ibBuffer=new ParamData(3*(_-2)*2,!0,!0)),this._line_ibSize=3*(this._line_vertNum-2)*2;var d=this.line_ibBuffer._int16Data;n=0;for(var E=0;E<3*(this._line_vertNum-2);E++)d[n++]=this._line_ibArray[E];(!this.line_vbBuffer||this.line_vbBuffer.getByteLength()<3*this._line_vertNum*4)&&(this.line_vbBuffer=new ParamData(3*_*4,!0)),this._line_vbSize=3*this._line_vertNum*4;var A=l.create(this._lineColor).numColor,D=this.line_vbBuffer._float32Data,R=this.line_vbBuffer._int32Data;for(c=0,f=0;f<this._line_vertNum;f++)D[c++]=this._line_vbArray[2*f]+this._x,D[c++]=this._line_vbArray[2*f+1]+this._y,R[c++]=A}var m=this._paramData._int32Data;m[t._PARAM_VB_POS_]=this.vbBuffer.getPtrID(),m[t._PARAM_IB_POS_]=this.ibBuffer.getPtrID(),m[t._PARAM_VB_SIZE_POS_]=this._vbSize,m[t._PARAM_IB_SIZE_POS_]=this._ibSize,$.syncBufferToRenderThread(this.vbBuffer),$.syncBufferToRenderThread(this.ibBuffer),this._lineColor&&(m[t._PARAM_LINE_VB_POS_]=this.line_vbBuffer.getPtrID(),m[t._PARAM_LINE_IB_POS_]=this.line_ibBuffer.getPtrID(),m[t._PARAM_LINE_VB_SIZE_POS_]=this._line_vbSize,m[t._PARAM_LINE_IB_SIZE_POS_]=this._line_ibSize,$.syncBufferToRenderThread(this.line_vbBuffer),$.syncBufferToRenderThread(this.line_ibBuffer)),$.syncBufferToRenderThread(this._paramData)}),a(0,e,"lineWidth",function(){return this._lineWidth},function(e){!this._lineWidth&&this._lineColor&&(this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_CIRCLE_LINES_CMD_ENCODER_.getPtrID(),$.syncBufferToRenderThread(this._graphicsCmdEncoder)),this._lineWidth=e,this._linePoints.length=0,this._line_ibArray.length=0,this._line_vbArray.length=0;for(var i=0;i<this._points.length;i++)this._linePoints.push(this._points[i]);this._linePoints.push(this._points[0]),this._linePoints.push(this._points[1]),Tt.createLine2(this._linePoints,this._line_ibArray,e,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length;var _=this._line_vertNum;(!this.line_ibBuffer||this.line_ibBuffer.getByteLength()<3*(this._line_vertNum-2)*2)&&(this.line_ibBuffer=new ParamData(3*(_-2)*2,!0,!0)),this._line_ibSize=3*(this._line_vertNum-2)*2;for(var r=this.line_ibBuffer._int16Data,a=0,n=0;n<3*(this._line_vertNum-2);n++)r[a++]=this._line_ibArray[n];(!this.line_vbBuffer||this.line_vbBuffer.getByteLength()<3*this._line_vertNum*4)&&(this.line_vbBuffer=new ParamData(3*_*4,!0)),this._line_vbSize=3*this._line_vertNum*4;var s=l.create(this._lineColor).numColor,o=this.line_vbBuffer._float32Data,h=this.line_vbBuffer._int32Data,u=0;for(i=0;i<this._line_vertNum;i++)o[u++]=this._line_vbArray[2*i]+this.x,o[u++]=this._line_vbArray[2*i+1]+this.y,h[u++]=s;var c=this._paramData._int32Data;c[t._PARAM_LINE_VB_POS_]=this.line_vbBuffer.getPtrID(),c[t._PARAM_LINE_IB_POS_]=this.line_ibBuffer.getPtrID(),c[t._PARAM_LINE_VB_SIZE_POS_]=this._line_vbSize,c[t._PARAM_LINE_IB_SIZE_POS_]=this._line_ibSize,$.syncBufferToRenderThread(this.line_vbBuffer),$.syncBufferToRenderThread(this.line_ibBuffer),$.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i,_,r,a,n,s){var o=O.getItemByClass("DrawCircleCmd",t);o._graphicsCmdEncoder=this._commandEncoder,t._DRAW_CIRCLE_LINES_CMD_ENCODER_||((t._DRAW_CIRCLE_LINES_CMD_ENCODER_=$.instance.createCommandEncoder(140,32,!0)).useProgramEx(it.PROGRAMEX_DRAWVG),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.useVDO(it.VDO_MESHVG),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_LINE_VB_POS_,4*t._PARAM_LINE_VB_OFFSET_POS_,4*t._PARAM_LINE_VB_SIZE_POS_,4*t._PARAM_LINE_IB_POS_,4*t._PARAM_LINE_IB_OFFSET_POS_,4*t._PARAM_LINE_IB_SIZE_POS_,4*t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._DRAW_CIRCLE_LINES_CMD_ENCODER_)),t._DRAW_CIRCLE_CMD_ENCODER_||((t._DRAW_CIRCLE_CMD_ENCODER_=$.instance.createCommandEncoder(88,32,!0)).useProgramEx(it.PROGRAMEX_DRAWVG),t._DRAW_CIRCLE_CMD_ENCODER_.useVDO(it.VDO_MESHVG),t._DRAW_CIRCLE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_CIRCLE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_CIRCLE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_CIRCLE_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_CIRCLE_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_CIRCLE_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._DRAW_CIRCLE_CMD_ENCODER_)),o._paramData||(o._paramData=new ParamData(72,!0)),o._x=e,o._y=i,o._radius=_,o._fillColor=r,o._lineColor=a,o._lineWidth=n,o._points=o._arc(0,0,_),o._vertNum=o._points.length/2;var h=o._vertNum,u=o._vertNum-2;(!o.ibBuffer||o.ibBuffer.getByteLength()<3*u*2)&&(o.ibBuffer=new ParamData(3*u*2,!0,!0)),o._ibSize=3*u*2;for(var c=o.ibBuffer._int16Data,f=0,d=0;d<u;d++)c[f++]=0,c[f++]=d+1+0,c[f++]=d+2+0;var E=l.create(r).numColor;(!o.vbBuffer||o.vbBuffer.getByteLength()<3*o._vertNum*4)&&(o.vbBuffer=new ParamData(3*h*4,!0)),o._vbSize=3*o._vertNum*4;for(var A=o.vbBuffer._float32Data,D=o.vbBuffer._int32Data,R=0,m=0;m<o._vertNum;m++)A[R++]=o._points[2*m]+e,A[R++]=o._points[2*m+1]+i,D[R++]=E;var T=0;for(m=0;m<o._points.length;m++)o._linePoints.push(o._points[m]);if(o._linePoints.push(o._points[0]),o._linePoints.push(o._points[1]),a){Tt.createLine2(o._linePoints,o._line_ibArray,n,0,o._line_vbArray,!1),o._line_vertNum=o._linePoints.length,T=o._line_vertNum,(!o.line_ibBuffer||o.line_ibBuffer.getByteLength()<3*(o._line_vertNum-2)*2)&&(o.line_ibBuffer=new ParamData(3*(T-2)*2,!0,!0)),o._line_ibSize=3*(o._line_vertNum-2)*2;var P=o.line_ibBuffer._int16Data;f=0;for(var v=0;v<3*(o._line_vertNum-2);v++)P[f++]=o._line_ibArray[v];(!o.line_vbBuffer||o.line_vbBuffer.getByteLength()<3*o._line_vertNum*4)&&(o.line_vbBuffer=new ParamData(3*T*4,!0)),o._line_vbSize=3*o._line_vertNum*4;var p=l.create(a),C=p.numColor,M=o.line_vbBuffer._float32Data,S=o.line_vbBuffer._int32Data;for(R=0,m=0;m<o._line_vertNum;m++)M[R++]=o._line_vbArray[2*m]+e,M[R++]=o._line_vbArray[2*m+1]+i,S[R++]=C}else{o._lineWidth=1;for(Tt.createLine2(o._linePoints,o._line_ibArray,o._lineWidth,0,o._line_vbArray,!1),o._line_vertNum=o._linePoints.length,T=o._line_vertNum,(!o.line_ibBuffer||o.line_ibBuffer.getByteLength()<3*(o._line_vertNum-2)*2)&&(o.line_ibBuffer=new ParamData(3*(T-2)*2,!0,!0)),o._line_ibSize=3*(o._line_vertNum-2)*2,P=o.line_ibBuffer._int16Data,f=0,v=0;v<3*(o._line_vertNum-2);v++)P[f++]=o._line_ibArray[v];for((!o.line_vbBuffer||o.line_vbBuffer.getByteLength()<3*o._line_vertNum*4)&&(o.line_vbBuffer=new ParamData(3*T*4,!0)),o._line_vbSize=3*o._line_vertNum*4,C=(p=l.create("#FFFFFF")).numColor,M=o.line_vbBuffer._float32Data,S=o.line_vbBuffer._int32Data,R=0,m=0;m<o._line_vertNum;m++)M[R++]=o._line_vbArray[2*m]+e,M[R++]=o._line_vbArray[2*m+1]+i,S[R++]=C}var g=o._paramData._float32Data,y=o._paramData._int32Data;return y[0]=1,y[1]=32,y[t._PARAM_VB_POS_]=o.vbBuffer.getPtrID(),y[t._PARAM_IB_POS_]=o.ibBuffer.getPtrID(),y[t._PARAM_VB_SIZE_POS_]=o._vbSize,y[t._PARAM_IB_SIZE_POS_]=o._ibSize,y[t._PARAM_VB_OFFSET_POS_]=0,y[t._PARAM_IB_OFFSET_POS_]=0,y[t._PARAM_INDEX_ELEMENT_OFFSET_POS_]=0,$.syncBufferToRenderThread(o.vbBuffer),$.syncBufferToRenderThread(o.ibBuffer),y[t._PARAM_LINE_VB_POS_]=o.line_vbBuffer.getPtrID(),y[t._PARAM_LINE_IB_POS_]=o.line_ibBuffer.getPtrID(),g[t._PARAM_LINECOLOR_POS_]=a,g[t._PARAM_LINEWIDTH_POS_]=n,y[t._PARAM_LINE_VB_SIZE_POS_]=o._line_vbSize,y[t._PARAM_LINE_IB_SIZE_POS_]=o._line_ibSize,y[t._PARAM_LINE_VB_OFFSET_POS_]=0,y[t._PARAM_LINE_IB_OFFSET_POS_]=0,y[t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_]=0,$.syncBufferToRenderThread(o.line_vbBuffer),$.syncBufferToRenderThread(o.line_ibBuffer),$.syncBufferToRenderThread(o._paramData),o._cmdCurrentPos=a?o._graphicsCmdEncoder.useCommandEncoder(t._DRAW_CIRCLE_LINES_CMD_ENCODER_.getPtrID(),o._paramData.getPtrID(),-1):o._graphicsCmdEncoder.useCommandEncoder(t._DRAW_CIRCLE_CMD_ENCODER_.getPtrID(),o._paramData.getPtrID(),-1),$.syncBufferToRenderThread(o._graphicsCmdEncoder),o},t.ID="DrawCircle",t._DRAW_CIRCLE_CMD_ENCODER_=null,t._DRAW_CIRCLE_LINES_CMD_ENCODER_=null,t._PARAM_VB_POS_=2,t._PARAM_IB_POS_=3,t._PARAM_LINE_VB_POS_=4,t._PARAM_LINE_IB_POS_=5,t._PARAM_LINECOLOR_POS_=6,t._PARAM_LINEWIDTH_POS_=7,t._PARAM_VB_SIZE_POS_=8,t._PARAM_IB_SIZE_POS_=9,t._PARAM_LINE_VB_SIZE_POS_=10,t._PARAM_LINE_IB_SIZE_POS_=11,t._PARAM_VB_OFFSET_POS_=12,t._PARAM_IB_OFFSET_POS_=13,t._PARAM_LINE_VB_OFFSET_POS_=14,t._PARAM_LINE_IB_OFFSET_POS_=15,t._PARAM_INDEX_ELEMENT_OFFSET_POS_=16,t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_=17}(),function(){function t(){this._graphicsCmdEncoder=null,this._paramData=null,this._x=0,this._y=0,this._points=[],this._lineColor=null,this._lineWidth=NaN,this.lastOriX=0,this.lastOriY=0,this.tArray=[],this._vertNum=0,this.ibBuffer=null,this.vbBuffer=null,this._ibSize=0,this._vbSize=0,this._ibArray=[],this._vbArray=[]}r(t,"laya.layagl.cmdNative.DrawCurvesCmdNative");var e=t.prototype;e._getPoints=function(t){var e=[];this._points.push(t[0]),this._points.push(t[1]);for(var i=2,_=t.length;i<_;)this._quadraticCurveTo(e,t[i++],t[i++],t[i++],t[i++]);return e},e._quadraticCurveTo=function(t,e,i,_,r){var a=n.I;0==this.tArray.length?(this.lastOriX=this._points[0],this.lastOriY=this._points[1]):(this.lastOriX=this.tArray[this.tArray.length-2],this.lastOriY=this.tArray[this.tArray.length-1]),this.tArray=a.getBezierPoints([this.lastOriX,this.lastOriY,e,i,_,r],30,2);for(var s=2,o=this.tArray.length;s<o;s++)t.push(this.tArray[s])},e.recover=function(){this._points=null,this._lineColor=null,O.recover("DrawCurvesCmd",this)},a(0,e,"lineColor",function(){return this._lineColor},function(t){this._lineColor=t;for(var e=l.create(this._lineColor).numColor,i=this.vbBuffer._int32Data,_=0,r=0;r<this._vertNum;r++)_++,_++,i[_++]=e;$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"points",function(){return this._points},function(e){this._points.length=0,this.lastOriX=0,this.lastOriY=0,this._points=this._getPoints(e),this._ibArray.length=0,this._vbArray.length=0,Tt.createLine2(this._points,this._ibArray,this.lineWidth,0,this._vbArray,!1);var i=l.create(this._lineColor).numColor;this._vertNum=this._points.length;var _=this._vertNum;(!this.vbBuffer||this.vbBuffer.getByteLength()<3*this._vertNum*4)&&(this.vbBuffer=new ParamData(3*_*4,!0)),this._vbSize=3*this._vertNum*4;for(var r=this.vbBuffer._float32Data,a=this.vbBuffer._int32Data,n=0,s=0;s<this._vertNum;s++)r[n++]=this._vbArray[2*s]+this.x,r[n++]=this._vbArray[2*s+1]+this.y,a[n++]=i;(!this.ibBuffer||this.ibBuffer.getByteLength()<3*(this._vertNum-2)*2)&&(this.ibBuffer=new ParamData(3*(_-2)*2,!0,!0)),this._ibSize=3*(this._vertNum-2)*2;for(var o=this.ibBuffer._int16Data,h=0;h<3*(this._vertNum-2);h++)o[h]=this._ibArray[h];(a=this._paramData._int32Data)[t._PARAM_VB_SIZE_POS_]=this._vbSize,a[t._PARAM_IB_SIZE_POS_]=this._ibSize,$.syncBufferToRenderThread(this.ibBuffer),$.syncBufferToRenderThread(this.vbBuffer),$.syncBufferToRenderThread(this._paramData)}),a(0,e,"cmdID",function(){return"DrawCurves"}),a(0,e,"x",function(){return this._x},function(t){this._x=t;for(var e=this.vbBuffer._float32Data,i=0,_=0;_<this._vertNum;_++)e[i++]=this._vbArray[2*_]+this._x,i++,i++;$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"y",function(){return this._y},function(t){this._y=t;for(var e=this.vbBuffer._float32Data,i=0,_=0;_<this._vertNum;_++)i++,e[i++]=this._vbArray[2*_+1]+this._y,i++;$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"lineWidth",function(){return this._lineWidth},function(t){this._lineWidth=t,this._ibArray.length=0,this._vbArray.length=0,Tt.createLine2(this._points,this._ibArray,this._lineWidth,0,this._vbArray,!1);for(var e=this.vbBuffer._float32Data,i=0,_=0;_<this._vertNum;_++)e[i++]=this._vbArray[2*_]+this.x,e[i++]=this._vbArray[2*_+1]+this.y,i++;$.syncBufferToRenderThread(this.vbBuffer)}),t.create=function(e,i,_,r,a){var n=O.getItemByClass("DrawCurvesCmd",t);n._graphicsCmdEncoder=this._commandEncoder,t._DRAW_CURVES_CMD_ENCODER_||((t._DRAW_CURVES_CMD_ENCODER_=$.instance.createCommandEncoder(88,32,!0)).useProgramEx(it.PROGRAMEX_DRAWVG),t._DRAW_CURVES_CMD_ENCODER_.useVDO(it.VDO_MESHVG),t._DRAW_CURVES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_CURVES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_CURVES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_CURVES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_CURVES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_CURVES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._DRAW_CURVES_CMD_ENCODER_)),n._paramData||(n._paramData=new ParamData(32,!0)),n._x=e,n._y=i,n._lineColor=r,n._lineWidth=a,n._points=n._getPoints(_),Tt.createLine2(n._points,n._ibArray,a,0,n._vbArray,!1);var s=l.create(r).numColor;n._vertNum=n._points.length;var o=n._vertNum;(!n.vbBuffer||n.vbBuffer.getByteLength()<3*n._vertNum*4)&&(n.vbBuffer=new ParamData(3*o*4,!0)),n._vbSize=3*n._vertNum*4;for(var h=n.vbBuffer._float32Data,u=n.vbBuffer._int32Data,c=0,f=0;f<n._vertNum;f++)h[c++]=n._vbArray[2*f]+e,h[c++]=n._vbArray[2*f+1]+i,u[c++]=s;(!n.ibBuffer||n.ibBuffer.getByteLength()<3*(n._vertNum-2)*2)&&(n.ibBuffer=new ParamData(3*(o-2)*2,!0,!0)),n._ibSize=3*(n._vertNum-2)*2;for(var d=n.ibBuffer._int16Data,E=0;E<3*(n._vertNum-2);E++)d[E]=n._ibArray[E];n._paramData._float32Data;return u=n._paramData._int32Data,u[0]=1,u[t._PARAM_VB_POS_]=n.vbBuffer.getPtrID(),u[t._PARAM_IB_POS_]=n.ibBuffer.getPtrID(),u[t._PARAM_VB_SIZE_POS_]=n._vbSize,u[t._PARAM_IB_SIZE_POS_]=n._ibSize,u[t._PARAM_VB_OFFSET_POS_]=0,u[t._PARAM_IB_OFFSET_POS_]=0,u[t._PARAM_INDEX_ELEMENT_OFFSET_POS_]=0,$.syncBufferToRenderThread(n.vbBuffer),$.syncBufferToRenderThread(n.ibBuffer),$.syncBufferToRenderThread(n._paramData),n._graphicsCmdEncoder.useCommandEncoder(t._DRAW_CURVES_CMD_ENCODER_.getPtrID(),n._paramData.getPtrID(),-1),$.syncBufferToRenderThread(n._graphicsCmdEncoder),n},t.ID="DrawCurves",t._DRAW_CURVES_CMD_ENCODER_=null,t._PARAM_VB_POS_=1,t._PARAM_IB_POS_=2,t._PARAM_VB_SIZE_POS_=3,t._PARAM_IB_SIZE_POS_=4,t._PARAM_VB_OFFSET_POS_=5,t._PARAM_IB_OFFSET_POS_=6,t._PARAM_INDEX_ELEMENT_OFFSET_POS_=7}(),function(){function t(){this._graphicsCmdEncoder=null,this._index=0,this._paramData=null,this._texture=null,this._x=NaN,this._y=NaN,this._width=NaN,this._height=NaN}r(t,"laya.layagl.cmdNative.DrawImageCmdNative");var e=t.prototype;e.recover=function(){this._graphicsCmdEncoder=null,O.recover("DrawImageCmd",this)},a(0,e,"cmdID",function(){return"DrawImage"}),a(0,e,"y",function(){return this._y},function(e){this._y=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_+1]=this._y,i[t._PARAM_VB_POS_+7]=this._y,i[t._PARAM_VB_POS_+13]=this._y+this._height,i[t._PARAM_VB_POS_+19]=this._y+this._height,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"texture",function(){return this._texture},function(e){this._texture=e,this._paramData._int32Data[t._PARAM_TEXTURE_POS_]=this._texture.bitmap._glTexture.id;var i=this._paramData._float32Data,_=this._texture.uv;i[t._PARAM_VB_POS_+2]=_[0],i[t._PARAM_VB_POS_+3]=_[1],i[t._PARAM_VB_POS_+8]=_[2],i[t._PARAM_VB_POS_+9]=_[3],i[t._PARAM_VB_POS_+14]=_[4],i[t._PARAM_VB_POS_+15]=_[5],i[t._PARAM_VB_POS_+20]=_[6],i[t._PARAM_VB_POS_+21]=_[7],$.syncBufferToRenderThread(this._paramData)}),a(0,e,"width",function(){return this._width},function(e){this._width=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_]=this._x,i[t._PARAM_VB_POS_+6]=this._x+this._width,i[t._PARAM_VB_POS_+12]=this._x+this._width,i[t._PARAM_VB_POS_+18]=this._x,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"x",function(){return this._x},function(e){this._x=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_]=this._x,i[t._PARAM_VB_POS_+6]=this._x+this._width,i[t._PARAM_VB_POS_+12]=this._x+this._width,i[t._PARAM_VB_POS_+18]=this._x,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"height",function(){return this._height},function(e){this._height=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_+1]=this._y,i[t._PARAM_VB_POS_+7]=this._y,i[t._PARAM_VB_POS_+13]=this._y+this._height,i[t._PARAM_VB_POS_+19]=this._y+this._height,$.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i,_,r,a){var n=O.getItemByClass("DrawImageCmd",t);n._graphicsCmdEncoder=this._commandEncoder,t._DRAW_IMAGE_CMD_ENCODER_||((t._DRAW_IMAGE_CMD_ENCODER_=$.instance.createCommandEncoder(124,32,!0)).useProgramEx(it.PROGRAMEX_DRAWTEXTURE),t._DRAW_IMAGE_CMD_ENCODER_.useVDO(it.VDO_MESHQUADTEXTURE),t._DRAW_IMAGE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_IMAGE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_IMAGE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_IMAGE_CMD_ENCODER_.uniformTextureByParamData(0,4,4*t._PARAM_TEXTURE_POS_),t._DRAW_IMAGE_CMD_ENCODER_.blendFuncByGlobalValue(it.GLOBALVALUE_BLENDFUNC_SRC,it.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_IMAGE_CMD_ENCODER_.setRectMeshByParamData(12,4*t._PARAM_VB_POS_,16),t._DRAW_IMAGE_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_IMAGE_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._DRAW_IMAGE_CMD_ENCODER_)),n._paramData||(n._paramData=new ParamData(116,!0)),n._texture=e,n._x=i,n._y=_,n._width=r,n._height=a;var s=n._paramData._float32Data,o=n._paramData._int32Data;o[0]=3,o[1]=33984,o[t._PARAM_TEXTURE_POS_]=e.bitmap._glTexture.id,o[3]=1,o[4]=96;var h=0!=r?r:e.bitmap.width,u=0!=a?a:e.bitmap.height,l=e.uv,c=t._PARAM_VB_POS_;return s[c++]=i,s[c++]=_,s[c++]=l[0],s[c++]=l[1],o[c++]=4294967295,o[c++]=4294967295,s[c++]=i+h,s[c++]=_,s[c++]=l[2],s[c++]=l[3],o[c++]=4294967295,o[c++]=4294967295,s[c++]=i+h,s[c++]=_+u,s[c++]=l[4],s[c++]=l[5],o[c++]=4294967295,o[c++]=4294967295,s[c++]=i,s[c++]=_+u,s[c++]=l[6],s[c++]=l[7],o[c++]=4294967295,o[c++]=4294967295,$.syncBufferToRenderThread(n._paramData),n._graphicsCmdEncoder.useCommandEncoder(t._DRAW_IMAGE_CMD_ENCODER_.getPtrID(),n._paramData.getPtrID(),-1),$.syncBufferToRenderThread(n._graphicsCmdEncoder),n},t.ID="DrawImage",t._DRAW_IMAGE_CMD_ENCODER_=null,t._PARAM_TEXTURE_POS_=2,t._PARAM_VB_POS_=5}(),function(){function t(){this._graphicsCmdEncoder=null,this._paramData=null,this._fromX=NaN,this._fromY=NaN,this._toX=NaN,this._toY=NaN,this._lineColor=null,this._lineWidth=NaN,this._vid=0}r(t,"laya.layagl.cmdNative.DrawLineCmdNative");var e=t.prototype;e.recover=function(){O.recover("DrawLineCmd",this)},a(0,e,"lineColor",function(){return this._lineColor},function(e){this._lineColor=e;var i=l.create(this.lineColor).numColor,_=this._paramData._int32Data,r=t._PARAM_VB_POS_;r++,r++,_[r++]=i,r++,r++,_[r++]=i,r++,r++,_[r++]=i,r++,r++,_[r++]=i,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"cmdID",function(){return"DrawLine"}),a(0,e,"toY",function(){return this._toY},function(e){this._toY=e;var i=[this._fromX,this._fromY,this._toX,this._toY],_=[],r=[];Tt.createLine2(i,r,this._lineWidth,0,_,!1);var a=this._paramData._float32Data,n=(this._paramData._int32Data,this._paramData._int16Data),s=t._PARAM_VB_POS_;a[s++]=_[0],a[s++]=_[1],s++,a[s++]=_[2],a[s++]=_[3],s++,a[s++]=_[4],a[s++]=_[5],s++,a[s++]=_[6],a[s++]=_[7],s++;var o=2*t._PARAM_IB_POS_;n[o++]=r[0],n[o++]=r[1],n[o++]=r[2],n[o++]=r[3],n[o++]=r[4],n[o++]=r[5],$.syncBufferToRenderThread(this._paramData)}),a(0,e,"fromX",function(){return this._fromX},function(e){this._fromX=e;var i=[this._fromX,this._fromY,this._toX,this._toY],_=[],r=[];Tt.createLine2(i,r,this._lineWidth,0,_,!1);var a=this._paramData._float32Data,n=(this._paramData._int32Data,this._paramData._int16Data),s=t._PARAM_VB_POS_;a[s++]=_[0],a[s++]=_[1],s++,a[s++]=_[2],a[s++]=_[3],s++,a[s++]=_[4],a[s++]=_[5],s++,a[s++]=_[6],a[s++]=_[7],s++;var o=2*t._PARAM_IB_POS_;n[o++]=r[0],n[o++]=r[1],n[o++]=r[2],n[o++]=r[3],n[o++]=r[4],n[o++]=r[5],$.syncBufferToRenderThread(this._paramData)}),a(0,e,"vid",function(){return this._vid},function(t){this._vid=t}),a(0,e,"toX",function(){return this._toX},function(e){this._toX=e;var i=[this._fromX,this._fromY,this._toX,this._toY],_=[],r=[];Tt.createLine2(i,r,this._lineWidth,0,_,!1);var a=this._paramData._float32Data,n=(this._paramData._int32Data,this._paramData._int16Data),s=t._PARAM_VB_POS_;a[s++]=_[0],a[s++]=_[1],s++,a[s++]=_[2],a[s++]=_[3],s++,a[s++]=_[4],a[s++]=_[5],s++,a[s++]=_[6],a[s++]=_[7],s++;var o=2*t._PARAM_IB_POS_;n[o++]=r[0],n[o++]=r[1],n[o++]=r[2],n[o++]=r[3],n[o++]=r[4],n[o++]=r[5],$.syncBufferToRenderThread(this._paramData)}),a(0,e,"fromY",function(){return this._fromY},function(e){this._fromY=e;var i=[this._fromX,this._fromY,this._toX,this._toY],_=[],r=[];Tt.createLine2(i,r,this._lineWidth,0,_,!1);var a=this._paramData._float32Data,n=(this._paramData._int32Data,this._paramData._int16Data),s=t._PARAM_VB_POS_;a[s++]=_[0],a[s++]=_[1],s++,a[s++]=_[2],a[s++]=_[3],s++,a[s++]=_[4],a[s++]=_[5],s++,a[s++]=_[6],a[s++]=_[7],s++;var o=2*t._PARAM_IB_POS_;n[o++]=r[0],n[o++]=r[1],n[o++]=r[2],n[o++]=r[3],n[o++]=r[4],n[o++]=r[5],$.syncBufferToRenderThread(this._paramData)}),a(0,e,"lineWidth",function(){return this._lineWidth},function(e){this._lineWidth=e;var i=[this._fromX,this._fromY,this._toX,this._toY],_=[],r=[];Tt.createLine2(i,r,this.lineWidth,0,_,!1);var a=this._paramData._float32Data,n=(this._paramData._int32Data,this._paramData._int16Data),s=t._PARAM_VB_POS_;a[s++]=_[0],a[s++]=_[1],s++,a[s++]=_[2],a[s++]=_[3],s++,a[s++]=_[4],a[s++]=_[5],s++,a[s++]=_[6],a[s++]=_[7],s++;var o=2*t._PARAM_IB_POS_;n[o++]=r[0],n[o++]=r[1],n[o++]=r[2],n[o++]=r[3],n[o++]=r[4],n[o++]=r[5],$.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i,_,r,a,n,s){var o=O.getItemByClass("DrawLineCmd",t);o._graphicsCmdEncoder=this._commandEncoder,t._DRAW_LINE_CMD_ENCODER_||((t._DRAW_LINE_CMD_ENCODER_=$.instance.createCommandEncoder(84,32,!0)).useProgramEx(it.PROGRAMEX_DRAWVG),t._DRAW_LINE_CMD_ENCODER_.useVDO(it.VDO_MESHVG),t._DRAW_LINE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_LINE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_LINE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_LINE_CMD_ENCODER_.setMeshByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,8,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_LINE_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_LINE_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._DRAW_LINE_CMD_ENCODER_)),o._paramData||(o._paramData=new ParamData(96,!0)),o._fromX=e,o._fromY=i,o._toX=_,o._toY=r,o._lineColor=a,o._lineWidth=n,o._vid=s;var h=l.create(a).numColor,u=[e,i,_,r],c=[],f=[];Tt.createLine2(u,f,n,0,c,!1);var d=o._paramData._float32Data,E=o._paramData._int32Data,A=o._paramData._int16Data;E[0]=1,E[1]=48,E[2]=12,E[t._PARAM_VB_OFFSET_POS_]=0,E[t._PARAM_IB_OFFSET_POS_]=0,E[t._PARAM_INDEX_ELEMENT_OFFSET_POS_]=0;var D=t._PARAM_VB_POS_;d[D++]=c[0],d[D++]=c[1],E[D++]=h,d[D++]=c[2],d[D++]=c[3],E[D++]=h,d[D++]=c[4],d[D++]=c[5],E[D++]=h,d[D++]=c[6],d[D++]=c[7],E[D++]=h;var R=2*t._PARAM_IB_POS_;return A[R++]=f[0],A[R++]=f[1],A[R++]=f[2],A[R++]=f[3],A[R++]=f[4],A[R++]=f[5],d[t._PARAM_LINECOLOR_POS_]=a||4278190335,d[t._PARAM_LINEWIDTH_POS_]=n,d[t._PARAM_VID_POS_]=s,$.syncBufferToRenderThread(o._paramData),o._graphicsCmdEncoder.useCommandEncoder(t._DRAW_LINE_CMD_ENCODER_.getPtrID(),o._paramData.getPtrID(),-1),$.syncBufferToRenderThread(o._graphicsCmdEncoder),o},t.ID="DrawLine",t._DRAW_LINE_CMD_ENCODER_=null,t._PARAM_VB_POS_=3,t._PARAM_IB_POS_=15,t._PARAM_LINECOLOR_POS_=18,t._PARAM_LINEWIDTH_POS_=19,t._PARAM_VID_POS_=20,t._PARAM_VB_OFFSET_POS_=21,t._PARAM_IB_OFFSET_POS_=22,t._PARAM_INDEX_ELEMENT_OFFSET_POS_=23}(),function(){function t(){this._graphicsCmdEncoder=null,this._paramData=null,this._x=NaN,this._y=NaN,this._points=null,this._lineColor=null,this._lineWidth=NaN,this._vid=0,this._vertNum=0,this.ibBuffer=null,this.vbBuffer=null,this._ibSize=0,this._vbSize=0,this._ibArray=[],this._vbArray=[]}r(t,"laya.layagl.cmdNative.DrawLinesCmdNative");var e=t.prototype;e.recover=function(){this._points=null,this._lineColor=null,O.recover("DrawLinesCmd",this)},a(0,e,"lineColor",function(){return this._lineColor},function(t){this._lineColor=t;for(var e=l.create(this._lineColor).numColor,i=this.vbBuffer._int32Data,_=0,r=0;r<this._vertNum;r++)_++,_++,i[_++]=e;$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"points",function(){return this._points},function(e){this._points=e,this._ibArray.length=0,this._vbArray.length=0,Tt.createLine2(this._points,this._ibArray,this._lineWidth,0,this._vbArray,!1);var i=l.create(this._lineColor).numColor;this._vertNum=this._points.length;var _=this._vertNum;(!this.vbBuffer||this.vbBuffer.getByteLength()<3*this._vertNum*4)&&(this.vbBuffer=new ParamData(3*_*4,!0)),this._vbSize=3*this._vertNum*4;for(var r=this.vbBuffer._float32Data,a=this.vbBuffer._int32Data,n=0,s=0;s<this._vertNum;s++)r[n++]=this._vbArray[2*s]+this.x,r[n++]=this._vbArray[2*s+1]+this.y,a[n++]=i;(!this.ibBuffer||this.ibBuffer.getByteLength()<3*(this._vertNum-2)*2)&&(this.ibBuffer=new ParamData(3*(_-2)*2,!0,!0)),this._ibSize=3*(this._vertNum-2)*2;for(var o=this.ibBuffer._int16Data,h=0;h<3*(this._vertNum-2);h++)o[h]=this._ibArray[h];(a=this._paramData._int32Data)[t._PARAM_VB_SIZE_POS_]=this._vbSize,a[t._PARAM_IB_SIZE_POS_]=this._ibSize,$.syncBufferToRenderThread(this.ibBuffer),$.syncBufferToRenderThread(this.vbBuffer),$.syncBufferToRenderThread(this._paramData)}),a(0,e,"cmdID",function(){return"DrawLines"}),a(0,e,"x",function(){return this._x},function(t){this._x=t;for(var e=this.vbBuffer._float32Data,i=0,_=0;_<this._vertNum;_++)e[i++]=this._vbArray[2*_]+this._x,i++,i++;$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"vid",function(){return this._vid},function(t){this._vid=t}),a(0,e,"y",function(){return this._y},function(t){this._y=t;for(var e=this.vbBuffer._float32Data,i=0,_=0;_<this._vertNum;_++)i++,e[i++]=this._vbArray[2*_+1]+this._y,i++;$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"lineWidth",function(){return this._lineWidth},function(t){this._lineWidth=t,this._ibArray.length=0,this._vbArray.length=0,Tt.createLine2(this._points,this._ibArray,this._lineWidth,0,this._vbArray,!1);for(var e=this.vbBuffer._float32Data,i=0,_=0;_<this._vertNum;_++)e[i++]=this._vbArray[2*_]+this.x,e[i++]=this._vbArray[2*_+1]+this.y,i++;$.syncBufferToRenderThread(this.vbBuffer)}),t.create=function(e,i,_,r,a,n){var s=O.getItemByClass("DrawLinesCmd",t);s._graphicsCmdEncoder=this._commandEncoder,t._DRAW_LINES_CMD_ENCODER_||((t._DRAW_LINES_CMD_ENCODER_=$.instance.createCommandEncoder(88,32,!0)).useProgramEx(it.PROGRAMEX_DRAWVG),t._DRAW_LINES_CMD_ENCODER_.useVDO(it.VDO_MESHVG),t._DRAW_LINES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_LINES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_LINES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_LINES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_LINES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_LINES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._DRAW_LINES_CMD_ENCODER_)),s._paramData||(s._paramData=new ParamData(44,!0)),s._x=e,s._y=i,s._points=_,s._lineColor=r,s._lineWidth=a,s._vid=n,Tt.createLine2(_,s._ibArray,a,0,s._vbArray,!1);var o=l.create(r).numColor;s._vertNum=_.length;var h=s._vertNum;(!s.vbBuffer||s.vbBuffer.getByteLength()<3*s._vertNum*4)&&(s.vbBuffer=new ParamData(3*h*4,!0)),s._vbSize=3*s._vertNum*4;for(var u=s.vbBuffer._float32Data,c=s.vbBuffer._int32Data,f=0,d=0;d<s._vertNum;d++)u[f++]=s._vbArray[2*d]+e,u[f++]=s._vbArray[2*d+1]+i,c[f++]=o;(!s.ibBuffer||s.ibBuffer.getByteLength()<3*(s._vertNum-2)*2)&&(s.ibBuffer=new ParamData(3*(h-2)*2,!0,!0)),s._ibSize=3*(s._vertNum-2)*2;for(var E=s.ibBuffer._int16Data,A=0;A<3*(s._vertNum-2);A++)E[A]=s._ibArray[A];var D=s._paramData._float32Data;return c=s._paramData._int32Data,c[0]=1,c[t._PARAM_VB_POS_]=s.vbBuffer.getPtrID(),c[t._PARAM_IB_POS_]=s.ibBuffer.getPtrID(),D[t._PARAM_LINECOLOR_POS_]=r||4278190335,D[t._PARAM_LINEWIDTH_POS_]=a,D[t._PARAM_VID_POS_]=n,c[t._PARAM_VB_SIZE_POS_]=s._vbSize,c[t._PARAM_IB_SIZE_POS_]=s._ibSize,c[t._PARAM_VB_OFFSET_POS_]=0,c[t._PARAM_IB_OFFSET_POS_]=0,c[t._PARAM_INDEX_ELEMENT_OFFSET_POS_]=0,$.syncBufferToRenderThread(s.vbBuffer),$.syncBufferToRenderThread(s.ibBuffer),$.syncBufferToRenderThread(s._paramData),s._graphicsCmdEncoder.useCommandEncoder(t._DRAW_LINES_CMD_ENCODER_.getPtrID(),s._paramData.getPtrID(),-1),$.syncBufferToRenderThread(s._graphicsCmdEncoder),s},t.ID="DrawLines",t._DRAW_LINES_CMD_ENCODER_=null,t._PARAM_VB_POS_=1,t._PARAM_IB_POS_=2,t._PARAM_LINECOLOR_POS_=3,t._PARAM_LINEWIDTH_POS_=4,t._PARAM_VID_POS_=5,t._PARAM_VB_SIZE_POS_=6,t._PARAM_IB_SIZE_POS_=7,t._PARAM_VB_OFFSET_POS_=8,t._PARAM_IB_OFFSET_POS_=9,t._PARAM_INDEX_ELEMENT_OFFSET_POS_=10}(),function(){function t(){this._graphicsCmdEncoder=null,this._paramData=null,this.vbBuffer=null,this._template=null,this._floatCountPerVertex=29,this._firstNewElement=0,this._firstFreeElement=0,this._firstActiveElement=0,this._firstRetiredElement=0,this._maxParticleNum=0}r(t,"laya.layagl.cmdNative.DrawParticleCmdNative");var e=t.prototype;e.updateParticle=function(){if(this._template.texture){this._template.updateParticleForNative();var e=this._template.sv,i=this._paramData._int32Data,_=this._paramData._float32Data;_[t._PARAM_CURRENTTIME_POS_]=e.u_CurrentTime,_[t._PARAM_DURATION_POS_]=e.u_Duration,_[t._PARAM_ENDVEL_POS_]=e.u_EndVelocity,_[t._PARAM_GRAVITY_POS_]=e.u_Gravity[0],_[t._PARAM_GRAVITY_POS_+1]=e.u_Gravity[1],_[t._PARAM_GRAVITY_POS_+2]=e.u_Gravity[2],e.size[0]=yt.width,e.size[1]=yt.height,_[t._PARAM_SIZE_POS_]=e.size[0],_[t._PARAM_SIZE_POS_+1]=e.size[1],_[t._PARAM_MAT_POS_]=1,_[t._PARAM_MAT_POS_+1]=0,_[t._PARAM_MAT_POS_+2]=0,_[t._PARAM_MAT_POS_+3]=0,_[t._PARAM_MAT_POS_+4]=0,_[t._PARAM_MAT_POS_+5]=1,_[t._PARAM_MAT_POS_+6]=0,_[t._PARAM_MAT_POS_+7]=0,_[t._PARAM_MAT_POS_+8]=0,_[t._PARAM_MAT_POS_+9]=0,_[t._PARAM_MAT_POS_+10]=1,_[t._PARAM_MAT_POS_+11]=0,_[t._PARAM_MAT_POS_+12]=0,_[t._PARAM_MAT_POS_+13]=0,_[t._PARAM_MAT_POS_+14]=0,_[t._PARAM_MAT_POS_+15]=1,i[t._PARAM_TEXTURE_LOC_POS_]=33984,i[t._PARAM_TEXTURE_POS_]=this._template.texture.bitmap._glTexture.id,this.vbBuffer=this._template.getConchMesh(),this._firstNewElement=this._template.getFirstNewElement(),this._firstFreeElement=this._template.getFirstFreeElement(),this._firstActiveElement=this._template.getFirstActiveElement(),this._firstRetiredElement=this._template.getFirstRetiredElement();var r=0,a=0,n=0,s=0,o=0,h=0;this._firstActiveElement!=this._firstFreeElement&&(this._firstActiveElement<this._firstFreeElement?(i[t._PARAM_REGDATA_POS_]=1,o=this._firstFreeElement-this._firstActiveElement,r=(this._firstFreeElement-this._firstActiveElement)*this._floatCountPerVertex*4*4,n=this._firstActiveElement*this._floatCountPerVertex*4*4):(i[t._PARAM_REGDATA_POS_]=0,o=this._maxParticleNum-this._firstActiveElement,r=(this._maxParticleNum-this._firstActiveElement)*this._floatCountPerVertex*4*4,n=this._firstActiveElement*this._floatCountPerVertex*4*4,this._firstFreeElement>0?(h=this._firstFreeElement,a=this._firstFreeElement*this._floatCountPerVertex*4*4,s=0):i[t._PARAM_REGDATA_POS_]=1)),i[t._PARAM_VB1_POS_]=this.vbBuffer.getPtrID(),i[t._PARAM_RECT1_NUM_POS_]=o,i[t._PARAM_VB1_SIZE_POS_]=r,i[t._PARAM_VB1_OFFSET_POS_]=n,$.syncBufferToRenderThread(this.vbBuffer),a>0&&(i[t._PARAM_VB2_POS_]=this.vbBuffer.getPtrID(),i[t._PARAM_RECT2_NUM_POS_]=h,i[t._PARAM_VB2_SIZE_POS_]=a,i[t._PARAM_VB2_OFFSET_POS_]=s),$.syncBufferToRenderThread(this._paramData),this._template.addDrawCounter()}},e.recover=function(){this._template=null,O.recover("DrawParticleCmd",this)},a(0,e,"cmdID",function(){return"DrawParticleCmd"}),t.create=function(e){var i=O.getItemByClass("DrawParticleCmd",t);i._graphicsCmdEncoder=this._commandEncoder,t._DRAW_PARTICLE_CMD_ENCODER_||((t._DRAW_PARTICLE_CMD_ENCODER_=$.instance.createCommandEncoder(84,32,!0)).useProgramEx(it.PROGRAMEX_DRAWPARTICLE),t._DRAW_PARTICLE_CMD_ENCODER_.useVDO(it.VDO_MESHPARTICLE),t._DRAW_PARTICLE_CMD_ENCODER_.uniformByParamData(0,4*t._PARAM_CURRENTTIME_POS_),t._DRAW_PARTICLE_CMD_ENCODER_.uniformByParamData(1,4*t._PARAM_DURATION_POS_),t._DRAW_PARTICLE_CMD_ENCODER_.uniformByParamData(2,4*t._PARAM_ENDVEL_POS_),t._DRAW_PARTICLE_CMD_ENCODER_.uniformByParamData(3,4*t._PARAM_GRAVITY_POS_),t._DRAW_PARTICLE_CMD_ENCODER_.uniformByParamData(4,4*t._PARAM_SIZE_POS_),t._DRAW_PARTICLE_CMD_ENCODER_.uniformByParamData(5,4*t._PARAM_MAT_POS_),t._DRAW_PARTICLE_CMD_ENCODER_.uniformTextureByParamData(4*t._PARAM_TEXTURE_UNIFORMLOC_POS_,4*t._PARAM_TEXTURE_LOC_POS_,4*t._PARAM_TEXTURE_POS_),t._DRAW_PARTICLE_CMD_ENCODER_.setRectMeshExByParamData(4*t._PARAM_RECT1_NUM_POS_,4*t._PARAM_VB1_POS_,4*t._PARAM_VB1_SIZE_POS_,4*t._PARAM_VB1_OFFSET_POS_),t._DRAW_PARTICLE_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,1,7),t._DRAW_PARTICLE_CMD_ENCODER_.loadDataToRegByParamData(0,4*t._PARAM_REGDATA_POS_,4),t._DRAW_PARTICLE_CMD_ENCODER_.ifGreater0(0,2),t._DRAW_PARTICLE_CMD_ENCODER_.setRectMeshExByParamData(4*t._PARAM_RECT2_NUM_POS_,4*t._PARAM_VB2_POS_,4*t._PARAM_VB2_SIZE_POS_,4*t._PARAM_VB2_OFFSET_POS_),t._DRAW_PARTICLE_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,1,7),$.syncBufferToRenderThread(t._DRAW_PARTICLE_CMD_ENCODER_)),i._paramData||(i._paramData=new ParamData(144,!0)),i._template=e,i._maxParticleNum=e.settings.maxPartices;var _=i._paramData._int32Data,r=(e._sv,i._paramData._float32Data),a=0;for(r[t._PARAM_CURRENTTIME_POS_]=-1,r[t._PARAM_DURATION_POS_]=-1,r[t._PARAM_ENDVEL_POS_]=-1,r[t._PARAM_GRAVITY_POS_]=-1,r[t._PARAM_GRAVITY_POS_+1]=-1,r[t._PARAM_GRAVITY_POS_+2]=-1,r[t._PARAM_SIZE_POS_]=-1,r[t._PARAM_SIZE_POS_+1]=-1,a=0;a<16;a++)r[t._PARAM_MAT_POS_+a]=-1;return _[t._PARAM_TEXTURE_LOC_POS_]=-1,_[t._PARAM_TEXTURE_POS_]=-1,_[t._PARAM_TEXTURE_UNIFORMLOC_POS_]=6,_[t._PARAM_REGDATA_POS_]=0,_[t._PARAM_VB1_POS_]=-1,_[t._PARAM_VB2_POS_]=-1,_[t._PARAM_VB1_SIZE_POS_]=-1,_[t._PARAM_VB2_SIZE_POS_]=-1,_[t._PARAM_RECT1_NUM_POS_]=-1,_[t._PARAM_RECT2_NUM_POS_]=-1,$.syncBufferToRenderThread(i._paramData),i._graphicsCmdEncoder.useCommandEncoder(t._DRAW_PARTICLE_CMD_ENCODER_.getPtrID(),i._paramData.getPtrID(),-1),$.syncBufferToRenderThread(i._graphicsCmdEncoder),i},t.ID="DrawParticleCmd",t._DRAW_PARTICLE_CMD_ENCODER_=null,t._PARAM_VB1_POS_=0,t._PARAM_VB2_POS_=1,t._PARAM_VB1_SIZE_POS_=2,t._PARAM_VB2_SIZE_POS_=3,t._PARAM_CURRENTTIME_POS_=4,t._PARAM_DURATION_POS_=5,t._PARAM_ENDVEL_POS_=6,t._PARAM_GRAVITY_POS_=7,t._PARAM_SIZE_POS_=10,t._PARAM_MAT_POS_=12,t._PARAM_TEXTURE_LOC_POS_=28,t._PARAM_TEXTURE_POS_=29,t._PARAM_REGDATA_POS_=30,t._PARAM_TEXTURE_UNIFORMLOC_POS_=31,t._PARAM_RECT1_NUM_POS_=32,t._PARAM_RECT2_NUM_POS_=33,t._PARAM_VB1_OFFSET_POS_=34,t._PARAM_VB2_OFFSET_POS_=35}(),function(){function t(){this._graphicsCmdEncoder=null,this._paramData=null,this._graphicsCmdEncoder_fill=null,this._paramData_fill=null,this._x=NaN,this._y=NaN,this._paths=null,this._brush=null,this._pen=null,this._vertNum=0,this._startOriX=0,this._startOriY=0,this._lastOriX=0,this._lastOriY=0,this.SEGNUM=32,this.lines_ibBuffer=null,this.lines_vbBuffer=null,this._lines_ibSize=0,this._lines_vbSize=0,this.fill_ibBuffer=null,this.fill_vbBuffer=null,this._fill_ibSize=0,this._fill_vbSize=0,this._cmdCurrentPos=0,this._points=[],this._lines_ibArray=[],this._lines_vbArray=[],this._fill_ibArray=[],this._fill_vbArray=[]}r(t,"laya.layagl.cmdNative.DrawPathCmdNative");var e=t.prototype;e._arcTo=function(t){var e=t[1],i=t[2],_=t[3],r=t[4],a=t[5],n=0,s=0,o=0,h=this._lastOriX-e,u=this._lastOriY-i,l=Math.sqrt(h*h+u*u);if(!(l<=1e-6)){var c=h/l,f=u/l,d=_-e,E=r-i,A=d*d+E*E,D=Math.sqrt(A);if(!(D<=1e-6)){var R=d/D,m=E/D,T=c+R,P=f+m,v=Math.sqrt(T*T+P*P);if(!(v<=1e-6)){var p=T/v,C=P/v,M=Math.acos(p*c+C*f),O=Math.PI/2-M,S=(l=a/Math.tan(O))*c+e,g=l*f+i,y=Math.sqrt(l*l+a*a),L=e+p*y,b=i+C*y,B=0,I=0,x=0;if(c*m-f*R>=0){var N=(B=2*O)/this.SEGNUM;I=Math.sin(N),x=Math.cos(N)}else N=(B=2*-O)/this.SEGNUM,I=Math.sin(N),x=Math.cos(N);var F=this._lastOriX,w=this._lastOriY,V=S-L,U=g-b;for(n=0;n<this.SEGNUM;n++){var W=V*x+U*I,G=-V*I+U*x;s=W+L,o=G+b,(Math.abs(F-s)>.1||Math.abs(w-o)>.1)&&(this._points.push(s),this._points.push(o)),V=W,U=G}}}}},e.recover=function(){this._paths=null,this._brush=null,this._pen=null,O.recover("DrawPathCmd",this)},a(0,e,"cmdID",function(){return"DrawPath"}),a(0,e,"paths",function(){return this._paths},function(t){this._paths=t}),a(0,e,"x",function(){return this._x},function(t){this._x=t;for(var e=this.lines_vbBuffer._float32Data,i=0,_=0;_<this._vertNum;_++)e[i++]=this._lines_vbArray[2*_]+t,i++,i++;$.syncBufferToRenderThread(this.lines_vbBuffer)}),a(0,e,"y",function(){return this._y},function(t){this._y=t;for(var e=this.lines_vbBuffer._float32Data,i=0,_=0;_<this._vertNum;_++)i++,e[i++]=this._lines_vbArray[2*_+1]+t,i++;$.syncBufferToRenderThread(this.lines_vbBuffer)}),a(0,e,"brush",function(){return this._brush},function(e){this._brush||(this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_LINES_FILL_CMD_ENCODER_.getPtrID(),$.syncBufferToRenderThread(this._graphicsCmdEncoder)),this._brush=e;var i=this._vertNum,_=Pt.earcut(this._points,null,2);if(_.length>0){(!this.fill_ibBuffer||this.fill_ibBuffer.getByteLength()<2*_.length)&&(this.fill_ibBuffer=new ParamData(2*_.length,!0,!0)),this._fill_ibSize=2*_.length;for(var r=this.fill_ibBuffer._int16Data,a=0,n=0;n<_.length;n++)r[a++]=_[n]}var s=l.create(e.fillStyle).numColor;(!this.fill_vbBuffer||this.fill_vbBuffer.getByteLength()<3*this._vertNum*4)&&(this.fill_vbBuffer=new ParamData(3*i*4,!0)),this._fill_vbSize=3*this._vertNum*4;for(var o=this.fill_vbBuffer._float32Data,h=this.fill_vbBuffer._int32Data,u=0,c=0;c<this._vertNum;c++)o[u++]=this._points[2*c]+this.x,o[u++]=this._points[2*c+1]+this.y,h[u++]=s;var f=this._paramData._int32Data;f[t._PARAM_FILL_VB_POS_]=this.fill_vbBuffer.getPtrID(),f[t._PARAM_FILL_IB_POS_]=this.fill_ibBuffer.getPtrID(),f[t._PARAM_FILL_VB_SIZE_POS_]=this._fill_vbSize,f[t._PARAM_FILL_IB_SIZE_POS_]=this._fill_ibSize,$.syncBufferToRenderThread(this.fill_vbBuffer),$.syncBufferToRenderThread(this.fill_ibBuffer),$.syncBufferToRenderThread(this._paramData)}),a(0,e,"pen",function(){return this._pen},function(e){this._pen=e,this._lines_ibArray.length=0,this._lines_vbArray.length=0,Tt.createLine2(this._points,this._lines_ibArray,e.lineWidth,0,this._lines_vbArray,!1);var i=l.create(e.strokeStyle).numColor,_=this._vertNum;(!this.lines_vbBuffer||this.lines_vbBuffer.getByteLength()<3*this._vertNum*4)&&(this.lines_vbBuffer=new ParamData(3*_*4,!0)),this._lines_vbSize=3*this._vertNum*4;for(var r=this.lines_vbBuffer._float32Data,a=this.lines_vbBuffer._int32Data,n=0,s=0;s<this._vertNum;s++)r[n++]=this._lines_vbArray[2*s]+this.x,r[n++]=this._lines_vbArray[2*s+1]+this.y,a[n++]=i;(!this.lines_ibBuffer||this.lines_ibBuffer.getByteLength()<3*(this._vertNum-2)*2)&&(this.lines_ibBuffer=new ParamData(3*(_-2)*2,!0,!0)),this._lines_ibSize=3*(this._vertNum-2)*2;for(var o=this.lines_ibBuffer._int16Data,h=0;h<3*(this._vertNum-2);h++)o[h]=this._lines_ibArray[h];(a=this._paramData._int32Data)[t._PARAM_LINES_VB_POS_]=this.lines_vbBuffer.getPtrID(),a[t._PARAM_LINES_IB_POS_]=this.lines_ibBuffer.getPtrID(),a[t._PARAM_LINES_VB_SIZE_POS_]=this._lines_vbSize,a[t._PARAM_LINES_IB_SIZE_POS_]=this._lines_ibSize,$.syncBufferToRenderThread(this.lines_vbBuffer),$.syncBufferToRenderThread(this.lines_ibBuffer),$.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i,_,r,a){var n=O.getItemByClass("DrawPathCmd",t);n._graphicsCmdEncoder=this._commandEncoder,t._DRAW_LINES_CMD_ENCODER_||((t._DRAW_LINES_CMD_ENCODER_=$.instance.createCommandEncoder(88,32,!0)).useProgramEx(it.PROGRAMEX_DRAWVG),t._DRAW_LINES_CMD_ENCODER_.useVDO(it.VDO_MESHVG),t._DRAW_LINES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_LINES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_LINES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_LINES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_LINES_VB_POS_,4*t._PARAM_LINE_VB_OFFSET_POS_,4*t._PARAM_LINES_VB_SIZE_POS_,4*t._PARAM_LINES_IB_POS_,4*t._PARAM_LINE_IB_OFFSET_POS_,4*t._PARAM_LINES_IB_SIZE_POS_,4*t._PARAM_FILL_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_LINES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_LINES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._DRAW_LINES_CMD_ENCODER_)),t._DRAW_FILL_CMD_ENCODER_||((t._DRAW_FILL_CMD_ENCODER_=$.instance.createCommandEncoder(88,32,!0)).useProgramEx(it.PROGRAMEX_DRAWVG),t._DRAW_FILL_CMD_ENCODER_.useVDO(it.VDO_MESHVG),t._DRAW_FILL_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_FILL_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_FILL_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_FILL_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_FILL_VB_POS_,4*t._PARAM_FILL_VB_OFFSET_POS_,4*t._PARAM_FILL_VB_SIZE_POS_,4*t._PARAM_FILL_IB_POS_,4*t._PARAM_FILL_IB_OFFSET_POS_,4*t._PARAM_FILL_IB_SIZE_POS_,4*t._PARAM_FILL_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_FILL_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_FILL_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._DRAW_FILL_CMD_ENCODER_)),t._DRAW_LINES_FILL_CMD_ENCODER_||((t._DRAW_LINES_FILL_CMD_ENCODER_=$.instance.createCommandEncoder(136,32,!0)).useProgramEx(it.PROGRAMEX_DRAWVG),t._DRAW_LINES_FILL_CMD_ENCODER_.useVDO(it.VDO_MESHVG),t._DRAW_LINES_FILL_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_LINES_FILL_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_LINES_FILL_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_LINES_FILL_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_FILL_VB_POS_,4*t._PARAM_FILL_VB_OFFSET_POS_,4*t._PARAM_FILL_VB_SIZE_POS_,4*t._PARAM_FILL_IB_POS_,4*t._PARAM_FILL_IB_OFFSET_POS_,4*t._PARAM_FILL_IB_SIZE_POS_,4*t._PARAM_FILL_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_LINES_FILL_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_LINES_FILL_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),t._DRAW_LINES_FILL_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_LINES_VB_POS_,4*t._PARAM_LINE_VB_OFFSET_POS_,4*t._PARAM_LINES_VB_SIZE_POS_,4*t._PARAM_LINES_IB_POS_,4*t._PARAM_LINE_IB_OFFSET_POS_,4*t._PARAM_LINES_IB_SIZE_POS_,4*t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_LINES_FILL_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_LINES_FILL_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._DRAW_LINES_FILL_CMD_ENCODER_)),n._paramData||(n._paramData=new ParamData(60,!0)),n._x=e,n._y=i,n._paths=_,n._brush=r,n._pen=a;for(var s=0,o=_.length;s<o;s++){var h=_[s];switch(0==s&&(n._startOriX=h[1],n._startOriY=h[2]),h[0]){case"moveTo":case"lineTo":n._lastOriX=h[1],n._lastOriY=h[2],n._points.push(h[1]),n._points.push(h[2]);break;case"arcTo":n._arcTo(h);break;case"closePath":n._points.push(n._startOriX),n._points.push(n._startOriY)}}if(n._vertNum=n._points.length,a){Tt.createLine2(n._points,n._lines_ibArray,a.lineWidth,0,n._lines_vbArray,!1);var u=l.create(a.strokeStyle),c=u.numColor,f=n._vertNum;(!n.lines_vbBuffer||n.lines_vbBuffer.getByteLength()<3*n._vertNum*4)&&(n.lines_vbBuffer=new ParamData(3*f*4,!0)),n._lines_vbSize=3*n._vertNum*4;var d=n.lines_vbBuffer._float32Data,E=n.lines_vbBuffer._int32Data,A=0;for(s=0;s<n._vertNum;s++)d[A++]=n._lines_vbArray[2*s]+e,d[A++]=n._lines_vbArray[2*s+1]+i,E[A++]=c;(!n.lines_ibBuffer||n.lines_ibBuffer.getByteLength()<3*(n._vertNum-2)*2)&&(n.lines_ibBuffer=new ParamData(3*(f-2)*2,!0,!0)),n._lines_ibSize=3*(n._vertNum-2)*2;for(var D=n.lines_ibBuffer._int16Data,R=0;R<3*(n._vertNum-2);R++)D[R]=n._lines_ibArray[R]}if(r){f=n._vertNum;var m=Pt.earcut(n._points,null,2);if(m.length>0){(!n.fill_ibBuffer||n.fill_ibBuffer.getByteLength()<2*m.length)&&(n.fill_ibBuffer=new ParamData(2*m.length,!0,!0)),n._fill_ibSize=2*m.length,D=n.fill_ibBuffer._int16Data;var T=0;for(R=0;R<m.length;R++)D[T++]=m[R]}c=(u=l.create(r.fillStyle)).numColor,(!n.fill_vbBuffer||n.fill_vbBuffer.getByteLength()<3*n._vertNum*4)&&(n.fill_vbBuffer=new ParamData(3*f*4,!0)),n._fill_vbSize=3*n._vertNum*4,d=n.fill_vbBuffer._float32Data;var P=n.fill_vbBuffer._int32Data;for(P=n.fill_vbBuffer._int32Data,A=0,s=0;s<n._vertNum;s++)d[A++]=n._points[2*s]+e,d[A++]=n._points[2*s+1]+i,P[A++]=c}n._paramData._float32Data;return E=n._paramData._int32Data,E[0]=1,a&&(E[t._PARAM_LINES_VB_POS_]=n.lines_vbBuffer.getPtrID(),E[t._PARAM_LINES_IB_POS_]=n.lines_ibBuffer.getPtrID(),E[t._PARAM_LINES_VB_SIZE_POS_]=n._lines_vbSize,E[t._PARAM_LINES_IB_SIZE_POS_]=n._lines_ibSize,E[t._PARAM_LINE_VB_OFFSET_POS_]=0,E[t._PARAM_LINE_IB_OFFSET_POS_]=0,E[t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_]=0,$.syncBufferToRenderThread(n.lines_vbBuffer),$.syncBufferToRenderThread(n.lines_ibBuffer)),r&&(E[t._PARAM_FILL_VB_POS_]=n.fill_vbBuffer.getPtrID(),E[t._PARAM_FILL_IB_POS_]=n.fill_ibBuffer.getPtrID(),E[t._PARAM_FILL_VB_SIZE_POS_]=n._fill_vbSize,E[t._PARAM_FILL_IB_SIZE_POS_]=n._fill_ibSize,E[t._PARAM_FILL_VB_OFFSET_POS_]=0,E[t._PARAM_FILL_IB_OFFSET_POS_]=0,E[t._PARAM_FILL_INDEX_ELEMENT_OFFSET_POS_]=0,$.syncBufferToRenderThread(n.fill_vbBuffer),$.syncBufferToRenderThread(n.fill_ibBuffer)),$.syncBufferToRenderThread(n._paramData),r&&a?n._cmdCurrentPos=n._graphicsCmdEncoder.useCommandEncoder(t._DRAW_LINES_FILL_CMD_ENCODER_.getPtrID(),n._paramData.getPtrID(),-1):r&&!a?n._cmdCurrentPos=n._graphicsCmdEncoder.useCommandEncoder(t._DRAW_FILL_CMD_ENCODER_.getPtrID(),n._paramData.getPtrID(),-1):!r&&a&&(n._cmdCurrentPos=n._graphicsCmdEncoder.useCommandEncoder(t._DRAW_LINES_CMD_ENCODER_.getPtrID(),n._paramData.getPtrID(),-1)),$.syncBufferToRenderThread(n._graphicsCmdEncoder),n},t.ID="DrawPath",t._DRAW_LINES_CMD_ENCODER_=null,t._DRAW_LINES_FILL_CMD_ENCODER_=null,t._DRAW_FILL_CMD_ENCODER_=null,t._PARAM_LINES_VB_POS_=1,t._PARAM_LINES_IB_POS_=2,t._PARAM_LINES_VB_SIZE_POS_=3,t._PARAM_LINES_IB_SIZE_POS_=4,t._PARAM_FILL_VB_POS_=5,t._PARAM_FILL_IB_POS_=6,t._PARAM_FILL_VB_SIZE_POS_=7,t._PARAM_FILL_IB_SIZE_POS_=8,t._PARAM_FILL_VB_OFFSET_POS_=9,t._PARAM_FILL_IB_OFFSET_POS_=10,t._PARAM_LINE_VB_OFFSET_POS_=11,t._PARAM_LINE_IB_OFFSET_POS_=12,t._PARAM_FILL_INDEX_ELEMENT_OFFSET_POS_=13,t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_=14}(),function(){function t(){this._graphicsCmdEncoder=null,this._paramData=null,this._paramID=null,this._x=NaN,this._y=NaN,this._radius=NaN,this._startAngle=NaN,this._endAngle=NaN,this._fillColor=null,this._lineColor=null,this._lineWidth=NaN,this._vertNum=0,this._line_vertNum=0,this.ibBuffer=null,this.vbBuffer=null,this.line_ibBuffer=null,this.line_vbBuffer=null,this._ibSize=0,this._vbSize=0,this._line_ibSize=0,this._line_vbSize=0,this._cmdCurrentPos=0,this._points=[],this._linePoints=[],this._line_vbArray=[],this._line_ibArray=[]}r(t,"laya.layagl.cmdNative.DrawPieCmdNative");var e=t.prototype;e._arc=function(t,e,i,_,r,a,n){void 0===a&&(a=!1),void 0===n&&(n=!0);var s=[];s.push(0),s.push(0);var o=0,h=0,u=0,l=0,c=0,f=0,d=0,E=0,A=0,D=0;if(h=r-_,a)if(Math.abs(h)>=2*Math.PI)h=2*-Math.PI;else for(;h>0;)h-=2*Math.PI;else if(Math.abs(h)>=2*Math.PI)h=2*Math.PI;else for(;h<0;)h+=2*Math.PI;u=h/(D=i<101?Math.max(10,h*i/5):i<201?Math.max(10,h*i/20):Math.max(10,h*i/40))/2,l=Math.abs(4/3*(1-Math.cos(u))/Math.sin(u)),a&&(l=-l);var R=0,m=0;for(A=0;A<=D;A++)o=_+h*(A/D),c=Math.cos(o),E=e+(f=Math.sin(o))*i,(d=t+c*i)==R&&E==m||(s.push(d),s.push(E)),R=d,m=E;return c=Math.cos(r),f=Math.sin(r),d=t+c*i,E=e+f*i,d==R&&E==m||(s.push(d),s.push(E)),s},e._setData=function(t,e,i,_,r,a){this._vertNum=_.length/2;var n=this._vertNum,s=this._vertNum-2;(!this.ibBuffer||this.ibBuffer.getByteLength()<3*s*2)&&(this.ibBuffer=new ParamData(3*s*2,!0,!0)),this._ibSize=3*s*2;for(var o=this.ibBuffer._int16Data,h=0,u=0;u<s;u++)o[h++]=0,o[h++]=u+1+0,o[h++]=u+2+0;(!this.vbBuffer||this.vbBuffer.getByteLength()<3*this._vertNum*4)&&(this.vbBuffer=new ParamData(3*n*4,!0)),this._vbSize=3*this._vertNum*4;for(var c=l.create(i).numColor,f=this.vbBuffer._float32Data,d=this.vbBuffer._int32Data,E=0,A=0;A<this._vertNum;A++)f[E++]=_[2*A]+t,f[E++]=_[2*A+1]+e,d[E++]=c;var D=0;for(this._linePoints.length=0,this._line_ibArray.length=0,this._line_vbArray.length=0,A=0;A<_.length;A++)this._linePoints.push(_[A]);if(this._linePoints.push(_[0]),this._linePoints.push(_[1]),r){Tt.createLine2(this._linePoints,this._line_ibArray,a,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length,D=this._line_vertNum,(!this.line_ibBuffer||this.line_ibBuffer.getByteLength()<3*(this._line_vertNum-2)*2)&&(this.line_ibBuffer=new ParamData(3*(D-2)*2,!0,!0)),this._line_ibSize=3*(this._line_vertNum-2)*2;var R=this.line_ibBuffer._int16Data;h=0;for(var m=0;m<3*(this._line_vertNum-2);m++)R[h++]=this._line_ibArray[m];(!this.line_vbBuffer||this.line_vbBuffer.getByteLength()<3*this._line_vertNum*4)&&(this.line_vbBuffer=new ParamData(3*D*4,!0)),this._line_vbSize=3*this._line_vertNum*4;var T=l.create(r),P=T.numColor,v=this.line_vbBuffer._float32Data,p=this.line_vbBuffer._int32Data;for(E=0,A=0;A<this._line_vertNum;A++)v[E++]=this._line_vbArray[2*A]+this._x,v[E++]=this._line_vbArray[2*A+1]+this._y,p[E++]=P}else{this._lineWidth=1;for(Tt.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length,D=this._line_vertNum,(!this.line_ibBuffer||this.line_ibBuffer.getByteLength()<3*(this._line_vertNum-2)*2)&&(this.line_ibBuffer=new ParamData(3*(D-2)*2,!0,!0)),this._line_ibSize=3*(this._line_vertNum-2)*2,R=this.line_ibBuffer._int16Data,h=0,m=0;m<3*(this._line_vertNum-2);m++)R[h++]=this._line_ibArray[m];for((!this.line_vbBuffer||this.line_vbBuffer.getByteLength()<3*this._line_vertNum*4)&&(this.line_vbBuffer=new ParamData(3*D*4,!0)),this._line_vbSize=3*this._line_vertNum*4,P=(T=l.create("#FFFFFF")).numColor,v=this.line_vbBuffer._float32Data,p=this.line_vbBuffer._int32Data,E=0,A=0;A<this._line_vertNum;A++)v[E++]=this._line_vbArray[2*A]+this._x,v[E++]=this._line_vbArray[2*A+1]+this._y,p[E++]=P}},e._saveToParamData=function(){this._paramData._float32Data;var e=this._paramData._int32Data;e[0]=1,e[1]=32,e[t._PARAM_VB_POS_]=this.vbBuffer.getPtrID(),e[t._PARAM_IB_POS_]=this.ibBuffer.getPtrID(),e[t._PARAM_VB_SIZE_POS_]=this._vbSize,e[t._PARAM_IB_SIZE_POS_]=this._ibSize,e[t._PARAM_VB_OFFSET_POS_]=0,e[t._PARAM_IB_OFFSET_POS_]=0,e[t._PARAM_INDEX_ELEMENT_OFFSET_POS_]=0,$.syncBufferToRenderThread(this.vbBuffer),$.syncBufferToRenderThread(this.ibBuffer),e[t._PARAM_LINE_VB_POS_]=this.line_vbBuffer.getPtrID(),e[t._PARAM_LINE_IB_POS_]=this.line_ibBuffer.getPtrID(),e[t._PARAM_LINE_VB_SIZE_POS_]=this._line_vbSize,e[t._PARAM_LINE_IB_SIZE_POS_]=this._line_ibSize,e[t._PARAM_LINE_VB_OFFSET_POS_]=0,e[t._PARAM_LINE_IB_OFFSET_POS_]=0,e[t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_]=0,$.syncBufferToRenderThread(this.line_vbBuffer),$.syncBufferToRenderThread(this.line_ibBuffer)},e.recover=function(){this._fillColor=null,this._lineColor=null,O.recover("DrawPieCmd",this)},a(0,e,"lineColor",function(){return this._lineColor},function(e){!this._lineColor&&this._lineWidth&&(this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_PIE_LINES_CMD_ENCODER_.getPtrID(),$.syncBufferToRenderThread(this._graphicsCmdEncoder)),this._lineColor=e,this._linePoints.length=0,this._line_ibArray.length=0,this._line_vbArray.length=0;for(var i=0;i<this._points.length;i++)this._linePoints.push(this._points[i]);this._linePoints.push(this._points[0]),this._linePoints.push(this._points[1]),Tt.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length;var _=this._line_vertNum;(!this.line_ibBuffer||this.line_ibBuffer.getByteLength()<3*(this._line_vertNum-2)*2)&&(this.line_ibBuffer=new ParamData(3*(_-2)*2,!0,!0)),this._line_ibSize=3*(this._line_vertNum-2)*2;for(var r=this.line_ibBuffer._int16Data,a=0,n=0;n<3*(this._line_vertNum-2);n++)r[a++]=this._line_ibArray[n];(!this.line_vbBuffer||this.line_vbBuffer.getByteLength()<3*this._line_vertNum*4)&&(this.line_vbBuffer=new ParamData(3*_*4,!0)),this._line_vbSize=3*this._line_vertNum*4;var s=l.create(e).numColor,o=this.line_vbBuffer._float32Data,h=this.line_vbBuffer._int32Data,u=0;for(i=0;i<this._line_vertNum;i++)o[u++]=this._line_vbArray[2*i]+this._x,o[u++]=this._line_vbArray[2*i+1]+this._y,h[u++]=s;$.syncBufferToRenderThread(this.line_ibBuffer),$.syncBufferToRenderThread(this.line_vbBuffer)}),a(0,e,"startAngle",function(){return 180*this._startAngle/Math.PI},function(t){this._startAngle=t*Math.PI/180,this._points=this._arc(0,0,this._radius,t*Math.PI/180,this._endAngle),this._setData(this._x,this._y,this._fillColor,this._points,this._lineColor,this._lineWidth),this._saveToParamData(),$.syncBufferToRenderThread(this._paramData)}),a(0,e,"cmdID",function(){return"DrawPie"}),a(0,e,"fillColor",function(){return this._fillColor},function(t){this._fillColor=t;for(var e=l.create(this._fillColor).numColor,i=this.vbBuffer._int32Data,_=0,r=0;r<this._vertNum;r++)_++,_++,i[_++]=e;$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"x",function(){return this._x},function(t){this._x=t;for(var e=this.vbBuffer._float32Data,i=0,_=0;_<this._vertNum;_++)e[i++]=this._points[2*_]+this._x,i++,i++;if(this._lineColor){var r=this.line_vbBuffer._float32Data;for(i=0,_=0;_<this._line_vertNum;_++)r[i++]=this._line_vbArray[2*_]+this._x,i++,i++;$.syncBufferToRenderThread(this.line_vbBuffer)}$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"y",function(){return this._y},function(t){this._y=t;for(var e=this.vbBuffer._float32Data,i=0,_=0;_<this._vertNum;_++)i++,e[i++]=this._points[2*_+1]+this._y,i++;if(this._lineColor){var r=this.line_vbBuffer._float32Data;for(i=0,_=0;_<this._line_vertNum;_++)i++,r[i++]=this._line_vbArray[2*_+1]+this._y,i++;$.syncBufferToRenderThread(this.line_vbBuffer)}$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"radius",function(){return this._radius},function(t){this._points=this._arc(0,0,t,this._startAngle,this._endAngle),this._setData(this._x,this._y,this._fillColor,this._points,this._lineColor,this._lineWidth),this._saveToParamData(),$.syncBufferToRenderThread(this._paramData)}),a(0,e,"endAngle",function(){return 180*this._endAngle/Math.PI},function(t){this._endAngle=t*Math.PI/180,this._points=this._arc(0,0,this._radius,this._startAngle,t*Math.PI/180),this._setData(this._x,this._y,this._fillColor,this._points,this._lineColor,this._lineWidth),this._saveToParamData(),$.syncBufferToRenderThread(this._paramData)}),a(0,e,"lineWidth",function(){return this._lineWidth},function(e){this.lineColor&&(this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_PIE_LINES_CMD_ENCODER_.getPtrID(),$.syncBufferToRenderThread(this._graphicsCmdEncoder)),this._lineWidth=e,this._linePoints.length=0,this._line_ibArray.length=0,this._line_vbArray.length=0;for(var i=0;i<this._points.length;i++)this._linePoints.push(this._points[i]);this._linePoints.push(this._points[0]),this._linePoints.push(this._points[1]),Tt.createLine2(this._linePoints,this._line_ibArray,e,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length;var _=this._line_vertNum;(!this.line_ibBuffer||this.line_ibBuffer.getByteLength()<3*(this._line_vertNum-2)*2)&&(this.line_ibBuffer=new ParamData(3*(_-2)*2,!0,!0)),this._line_ibSize=3*(this._line_vertNum-2)*2;for(var r=this.line_ibBuffer._int16Data,a=0,n=0;n<3*(this._line_vertNum-2);n++)r[a++]=this._line_ibArray[n];(!this.line_vbBuffer||this.line_vbBuffer.getByteLength()<3*this._line_vertNum*4)&&(this.line_vbBuffer=new ParamData(3*_*4,!0)),this._line_vbSize=3*this._line_vertNum*4;var s=l.create(this.lineColor).numColor,o=this.line_vbBuffer._float32Data,h=this.line_vbBuffer._int32Data,u=0;for(i=0;i<this._line_vertNum;i++)o[u++]=this._line_vbArray[2*i]+this._x,o[u++]=this._line_vbArray[2*i+1]+this._y,h[u++]=s;$.syncBufferToRenderThread(this.line_ibBuffer),$.syncBufferToRenderThread(this.line_vbBuffer)}),t.create=function(e,i,_,r,a,n,s,o,h){var u=O.getItemByClass("DrawPieCmd",t);return u._graphicsCmdEncoder=this._commandEncoder,t._DRAW_PIE_LINES_CMD_ENCODER_||((t._DRAW_PIE_LINES_CMD_ENCODER_=$.instance.createCommandEncoder(140,32,!0)).useProgramEx(it.PROGRAMEX_DRAWVG),t._DRAW_PIE_LINES_CMD_ENCODER_.useVDO(it.VDO_MESHVG),t._DRAW_PIE_LINES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_PIE_LINES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_PIE_LINES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_PIE_LINES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_PIE_LINES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_PIE_LINES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),t._DRAW_PIE_LINES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_LINE_VB_POS_,4*t._PARAM_LINE_VB_OFFSET_POS_,4*t._PARAM_LINE_VB_SIZE_POS_,4*t._PARAM_LINE_IB_POS_,4*t._PARAM_LINE_IB_OFFSET_POS_,4*t._PARAM_LINE_IB_SIZE_POS_,4*t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_PIE_LINES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_PIE_LINES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._DRAW_PIE_LINES_CMD_ENCODER_)),t._DRAW_PIE_CMD_ENCODER_||((t._DRAW_PIE_CMD_ENCODER_=$.instance.createCommandEncoder(88,32,!0)).useProgramEx(it.PROGRAMEX_DRAWVG),t._DRAW_PIE_CMD_ENCODER_.useVDO(it.VDO_MESHVG),t._DRAW_PIE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_PIE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_PIE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_PIE_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_PIE_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_PIE_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._DRAW_PIE_CMD_ENCODER_)),u._paramData||(u._paramData=new ParamData(64,!0)),u._x=e,u._y=i,u._radius=_,u._startAngle=r,u._endAngle=a,u._fillColor=n,u._lineColor=s,u._lineWidth=o,u._points=u._arc(0,0,_,r,a),u._setData(e,i,n,u._points,s,o),u._saveToParamData(),$.syncBufferToRenderThread(u._paramData),u._cmdCurrentPos=s?u._graphicsCmdEncoder.useCommandEncoder(t._DRAW_PIE_LINES_CMD_ENCODER_.getPtrID(),u._paramData.getPtrID(),-1):u._graphicsCmdEncoder.useCommandEncoder(t._DRAW_PIE_CMD_ENCODER_.getPtrID(),u._paramData.getPtrID(),-1),$.syncBufferToRenderThread(u._graphicsCmdEncoder),u},t.ID="DrawPie",t._DRAW_PIE_CMD_ENCODER_=null,t._DRAW_PIE_LINES_CMD_ENCODER_=null,t._PARAM_VB_POS_=2,t._PARAM_IB_POS_=3,t._PARAM_LINE_VB_POS_=4,t._PARAM_LINE_IB_POS_=5,t._PARAM_VB_SIZE_POS_=6,t._PARAM_IB_SIZE_POS_=7,t._PARAM_LINE_VB_SIZE_POS_=8,t._PARAM_LINE_IB_SIZE_POS_=9,t._PARAM_VB_OFFSET_POS_=10,t._PARAM_IB_OFFSET_POS_=11,t._PARAM_LINE_VB_OFFSET_POS_=12,t._PARAM_LINE_IB_OFFSET_POS_=13,t._PARAM_INDEX_ELEMENT_OFFSET_POS_=14,t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_=15}(),function(){function t(){this._graphicsCmdEncoder=null,this._graphicsCmdEncoder_lines=null,this._paramData=null,this._x=NaN,this._y=NaN,this._points=null,this._fillColor=null,this._lineColor=null,this._lineWidth=NaN,this._isConvexPolygon=!1,this._vid=0,this._vertNum=0,this._line_vertNum=0,this.ibBuffer=null,this.vbBuffer=null,this.line_ibBuffer=null,this.line_vbBuffer=null,this._ibSize=0,this._vbSize=0,this._line_ibSize=0,this._line_vbSize=0,this._cmdCurrentPos=0,this._linePoints=[],this._line_vbArray=[],this._line_ibArray=[]}r(t,"laya.layagl.cmdNative.DrawPolyCmdNative");var e=t.prototype;e.recover=function(){this._points=null,this._fillColor=null,this._lineColor=null,O.recover("DrawPolyCmd",this)},a(0,e,"lineColor",function(){return this._lineColor},function(e){if(this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_POLY_LINES_CMD_ENCODER_.getPtrID(),$.syncBufferToRenderThread(this._graphicsCmdEncoder),this._lineColor=e,this._lineColor&&this.line_vbBuffer){for(var i=l.create(this._lineColor).numColor,_=this.line_vbBuffer._int32Data,r=0,a=0;a<this._line_vertNum;a++)r++,r++,_[r++]=i;$.syncBufferToRenderThread(this.line_vbBuffer)}}),a(0,e,"points",function(){return this._points},function(e){this._points=e,this._vertNum=e.length/2;var i=this._vertNum,_=Pt.earcut(e,null,2);if(_.length>0){(!this.ibBuffer||this.ibBuffer.getByteLength()<2*_.length)&&(this.ibBuffer=new ParamData(2*_.length,!0,!0)),this._ibSize=2*_.length;for(var r=this.ibBuffer._int16Data,a=0,n=0;n<_.length;n++)r[a++]=_[n]}(!this.vbBuffer||this.vbBuffer.getByteLength()<3*this._vertNum*4)&&(this.vbBuffer=new ParamData(3*i*4,!0)),this._vbSize=3*this._vertNum*4;for(var s=l.create(this._fillColor).numColor,o=this.vbBuffer._float32Data,h=this.vbBuffer._int32Data,u=0,c=0;c<this._vertNum;c++)o[u++]=this._points[2*c]+this._x,o[u++]=this._points[2*c+1]+this._y,h[u++]=s;var f=this._paramData._int32Data;if(f[t._PARAM_VB_POS_]=this.vbBuffer.getPtrID(),f[t._PARAM_IB_POS_]=this.ibBuffer.getPtrID(),f[t._PARAM_VB_SIZE_POS_]=this._vbSize,f[t._PARAM_IB_SIZE_POS_]=this._ibSize,$.syncBufferToRenderThread(this.vbBuffer),$.syncBufferToRenderThread(this.ibBuffer),$.syncBufferToRenderThread(this._paramData),this.lineColor){var d=0;for(this._linePoints.length=0,this._line_ibArray.length=0,this._line_vbArray.length=0,c=0;c<e.length;c++)this._linePoints.push(e[c]);this._linePoints.push(e[0]),this._linePoints.push(e[1]),Tt.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length,d=this._line_vertNum,(!this.line_ibBuffer||this.line_ibBuffer.getByteLength()<3*(this._line_vertNum-2)*2)&&(this.line_ibBuffer=new ParamData(3*(d-2)*2,!0,!0)),this._line_ibSize=3*(this._line_vertNum-2)*2;var E=this.line_ibBuffer._int16Data;for(a=0,n=0;n<3*(this._line_vertNum-2);n++)E[a++]=this._line_ibArray[n];(!this.line_vbBuffer||this.line_vbBuffer.getByteLength()<3*this._line_vertNum*4)&&(this.line_vbBuffer=new ParamData(3*d*4,!0)),this._line_vbSize=3*this._line_vertNum*4;var A=l.create(this._lineColor).numColor,D=this.line_vbBuffer._float32Data,R=this.line_vbBuffer._int32Data;for(u=0,c=0;c<this._line_vertNum;c++)D[u++]=this._line_vbArray[2*c]+this._x,D[u++]=this._line_vbArray[2*c+1]+this._y,R[u++]=A;(f=this._paramData._int32Data)[t._PARAM_LINE_VB_POS_]=this.line_vbBuffer.getPtrID(),f[t._PARAM_LINE_IB_POS_]=this.line_ibBuffer.getPtrID(),f[t._PARAM_LINE_VB_SIZE_POS_]=this._line_vbSize,f[t._PARAM_LINE_IB_SIZE_POS_]=this._line_ibSize,$.syncBufferToRenderThread(this.line_vbBuffer),$.syncBufferToRenderThread(this.line_ibBuffer)}}),a(0,e,"cmdID",function(){return"DrawPoly"}),a(0,e,"fillColor",function(){return this._fillColor},function(t){this._fillColor=t;for(var e=l.create(this._fillColor).numColor,i=this.vbBuffer._int32Data,_=0,r=0;r<this._vertNum;r++)_++,_++,i[_++]=e;$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"x",function(){return this._x},function(t){this._x=t;for(var e=this.vbBuffer._float32Data,i=0,_=0;_<this._vertNum;_++)e[i++]=this._points[2*_]+this._x,i++,i++;if(this._lineColor){var r=this.line_vbBuffer._float32Data;for(i=0,_=0;_<this._line_vertNum;_++)r[i++]=this._line_vbArray[2*_]+this._x,i++,i++;$.syncBufferToRenderThread(this.line_vbBuffer)}$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"isConvexPolygon",function(){return this._isConvexPolygon},function(t){this._isConvexPolygon=t}),a(0,e,"vid",function(){return this._vid},function(t){this._vid=t}),a(0,e,"y",function(){return this._y},function(t){this._y=t;for(var e=this.vbBuffer._float32Data,i=0,_=0;_<this._vertNum;_++)i++,e[i++]=this._points[2*_+1]+this._y,i++;if(this._lineColor){var r=this.line_vbBuffer._float32Data;for(i=0,_=0;_<this._line_vertNum;_++)i++,r[i++]=this._line_vbArray[2*_+1]+this._y,i++;$.syncBufferToRenderThread(this.line_vbBuffer)}$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"lineWidth",function(){return this._lineWidth},function(e){this.lineColor&&(this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_POLY_LINES_CMD_ENCODER_.getPtrID(),$.syncBufferToRenderThread(this._graphicsCmdEncoder)),this._lineWidth=e,this._linePoints.length=0,this._line_ibArray.length=0,this._line_vbArray.length=0;for(var i=0;i<this._points.length;i++)this._linePoints.push(this._points[i]);this._linePoints.push(this._points[0]),this._linePoints.push(this._points[1]),Tt.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1);var _=this.line_vbBuffer._float32Data,r=0;for(i=0;i<this._line_vertNum;i++)_[r++]=this._line_vbArray[2*i]+this._x,_[r++]=this._line_vbArray[2*i+1]+this._y,r++;$.syncBufferToRenderThread(this.line_vbBuffer)}),t.create=function(e,i,_,r,a,n,s,o){var h=O.getItemByClass("DrawPolyCmd",t);h._graphicsCmdEncoder=this._commandEncoder,t._DRAW_POLY_CMD_ENCODER_||((t._DRAW_POLY_CMD_ENCODER_=$.instance.createCommandEncoder(88,32,!0)).useProgramEx(it.PROGRAMEX_DRAWVG),t._DRAW_POLY_CMD_ENCODER_.useVDO(it.VDO_MESHVG),t._DRAW_POLY_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_POLY_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_POLY_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_POLY_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_POLY_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_POLY_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._DRAW_POLY_CMD_ENCODER_)),t._DRAW_POLY_LINES_CMD_ENCODER_||((t._DRAW_POLY_LINES_CMD_ENCODER_=$.instance.createCommandEncoder(140,32,!0)).useProgramEx(it.PROGRAMEX_DRAWVG),t._DRAW_POLY_LINES_CMD_ENCODER_.useVDO(it.VDO_MESHVG),t._DRAW_POLY_LINES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_POLY_LINES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_POLY_LINES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_POLY_LINES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_POLY_LINES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_POLY_LINES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),t._DRAW_POLY_LINES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_LINE_VB_POS_,4*t._PARAM_LINE_VB_OFFSET_POS_,4*t._PARAM_LINE_VB_SIZE_POS_,4*t._PARAM_LINE_IB_POS_,4*t._PARAM_LINE_VB_OFFSET_POS_,4*t._PARAM_LINE_IB_SIZE_POS_,4*t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_POLY_LINES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_POLY_LINES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._DRAW_POLY_LINES_CMD_ENCODER_)),h._paramData||(h._paramData=new ParamData(68,!0)),h._x=e,h._y=i,h._points=_,h._fillColor=r,h._lineColor=a,h._lineWidth=n,h._isConvexPolygon=s,h._vertNum=_.length/2;var u=h._vertNum,c=Pt.earcut(_,null,2);if(c.length>0){(!h.ibBuffer||h.ibBuffer.getByteLength()<2*c.length)&&(h.ibBuffer=new ParamData(2*c.length,!0,!0)),h._ibSize=2*c.length;for(var f=h.ibBuffer._int16Data,d=0,E=0;E<c.length;E++)f[d++]=c[E]}var A=l.create(r).numColor;(!h.vbBuffer||h.vbBuffer.getByteLength()<3*h._vertNum*4)&&(h.vbBuffer=new ParamData(3*u*4,!0)),h._vbSize=3*h._vertNum*4;for(var D=h.vbBuffer._float32Data,R=h.vbBuffer._int32Data,m=0,T=0;T<h._vertNum;T++)D[m++]=_[2*T]+e,D[m++]=_[2*T+1]+i,R[m++]=A;for(T=0;T<_.length;T++)h._linePoints.push(_[T]);if(h._linePoints.push(_[0]),h._linePoints.push(_[1]),a){Tt.createLine2(h._linePoints,h._line_ibArray,n,0,h._line_vbArray,!1),h._line_vertNum=h._linePoints.length;var P=h._line_vertNum;(!h.line_ibBuffer||h.line_ibBuffer.getByteLength()<3*(h._line_vertNum-2)*2)&&(h.line_ibBuffer=new ParamData(3*(P-2)*2,!0,!0)),h._line_ibSize=3*(h._line_vertNum-2)*2;var v=h.line_ibBuffer._int16Data;for(d=0,E=0;E<3*(h._line_vertNum-2);E++)v[d++]=h._line_ibArray[E];(!h.line_vbBuffer||h.line_vbBuffer.getByteLength()<3*h._line_vertNum*4)&&(h.line_vbBuffer=new ParamData(3*P*4,!0)),h._line_vbSize=3*h._line_vertNum*4;var p=l.create(a),C=p.numColor,M=h.line_vbBuffer._float32Data,S=h.line_vbBuffer._int32Data;for(m=0,T=0;T<h._line_vertNum;T++)M[m++]=h._line_vbArray[2*T]+e,M[m++]=h._line_vbArray[2*T+1]+i,S[m++]=C}else{h._lineWidth=1;for(Tt.createLine2(h._linePoints,h._line_ibArray,h._lineWidth,0,h._line_vbArray,!1),h._line_vertNum=h._linePoints.length,P=h._line_vertNum,(!h.line_ibBuffer||h.line_ibBuffer.getByteLength()<3*(h._line_vertNum-2)*2)&&(h.line_ibBuffer=new ParamData(3*(P-2)*2,!0,!0)),h._line_ibSize=3*(h._line_vertNum-2)*2,v=h.line_ibBuffer._int16Data,d=0,E=0;E<3*(h._line_vertNum-2);E++)v[d++]=h._line_ibArray[E];for((!h.line_vbBuffer||h.line_vbBuffer.getByteLength()<3*h._line_vertNum*4)&&(h.line_vbBuffer=new ParamData(3*P*4,!0)),h._line_vbSize=3*h._line_vertNum*4,C=(p=l.create("#ffffff")).numColor,M=h.line_vbBuffer._float32Data,S=h.line_vbBuffer._int32Data,m=0,T=0;T<h._line_vertNum;T++)M[m++]=h._line_vbArray[2*T]+e,M[m++]=h._line_vbArray[2*T+1]+i,S[m++]=C}var g=h._paramData._float32Data,y=h._paramData._int32Data;return y[0]=1,y[1]=32,null==h.ibBuffer?null:(y[t._PARAM_VB_POS_]=h.vbBuffer.getPtrID(),y[t._PARAM_IB_POS_]=h.ibBuffer.getPtrID(),y[t._PARAM_VB_SIZE_POS_]=h._vbSize,y[t._PARAM_IB_SIZE_POS_]=h._ibSize,y[t._PARAM_VB_OFFSET_POS_]=0,y[t._PARAM_IB_OFFSET_POS_]=0,y[t._PARAM_INDEX_ELEMENT_OFFSET_POS_]=0,g[t._PARAM_ISCONVEXT_POS_]=s,$.syncBufferToRenderThread(h.vbBuffer),$.syncBufferToRenderThread(h.ibBuffer),y[t._PARAM_LINE_VB_POS_]=h.line_vbBuffer.getPtrID(),y[t._PARAM_LINE_IB_POS_]=h.line_ibBuffer.getPtrID(),y[t._PARAM_LINE_VB_SIZE_POS_]=h._line_vbSize,y[t._PARAM_LINE_IB_SIZE_POS_]=h._line_ibSize,y[t._PARAM_LINE_VB_OFFSET_POS_]=0,y[t._PARAM_LINE_IB_OFFSET_POS_]=0,y[t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_]=0,$.syncBufferToRenderThread(h.line_vbBuffer),$.syncBufferToRenderThread(h.line_ibBuffer),$.syncBufferToRenderThread(h._paramData),h._cmdCurrentPos=a?h._graphicsCmdEncoder.useCommandEncoder(t._DRAW_POLY_LINES_CMD_ENCODER_.getPtrID(),h._paramData.getPtrID(),-1):h._graphicsCmdEncoder.useCommandEncoder(t._DRAW_POLY_CMD_ENCODER_.getPtrID(),h._paramData.getPtrID(),-1),$.syncBufferToRenderThread(h._graphicsCmdEncoder),h)},t.ID="DrawPoly",t._DRAW_POLY_CMD_ENCODER_=null,t._DRAW_POLY_LINES_CMD_ENCODER_=null,t._PARAM_VB_POS_=2,t._PARAM_IB_POS_=3,t._PARAM_VB_SIZE_POS_=4,t._PARAM_IB_SIZE_POS_=5,t._PARAM_LINE_VB_POS_=6,t._PARAM_LINE_IB_POS_=7,t._PARAM_LINE_VB_SIZE_POS_=8,t._PARAM_LINE_IB_SIZE_POS_=9,t._PARAM_ISCONVEXT_POS_=10,t._PARAM_VB_OFFSET_POS_=11,t._PARAM_IB_OFFSET_POS_=12,t._PARAM_LINE_VB_OFFSET_POS_=13,t._PARAM_LINE_IB_OFFSET_POS_=14,t._PARAM_INDEX_ELEMENT_OFFSET_POS_=15,t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_=16}(),function(){function t(){this._graphicsCmdEncoder=null,this._index=0,this._paramData=null,this._x=NaN,this._y=NaN,this._width=NaN,this._height=NaN,this._fillColor=null,this._lineColor=null,this._lineWidth=NaN,this._line_vertNum=0,this._cmdCurrentPos=0,this._linePoints=[],this._line_ibArray=[],this._line_vbArray=[]}r(t,"laya.layagl.cmdNative.DrawRectCmdNative");var e=t.prototype;e.recover=function(){this._graphicsCmdEncoder=null,O.recover("DrawRectCmd",this)},a(0,e,"lineColor",function(){return this._lineColor},function(e){this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_RECT_LINE_CMD_ENCODER_.getPtrID(),$.syncBufferToRenderThread(this._graphicsCmdEncoder),this._lineColor=e;for(var i=this._paramData._int32Data,_=l.create(e).numColor,r=t._PARAM_LINE_VB_POS_,a=0;a<this._line_vertNum;a++)r++,r++,i[r++]=_;$.syncBufferToRenderThread(this._paramData)}),a(0,e,"cmdID",function(){return"DrawRect"}),a(0,e,"fillColor",function(){return this._fillColor},function(e){if(this._fillColor=e,"string"==typeof e){var i=l.create(this._fillColor).numColor,_=this._paramData._int32Data;_[t._PARAM_VB_POS_+4]=i,_[t._PARAM_VB_POS_+10]=i,_[t._PARAM_VB_POS_+16]=i,_[t._PARAM_VB_POS_+22]=i}else(_=this._paramData._int32Data)[t._PARAM_VB_POS_+4]=e,_[t._PARAM_VB_POS_+10]=e,_[t._PARAM_VB_POS_+16]=e,_[t._PARAM_VB_POS_+22]=e;$.syncBufferToRenderThread(this._paramData)}),a(0,e,"width",function(){return this._width},function(e){this._width=e;var i=this._paramData._float32Data;if(i[t._PARAM_VB_POS_+6]=this._x+this._width,i[t._PARAM_VB_POS_+12]=this._x+this._width,this.lineColor){this._line_ibArray.length=0,this._line_vbArray.length=0,this._linePoints[2]=this._x+this._width,this._linePoints[4]=this._x+this._width,Tt.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length;for(var _=t._PARAM_LINE_VB_POS_,r=0;r<this._line_vertNum;r++)i[_++]=this._line_vbArray[2*r],i[_++]=this._line_vbArray[2*r+1],_++}$.syncBufferToRenderThread(this._paramData)}),a(0,e,"x",function(){return this._x},function(e){this._x=e;var i=this._paramData._float32Data;if(i[t._PARAM_VB_POS_]=this._x,i[t._PARAM_VB_POS_+6]=this._x+this._width,i[t._PARAM_VB_POS_+12]=this._x+this._width,i[t._PARAM_VB_POS_+18]=this._x,this.lineColor){this._line_ibArray.length=0,this._line_vbArray.length=0,this._linePoints[0]=this._x,this._linePoints[2]=this._x+this._width,this._linePoints[4]=this._x+this._width,this._linePoints[6]=this._x,this._linePoints[8]=this._x,Tt.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1);for(var _=t._PARAM_LINE_VB_POS_,r=0;r<this._line_vertNum;r++)i[_++]=this._line_vbArray[2*r],i[_++]=this._line_vbArray[2*r+1],_++}$.syncBufferToRenderThread(this._paramData)}),a(0,e,"y",function(){return this._y},function(e){this._y=e;var i=this._paramData._float32Data;if(i[t._PARAM_VB_POS_+1]=this._y,i[t._PARAM_VB_POS_+7]=this._y,i[t._PARAM_VB_POS_+13]=this._y+this._height,i[t._PARAM_VB_POS_+19]=this._y+this._height,this.lineColor){this._line_ibArray.length=0,this._line_vbArray.length=0,this._linePoints[1]=this._y,this._linePoints[3]=this._y,this._linePoints[5]=this._y+this._height,this._linePoints[7]=this._y+this._height,this._linePoints[9]=this._y-this._lineWidth/2,Tt.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1);for(var _=t._PARAM_LINE_VB_POS_,r=0;r<this._line_vertNum;r++)i[_++]=this._line_vbArray[2*r],i[_++]=this._line_vbArray[2*r+1],_++}$.syncBufferToRenderThread(this._paramData)}),a(0,e,"height",function(){return this._height},function(e){this._height=e;var i=this._paramData._float32Data;if(i[t._PARAM_VB_POS_+13]=this._y+this._height,i[t._PARAM_VB_POS_+19]=this._y+this._height,this.lineColor){this._line_ibArray.length=0,this._line_vbArray.length=0,this._linePoints[5]=this._y+this._height,this._linePoints[7]=this._y+this._height,Tt.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1);for(var _=t._PARAM_LINE_VB_POS_,r=0;r<this._line_vertNum;r++)i[_++]=this._line_vbArray[2*r],i[_++]=this._line_vbArray[2*r+1],_++}$.syncBufferToRenderThread(this._paramData)}),a(0,e,"lineWidth",function(){return this._lineWidth},function(e){this.lineColor&&(this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_RECT_LINE_CMD_ENCODER_.getPtrID(),$.syncBufferToRenderThread(this._graphicsCmdEncoder)),this._lineWidth=e,this._line_ibArray.length=0,this._line_vbArray.length=0,this._linePoints[9]=this._y-this._lineWidth/2,Tt.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length;for(var i=this._paramData._float32Data,_=t._PARAM_LINE_VB_POS_,r=0;r<this._line_vertNum;r++)i[_++]=this._line_vbArray[2*r],i[_++]=this._line_vbArray[2*r+1],_++;$.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i,_,r,a,n,s){var o=O.getItemByClass("DrawRectCmd",t);o._graphicsCmdEncoder=this._commandEncoder,t._DRAW_RECT_LINE_CMD_ENCODER_||((t._DRAW_RECT_LINE_CMD_ENCODER_=$.instance.createCommandEncoder(164,32,!0)).useProgramEx(it.PROGRAMEX_DRAWTEXTURE),t._DRAW_RECT_LINE_CMD_ENCODER_.useVDO(it.VDO_MESHQUADTEXTURE),t._DRAW_RECT_LINE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_RECT_LINE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_RECT_LINE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_RECT_LINE_CMD_ENCODER_.setRectMeshByParamData(4*t._PARAM_RECT_NUM_POS_,4*t._PARAM_VB_POS_,4*t._PARAM_VB_SIZE_POS_),t._DRAW_RECT_LINE_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_RECT_LINE_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),t._DRAW_RECT_LINE_CMD_ENCODER_.useProgramEx(it.PROGRAMEX_DRAWVG),t._DRAW_RECT_LINE_CMD_ENCODER_.useVDO(it.VDO_MESHVG),t._DRAW_RECT_LINE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_RECT_LINE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_RECT_LINE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_RECT_LINE_CMD_ENCODER_.setMeshByParamData(4*t._PARAM_LINE_VB_POS_,4*t._PARAM_LINE_VB_OFFSET_POS_,4*t._PARAM_LINE_VB_SIZE_POS_,4*t._PARAM_LINE_IB_POS_,4*t._PARAM_LINE_IB_OFFSET_POS_,4*t._PARAM_LINE_IB_SIZE_POS_,4*t._PARAM_LINE_IBELEMENT_OFFSET_POS_),t._DRAW_RECT_LINE_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_RECT_LINE_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._DRAW_RECT_LINE_CMD_ENCODER_)),t._DRAW_RECT_CMD_ENCODER_||((t._DRAW_RECT_CMD_ENCODER_=$.instance.createCommandEncoder(84,32,!0)).useProgramEx(it.PROGRAMEX_DRAWTEXTURE),t._DRAW_RECT_CMD_ENCODER_.useVDO(it.VDO_MESHQUADTEXTURE),t._DRAW_RECT_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_RECT_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_RECT_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_RECT_CMD_ENCODER_.setRectMeshByParamData(4*t._PARAM_RECT_NUM_POS_,4*t._PARAM_VB_POS_,4*t._PARAM_VB_SIZE_POS_),t._DRAW_RECT_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_RECT_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._DRAW_RECT_CMD_ENCODER_)),o._paramData||(o._paramData=new ParamData(292,!0)),o._x=e,o._y=i,o._width=_,o._height=r,o._fillColor=a,o._lineColor=n,o._lineWidth=s;var h=l.create(a).numColor,u=o._paramData._float32Data,c=o._paramData._int32Data;c[t._PARAM_RECT_NUM_POS_]=1,c[t._PARAM_VB_SIZE_POS_]=96;var f=t._PARAM_VB_POS_;if(u[f++]=e,u[f++]=i,u[f++]=0,u[f++]=0,c[f++]=h,u[f++]=4294967295,u[f++]=e+_,u[f++]=i,u[f++]=0,u[f++]=0,c[f++]=h,u[f++]=4294967295,u[f++]=e+_,u[f++]=i+r,u[f++]=0,u[f++]=0,c[f++]=h,u[f++]=4294967295,u[f++]=e,u[f++]=i+r,u[f++]=0,u[f++]=0,c[f++]=h,u[f++]=4294967295,o._linePoints.push(e),o._linePoints.push(i),o._linePoints.push(e+_),o._linePoints.push(i),o._linePoints.push(e+_),o._linePoints.push(i+r),o._linePoints.push(e),o._linePoints.push(i+r),o._linePoints.push(e),o._linePoints.push(i-s/2),n){Tt.createLine2(o._linePoints,o._line_ibArray,s,0,o._line_vbArray,!1),o._line_vertNum=o._linePoints.length,c[t._PARAM_LINE_VB_SIZE_POS_]=120;var d=l.create(n),E=d.numColor;f=t._PARAM_LINE_VB_POS_;for(var A=0;A<o._line_vertNum;A++)u[f++]=o._line_vbArray[2*A],u[f++]=o._line_vbArray[2*A+1],c[f++]=E;c[t._PARAM_LINE_IB_SIZE_POS_]=2*o._line_ibArray.length;var D=o._paramData._int16Data;f=2*t._PARAM_LINE_IB_POS_;for(var R=0;R<o._line_ibArray.length;R++)D[f++]=o._line_ibArray[R]}else{o._lineWidth=1;for(Tt.createLine2(o._linePoints,o._line_ibArray,o._lineWidth,0,o._line_vbArray,!1),o._line_vertNum=o._linePoints.length,c[t._PARAM_LINE_VB_SIZE_POS_]=120,E=(d=l.create("#ffffff")).numColor,f=t._PARAM_LINE_VB_POS_,A=0;A<o._line_vertNum;A++)u[f++]=o._line_vbArray[2*A],u[f++]=o._line_vbArray[2*A+1],c[f++]=E;for(c[t._PARAM_LINE_IB_SIZE_POS_]=2*o._line_ibArray.length,D=o._paramData._int16Data,f=2*t._PARAM_LINE_IB_POS_,R=0;R<o._line_ibArray.length;R++)D[f++]=o._line_ibArray[R]}return c[t._PARAM_LINE_VB_OFFSET_POS_]=0,c[t._PARAM_LINE_IB_OFFSET_POS_]=0,c[t._PARAM_LINE_IBELEMENT_OFFSET_POS_]=0,$.syncBufferToRenderThread(o._paramData),o._cmdCurrentPos=n?o._graphicsCmdEncoder.useCommandEncoder(t._DRAW_RECT_LINE_CMD_ENCODER_.getPtrID(),o._paramData.getPtrID(),-1):o._graphicsCmdEncoder.useCommandEncoder(t._DRAW_RECT_CMD_ENCODER_.getPtrID(),o._paramData.getPtrID(),-1),$.syncBufferToRenderThread(o._graphicsCmdEncoder),o},t.ID="DrawRect",t._DRAW_RECT_CMD_ENCODER_=null,t._DRAW_RECT_LINE_CMD_ENCODER_=null,t._PARAM_RECT_NUM_POS_=0,t._PARAM_VB_SIZE_POS_=1,t._PARAM_VB_POS_=2,t._PARAM_LINE_VB_SIZE_POS_=26,t._PARAM_LINE_VB_POS_=27,t._PARAM_LINE_IB_SIZE_POS_=57,t._PARAM_LINE_IB_POS_=58,t._PARAM_LINE_VB_OFFSET_POS_=70,t._PARAM_LINE_IB_OFFSET_POS_=71,t._PARAM_LINE_IBELEMENT_OFFSET_POS_=72}(),function(){function t(){this._graphicsCmdEncoder=null,this._index=0,this._paramData=null,this._texture=null,this._x=NaN,this._y=NaN,this._width=NaN,this._height=NaN,this._matrix=null,this._alpha=NaN,this._color=null,this._blendMode=null,this._cmdCurrentPos=0,this._blend_src=0,this._blend_dest=0}r(t,"laya.layagl.cmdNative.DrawTextureCmdNative");var e=t.prototype;e.recover=function(){this._texture=null,O.recover("DrawTextureCmd",this)},e._setBlendMode=function(t){switch(t){case"normal":this._blend_src=1,this._blend_dest=771;break;case"add":this._blend_src=1,this._blend_dest=772;break;case"multiply":this._blend_src=774,this._blend_dest=771;break;case"screen":case"lighter":this._blend_src=1,this._blend_dest=1;break;case"overlay":this._blend_src=1,this._blend_dest=769;break;case"destination-out":this._blend_src=0,this._blend_dest=0;break;case"mask":this._blend_src=0,this._blend_dest=770;break;default:alert("_setBlendMode Unknown type")}},e._mixRGBandAlpha=function(t,e){var i=(4278190080&t)>>>24;return 0!=i?i*=e:i=255*e,16777215&t|i<<24},a(0,e,"cmdID",function(){return"DrawTexture"}),a(0,e,"matrix",function(){return this._matrix},function(e){this._matrix||(this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.getPtrID(),$.syncBufferToRenderThread(this._graphicsCmdEncoder)),this._matrix=e;var i=this._paramData._float32Data;i[t._PARAM_MATRIX_POS_]=e.a,i[t._PARAM_MATRIX_POS_+1]=e.b,i[t._PARAM_MATRIX_POS_+2]=e.c,i[t._PARAM_MATRIX_POS_+3]=e.d,i[t._PARAM_MATRIX_POS_+4]=e.tx,i[t._PARAM_MATRIX_POS_+5]=e.ty,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"y",function(){return this._y},function(e){this._y=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_+1]=this._y,i[t._PARAM_VB_POS_+7]=this._y,i[t._PARAM_VB_POS_+13]=this._y+this._height,i[t._PARAM_VB_POS_+19]=this._y+this._height,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"texture",function(){return this._texture},function(e){if(e&&e.url){this._texture=e,this._paramData._int32Data[t._PARAM_TEXTURE_POS_]=this._texture.bitmap._glTexture.id;var i=this._paramData._float32Data,_=this.texture.uv;i[t._PARAM_VB_POS_+2]=_[0],i[t._PARAM_VB_POS_+3]=_[1],i[t._PARAM_VB_POS_+8]=_[2],i[t._PARAM_VB_POS_+9]=_[3],i[t._PARAM_VB_POS_+14]=_[4],i[t._PARAM_VB_POS_+15]=_[5],i[t._PARAM_VB_POS_+20]=_[6],i[t._PARAM_VB_POS_+21]=_[7],$.syncBufferToRenderThread(this._paramData)}}),a(0,e,"width",function(){return this._width},function(e){this._width=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_]=this._x,i[t._PARAM_VB_POS_+6]=this._x+this._width,i[t._PARAM_VB_POS_+12]=this._x+this._width,i[t._PARAM_VB_POS_+18]=this._x,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"x",function(){return this._x},function(e){this._x=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_]=this._x,i[t._PARAM_VB_POS_+6]=this._x+this._width,i[t._PARAM_VB_POS_+12]=this._x+this._width,i[t._PARAM_VB_POS_+18]=this._x,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"height",function(){return this._height},function(e){this._height=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_+1]=this._y,i[t._PARAM_VB_POS_+7]=this._y,i[t._PARAM_VB_POS_+13]=this._y+this._height,i[t._PARAM_VB_POS_+19]=this._y+this._height,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"alpha",function(){return this._alpha},function(t){this._alpha=t}),t.create=function(e,i,_,r,a,n,s,o,h){var u=O.getItemByClass("DrawTextureCmd",t);u._graphicsCmdEncoder=this._commandEncoder,t._DRAW_TEXTURE_CMD_ENCODER_||((t._DRAW_TEXTURE_CMD_ENCODER_=$.instance.createCommandEncoder(124,32,!0)).useProgramEx(it.PROGRAMEX_DRAWTEXTURE),t._DRAW_TEXTURE_CMD_ENCODER_.useVDO(it.VDO_MESHQUADTEXTURE),t._DRAW_TEXTURE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_TEXTURE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_TEXTURE_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_TEXTURE_CMD_ENCODER_.uniformTextureByParamData(4*t._PARAM_UNIFORM_LOCATION_POS_,4*t._PARAM_TEX_LOCATION_POS_,4*t._PARAM_TEXTURE_POS_),t._DRAW_TEXTURE_CMD_ENCODER_.blendFuncByGlobalValue(it.GLOBALVALUE_BLENDFUNC_SRC,it.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_TEXTURE_CMD_ENCODER_.blendFuncByParamData(4*t._PARAM_BLEND_SRC_POS_,4*t._PARAM_BLEND_DEST_POS_),t._DRAW_TEXTURE_CMD_ENCODER_.setRectMeshByParamData(4*t._PARAM_RECT_NUM_POS_,4*t._PARAM_VB_POS_,4*t._PARAM_VB_SIZE_POS_),t._DRAW_TEXTURE_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_TEXTURE_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._DRAW_TEXTURE_CMD_ENCODER_)),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_||((t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_=$.instance.createCommandEncoder(132,32,!0)).useProgramEx(it.PROGRAMEX_DRAWTEXTURE),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.useVDO(it.VDO_MESHQUADTEXTURE),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.save(),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.setGlobalValueByParamData(it.GLOBALVALUE_MATRIX32,7,4*t._PARAM_MATRIX_POS_),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.uniformTextureByParamData(4*t._PARAM_UNIFORM_LOCATION_POS_,4*t._PARAM_TEX_LOCATION_POS_,4*t._PARAM_TEXTURE_POS_),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.blendFuncByGlobalValue(it.GLOBALVALUE_BLENDFUNC_SRC,it.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.blendFuncByParamData(4*t._PARAM_BLEND_SRC_POS_,4*t._PARAM_BLEND_DEST_POS_),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.setRectMeshByParamData(4*t._PARAM_RECT_NUM_POS_,4*t._PARAM_VB_POS_,4*t._PARAM_VB_SIZE_POS_),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.restore(),$.syncBufferToRenderThread(t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_)),u._paramData||(u._paramData=new ParamData(148,!0)),u._texture=e,u._x=i,u._y=_,u._width=r,u._height=a,u._matrix=n,u._alpha=s,u._color=o,u._blendMode=h;var l=0!=r?r:e.bitmap.width,c=0!=a?a:e.bitmap.height,f=e.uv,d=u._paramData._float32Data,E=u._paramData._int32Data;E[t._PARAM_UNIFORM_LOCATION_POS_]=3,E[t._PARAM_TEX_LOCATION_POS_]=33984,E[t._PARAM_TEXTURE_POS_]=e.bitmap._glTexture.id,E[t._PARAM_RECT_NUM_POS_]=1,E[t._PARAM_VB_SIZE_POS_]=96,h?(u._setBlendMode(h),E[t._PARAM_BLEND_SRC_POS_]=u._blend_src,E[t._PARAM_BLEND_DEST_POS_]=u._blend_dest):(E[t._PARAM_BLEND_SRC_POS_]=-1,E[t._PARAM_BLEND_DEST_POS_]=-1);var A=4294967295;s&&(A=u._mixRGBandAlpha(A,s));var D=t._PARAM_VB_POS_;return d[D++]=i,d[D++]=_,d[D++]=f[0],d[D++]=f[1],E[D++]=A,E[D++]=4294967295,d[D++]=i+l,d[D++]=_,d[D++]=f[2],d[D++]=f[3],E[D++]=A,E[D++]=4294967295,d[D++]=i+l,d[D++]=_+c,d[D++]=f[4],d[D++]=f[5],E[D++]=A,E[D++]=4294967295,d[D++]=i,d[D++]=_+c,d[D++]=f[6],d[D++]=f[7],E[D++]=A,E[D++]=4294967295,n&&(d[t._PARAM_MATRIX_POS_]=n.a,d[t._PARAM_MATRIX_POS_+1]=n.b,d[t._PARAM_MATRIX_POS_+2]=n.c,d[t._PARAM_MATRIX_POS_+3]=n.d,d[t._PARAM_MATRIX_POS_+4]=n.tx,d[t._PARAM_MATRIX_POS_+5]=n.ty),$.syncBufferToRenderThread(u._paramData),u._cmdCurrentPos=n?u._graphicsCmdEncoder.useCommandEncoder(t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.getPtrID(),u._paramData.getPtrID(),-1):u._graphicsCmdEncoder.useCommandEncoder(t._DRAW_TEXTURE_CMD_ENCODER_.getPtrID(),u._paramData.getPtrID(),-1),$.syncBufferToRenderThread(u._graphicsCmdEncoder),u},t.ID="DrawTexture",t._DRAW_TEXTURE_CMD_ENCODER_=null,t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_=null,t._PARAM_UNIFORM_LOCATION_POS_=0,t._PARAM_TEX_LOCATION_POS_=1,t._PARAM_TEXTURE_POS_=2,t._PARAM_RECT_NUM_POS_=3,t._PARAM_VB_SIZE_POS_=4,t._PARAM_VB_POS_=5,t._PARAM_MATRIX_POS_=29,t._PARAM_BLEND_SRC_POS_=35,t._PARAM_BLEND_DEST_POS_=36}(),function(){function t(){this._graphicsCmdEncoder=null,this._index=0,this._paramData=null,this._texture=null,this._pos=null,this._rectNum=0,this._vbSize=0,this.vbBuffer=null}r(t,"laya.layagl.cmdNative.DrawTexturesCmdNative");var e=t.prototype;e.recover=function(){this._texture=null,this._pos=null,O.recover("DrawTexturesCmd",this)},a(0,e,"cmdID",function(){return"DrawTextures"}),a(0,e,"texture",function(){return this._texture},function(e){this._texture=e;for(var i=this._texture.bitmap.width,_=this._texture.bitmap.height,r=this._texture.uv,a=this.vbBuffer._float32Data,n=this.vbBuffer._int32Data,s=0,o=0;o<this._rectNum;o++){var h=this.pos[2*o],u=this.pos[2*o+1];a[s++]=h,a[s++]=u,a[s++]=r[0],a[s++]=r[1],n[s++]=4294967295,n[s++]=4294967295,a[s++]=h+i,a[s++]=u,a[s++]=r[2],a[s++]=r[3],n[s++]=4294967295,n[s++]=4294967295,a[s++]=h+i,a[s++]=u+_,a[s++]=r[4],a[s++]=r[5],n[s++]=4294967295,n[s++]=4294967295,a[s++]=h,a[s++]=u+_,a[s++]=r[6],a[s++]=r[7],n[s++]=4294967295,n[s++]=4294967295}var l=this._paramData._int32Data;l[t._PARAM_TEXLOCATION_POS_]=33984,l[t._PARAM_TEXTURE_POS_]=this._texture.bitmap._glTexture.id,$.syncBufferToRenderThread(this.vbBuffer),$.syncBufferToRenderThread(this._paramData)}),a(0,e,"pos",function(){return this._pos},function(e){this._pos=e;var i=this._pos.length/2,_=this._texture.bitmap.width,r=this._texture.bitmap.height,a=this._texture.uv;(!this.vbBuffer||this.vbBuffer.getByteLength()<24*i*4)&&(this.vbBuffer=new ParamData(24*i*4,!0)),this._vbSize=24*i*4,this._rectNum=i;for(var n=this.vbBuffer._float32Data,s=this.vbBuffer._int32Data,o=0,h=0;h<i;h++){var u=this.pos[2*h],l=this.pos[2*h+1];n[o++]=u,n[o++]=l,n[o++]=a[0],n[o++]=a[1],s[o++]=4294967295,s[o++]=4294967295,n[o++]=u+_,n[o++]=l,n[o++]=a[2],n[o++]=a[3],s[o++]=4294967295,s[o++]=4294967295,n[o++]=u+_,n[o++]=l+r,n[o++]=a[4],n[o++]=a[5],s[o++]=4294967295,s[o++]=4294967295,n[o++]=u,n[o++]=l+r,n[o++]=a[6],n[o++]=a[7],s[o++]=4294967295,s[o++]=4294967295}this._paramData._float32Data;var c=this._paramData._int32Data;c[t._PARAM_RECT_NUM_POS_]=this._rectNum,c[t._PARAM_VB_POS_]=this.vbBuffer.getPtrID(),c[t._PARAM_VB_SIZE_POS_]=this._vbSize,$.syncBufferToRenderThread(this.vbBuffer),$.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i){var _=O.getItemByClass("DrawTexturesCmd",t);_._graphicsCmdEncoder=this._commandEncoder,t._DRAW_TEXTURES_CMD_ENCODER_||((t._DRAW_TEXTURES_CMD_ENCODER_=$.instance.createCommandEncoder(124,32,!0)).useProgramEx(it.PROGRAMEX_DRAWTEXTURE),t._DRAW_TEXTURES_CMD_ENCODER_.useVDO(it.VDO_MESHQUADTEXTURE),t._DRAW_TEXTURES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_TEXTURES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_TEXTURES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_TEXTURES_CMD_ENCODER_.uniformTextureByParamData(t._PARAM_UNIFORMLOCATION_POS_,4*t._PARAM_TEXLOCATION_POS_,4*t._PARAM_TEXTURE_POS_),t._DRAW_TEXTURES_CMD_ENCODER_.setRectMeshExByParamData(4*t._PARAM_RECT_NUM_POS_,4*t._PARAM_VB_POS_,4*t._PARAM_VB_SIZE_POS_),t._DRAW_TEXTURES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_TEXTURES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._DRAW_TEXTURES_CMD_ENCODER_)),_._paramData||(_._paramData=new ParamData(24,!0)),_._texture=e,_._pos=i;var r=e.bitmap.width,a=e.bitmap.height,n=e.uv,s=i.length/2;(!_.vbBuffer||_.vbBuffer.getByteLength()<24*s*4)&&(_.vbBuffer=new ParamData(24*s*4,!0)),_._vbSize=24*s*4,_._rectNum=s;for(var o=_.vbBuffer._float32Data,h=_.vbBuffer._int32Data,u=0,l=0;l<s;l++){var c=i[2*l],f=i[2*l+1];o[u++]=c,o[u++]=f,o[u++]=n[0],o[u++]=n[1],h[u++]=4294967295,h[u++]=4294967295,o[u++]=c+r,o[u++]=f,o[u++]=n[2],o[u++]=n[3],h[u++]=4294967295,h[u++]=4294967295,o[u++]=c+r,o[u++]=f+a,o[u++]=n[4],o[u++]=n[5],h[u++]=4294967295,h[u++]=4294967295,o[u++]=c,o[u++]=f+a,o[u++]=n[6],o[u++]=n[7],h[u++]=4294967295,h[u++]=4294967295}_._paramData._float32Data;var d=_._paramData._int32Data;return d[t._PARAM_UNIFORMLOCATION_POS_]=3,d[t._PARAM_TEXLOCATION_POS_]=33984,d[t._PARAM_TEXTURE_POS_]=e.bitmap._glTexture.id,d[t._PARAM_RECT_NUM_POS_]=_._rectNum,d[t._PARAM_VB_POS_]=_.vbBuffer.getPtrID(),d[t._PARAM_VB_SIZE_POS_]=_._vbSize,$.syncBufferToRenderThread(_.vbBuffer),$.syncBufferToRenderThread(_._paramData),_._graphicsCmdEncoder.useCommandEncoder(t._DRAW_TEXTURES_CMD_ENCODER_.getPtrID(),_._paramData.getPtrID(),-1),$.syncBufferToRenderThread(_._graphicsCmdEncoder),_},t.ID="DrawTextures",t._DRAW_TEXTURES_CMD_ENCODER_=null,t._PARAM_UNIFORMLOCATION_POS_=0,t._PARAM_TEXLOCATION_POS_=1,t._PARAM_TEXTURE_POS_=2,t._PARAM_RECT_NUM_POS_=3,t._PARAM_VB_POS_=4,t._PARAM_VB_SIZE_POS_=5}(),function(){function t(){this._graphicsCmdEncoder=null,this._paramData=null,this._texture=null,this._x=NaN,this._y=NaN,this._vertices=null,this._uvs=null,this._indices=null,this._matrix=null,this._alpha=NaN,this._color=null,this._blendMode=null,this.vbBuffer=null,this._vbSize=NaN,this.ibBuffer=null,this._ibSize=NaN,this._verticesNum=NaN,this._ibNum=NaN,this._blend_src=0,this._blend_dest=0}r(t,"laya.layagl.cmdNative.DrawTrianglesCmdNative");var e=t.prototype;e.recover=function(){this._texture=null,this._vertices=null,this._uvs=null,this._indices=null,this._matrix=null,O.recover("DrawTrianglesCmd",this)},e._setBlendMode=function(t){switch(t){case"normal":this._blend_src=1,this._blend_dest=771;break;case"add":this._blend_src=1,this._blend_dest=772;break;case"multiply":this._blend_src=774,this._blend_dest=771;break;case"screen":case"lighter":this._blend_src=1,this._blend_dest=1;break;case"overlay":this._blend_src=1,this._blend_dest=769;break;case"destination-out":this._blend_src=0,this._blend_dest=0;break;case"mask":this._blend_src=0,this._blend_dest=770;break;default:alert("_setBlendMode Unknown type")}},e._mixRGBandAlpha=function(t,e){var i=(4278190080&t)>>>24;return 0!=i?i*=e:i=255*e,16777215&t|i<<24},a(0,e,"vertices",function(){return this._vertices},function(t){this._vertices=t;for(var e=this.vbBuffer._float32Data,i=0,_=0;_<this._verticesNum;_++)e[i++]=this._x+t[2*_],e[i++]=this._y+t[2*_+1],i++,i++,i++,i++;$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"cmdID",function(){return"DrawTriangles"}),a(0,e,"matrix",function(){return this._matrix},function(e){this._matrix=e;var i=this._paramData._float32Data;i[t._PARAM_MATRIX_POS_]=e.a,i[t._PARAM_MATRIX_POS_+1]=e.b,i[t._PARAM_MATRIX_POS_+2]=e.c,i[t._PARAM_MATRIX_POS_+3]=e.d,i[t._PARAM_MATRIX_POS_+4]=e.tx,i[t._PARAM_MATRIX_POS_+5]=e.ty,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"texture",function(){return this._texture},function(e){if(e&&e.url){this._texture=e;this._paramData._int32Data[t._PARAM_TEXTURE_POS_]=this._texture.bitmap._glTexture.id,$.syncBufferToRenderThread(this._paramData)}}),a(0,e,"y",function(){return this._y},function(t){this._y=t;for(var e=this.vbBuffer._float32Data,i=0,_=0;_<this._verticesNum;_++)i++,e[i++]=t+this.vertices[2*_+1],i++,i++,i++,i++;$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"x",function(){return this._x},function(t){this._x=t;for(var e=this.vbBuffer._float32Data,i=0,_=0;_<this._verticesNum;_++)e[i++]=t+this.vertices[2*_],i++,i++,i++,i++,i++;$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"alpha",function(){return this._alpha},function(t){this._alpha=t}),a(0,e,"uvs",function(){return this._uvs},function(t){this._uvs=t;for(var e=this.vbBuffer._float32Data,i=0,_=0;_<this._verticesNum;_++)i++,i++,e[i++]=t[2*_],e[i++]=t[2*_+1],i++,i++;$.syncBufferToRenderThread(this.vbBuffer)}),a(0,e,"indices",function(){return this._indices},function(t){this._indices=t;for(var e=this.ibBuffer._int16Data,i=0,_=0;_<this._ibNum;_++)e[i++]=t[_];$.syncBufferToRenderThread(this.ibBuffer)}),a(0,e,"color",function(){return this._color},function(t){this._color=t}),a(0,e,"blendMode",function(){return this._blendMode},function(t){this._blendMode=t}),t.create=function(e,i,_,r,a,n,s,o,h,c){var f=O.getItemByClass("DrawTrianglesCmd",t);f._graphicsCmdEncoder=this._commandEncoder,t._DRAW_TRIANGLES_CMD_ENCODER_||((t._DRAW_TRIANGLES_CMD_ENCODER_=$.instance.createCommandEncoder(152,32,!0)).save(),t._DRAW_TRIANGLES_CMD_ENCODER_.useProgramEx(it.PROGRAMEX_DRAWTEXTURE),t._DRAW_TRIANGLES_CMD_ENCODER_.useVDO(it.VDO_MESHQUADTEXTURE),t._DRAW_TRIANGLES_CMD_ENCODER_.setGlobalValueByParamData(it.GLOBALVALUE_MATRIX32,7,4*t._PARAM_MATRIX_POS_),t._DRAW_TRIANGLES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_TRIANGLES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_TRIANGLES_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_TRIANGLES_CMD_ENCODER_.uniformTextureByParamData(4*t._PARAM_UNIFORMLOCATION_POS_,4*t._PARAM_TEXLOCATION_POS_,4*t._PARAM_TEXTURE_POS_),t._DRAW_TRIANGLES_CMD_ENCODER_.blendFuncByGlobalValue(it.GLOBALVALUE_BLENDFUNC_SRC,it.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_TRIANGLES_CMD_ENCODER_.blendFuncByParamData(4*t._PARAM_BLEND_SRC_POS_,4*t._PARAM_BLEND_DEST_POS_),t._DRAW_TRIANGLES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_TRIANGLES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_TRIANGLES_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),t._DRAW_TRIANGLES_CMD_ENCODER_.restore(),$.syncBufferToRenderThread(t._DRAW_TRIANGLES_CMD_ENCODER_)),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_||((t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_=$.instance.createCommandEncoder(152,32,!0)).save(),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.addShaderMacro(it.SHADER_MACRO_COLOR_FILTER),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.setGlobalValueByParamData(it.GLOBALVALUE_COLORFILTER_COLOR,8,4*t._PARAM_FILTER_COLOR_POS_),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.setGlobalValueByParamData(it.GLOBALVALUE_COLORFILTER_ALPHA,8,4*t._PARAM_FILTER_ALPHA_POS_),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.useProgramEx(it.PROGRAMEX_DRAWTEXTURE),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.useVDO(it.VDO_MESHQUADTEXTURE),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.setGlobalValueByParamData(it.GLOBALVALUE_MATRIX32,7,4*t._PARAM_MATRIX_POS_),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_VIEWS,0),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.uniformTextureByParamData(4*t._PARAM_UNIFORMLOCATION_POS_,4*t._PARAM_TEXLOCATION_POS_,4*t._PARAM_TEXTURE_POS_),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.blendFuncByGlobalValue(it.GLOBALVALUE_BLENDFUNC_SRC,it.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.blendFuncByParamData(4*t._PARAM_BLEND_SRC_POS_,4*t._PARAM_BLEND_DEST_POS_),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.restore(),$.syncBufferToRenderThread(t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_)),f._paramData||(f._paramData=new ParamData(152,!0)),f._texture=e,f._x=i,f._y=_,f._vertices=r,f._uvs=a,f._indices=n,f._matrix=s||new p,f._alpha=o,f._color=h,f._blendMode=c;var d=new u,E=l.create(h);d.color(E.arrColor[0],E.arrColor[1],E.arrColor[2],E.arrColor[3]),f._verticesNum=f._vertices.length/2;var A=f._verticesNum;(!f.vbBuffer||f.vbBuffer.getByteLength()<24*A*3)&&(f.vbBuffer=new ParamData(24*A*3,!0)),f._vbSize=24*A*3;var D=f.vbBuffer._float32Data,R=f.vbBuffer._int32Data,m=4294967295;o&&(m=f._mixRGBandAlpha(m,o));for(var T=0,P=0;P<f._verticesNum;P++)D[T++]=i/f._matrix.a+r[2*P],D[T++]=_/f._matrix.d+r[2*P+1],D[T++]=a[2*P],D[T++]=a[2*P+1],R[T++]=m,R[T++]=4294967295;f._ibNum=n.length;var v=f._ibNum;(!f.ibBuffer||f.ibBuffer.getByteLength()<2*v)&&(f.ibBuffer=new ParamData(2*v,!0,!0)),f._ibSize=2*v;for(var C=f.ibBuffer._int16Data,M=0,S=0;S<f._ibNum;S++)C[M++]=n[S];var g=f._paramData._float32Data,y=f._paramData._int32Data;if(y[t._PARAM_UNIFORMLOCATION_POS_]=3,y[t._PARAM_TEXLOCATION_POS_]=33984,y[t._PARAM_TEXTURE_POS_]=e.bitmap._glTexture.id,y[t._PARAM_VB_POS_]=f.vbBuffer.getPtrID(),y[t._PARAM_VB_SIZE_POS_]=f._vbSize,y[t._PARAM_IB_POS_]=f.ibBuffer.getPtrID(),y[t._PARAM_IB_SIZE_POS_]=f._ibSize,y[t._PARAM_VB_OFFSET_POS_]=0,y[t._PARAM_IB_OFFSET_POS_]=0,y[t._PARAM_INDEX_ELEMENT_OFFSET_POS_]=0,g[t._PARAM_MATRIX_POS_]=f._matrix.a,g[t._PARAM_MATRIX_POS_+1]=f._matrix.b,g[t._PARAM_MATRIX_POS_+2]=f._matrix.c,g[t._PARAM_MATRIX_POS_+3]=f._matrix.d,g[t._PARAM_MATRIX_POS_+4]=f._matrix.tx,g[t._PARAM_MATRIX_POS_+5]=f._matrix.ty,c?(f._setBlendMode(c),y[t._PARAM_BLEND_SRC_POS_]=f._blend_src,y[t._PARAM_BLEND_DEST_POS_]=f._blend_dest):(y[t._PARAM_BLEND_SRC_POS_]=-1,y[t._PARAM_BLEND_DEST_POS_]=-1),h){T=t._PARAM_FILTER_COLOR_POS_;var L=d._mat;g[T++]=L[0],g[T++]=L[1],g[T++]=L[2],g[T++]=L[3],g[T++]=L[4],g[T++]=L[5],g[T++]=L[6],g[T++]=L[7],g[T++]=L[8],g[T++]=L[9],g[T++]=L[10],g[T++]=L[11],g[T++]=L[12],g[T++]=L[13],g[T++]=L[14],g[T++]=L[15],T=t._PARAM_FILTER_ALPHA_POS_;var b=d._alpha;g[T++]=255*b[0],g[T++]=255*b[1],g[T++]=255*b[2],g[T++]=255*b[3]}return $.syncBufferToRenderThread(f.vbBuffer),$.syncBufferToRenderThread(f.ibBuffer),$.syncBufferToRenderThread(f._paramData),h?f._graphicsCmdEncoder.useCommandEncoder(t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.getPtrID(),f._paramData.getPtrID(),-1):f._graphicsCmdEncoder.useCommandEncoder(t._DRAW_TRIANGLES_CMD_ENCODER_.getPtrID(),f._paramData.getPtrID(),-1),$.syncBufferToRenderThread(f._graphicsCmdEncoder),f},t.ID="DrawTriangles",t._DRAW_TRIANGLES_CMD_ENCODER_=null,t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_=null,t._PARAM_UNIFORMLOCATION_POS_=0,t._PARAM_TEXLOCATION_POS_=1,t._PARAM_TEXTURE_POS_=2,t._PARAM_VB_POS_=3,t._PARAM_VB_SIZE_POS_=4,t._PARAM_IB_POS_=5,t._PARAM_IB_SIZE_POS_=6,t._PARAM_VB_OFFSET_POS_=7,t._PARAM_IB_OFFSET_POS_=8,t._PARAM_INDEX_ELEMENT_OFFSET_POS_=9,t._PARAM_BLEND_SRC_POS_=10,t._PARAM_BLEND_DEST_POS_=11,t._PARAM_MATRIX_POS_=12,t._PARAM_FILTER_COLOR_POS_=18,t._PARAM_FILTER_ALPHA_POS_=34}(),function(){function t(){this._graphicsCmdEncoder=null,this._index=0,this._text=null,this._x=NaN,this._y=NaN,this._font=null,this._color=null,this._strokeColor=null,this._strokeWidth=0,this._textAlign=null,this._draw_texture_cmd_encoder_=$.instance.createCommandEncoder(64,32,!0)}r(t,"laya.layagl.cmdNative.FillBorderTextCmdNative");var e=t.prototype;e.createFillBorderText=function(e,i,_,r,a,n,s,o,h){l.create(n).numColor;var u={};u._curMat=new p,u._italicDeg=0,u._drawTextureUseColor=4294967295,u.fillStyle=n,u._fillColor=4294967295,u.setFillColor=function(t){u._fillColor=t},u.getFillColor=function(){return u._fillColor},u.mixRGBandAlpha=function(t){return t},u._drawTextureM=function(t,i,_,r,a,n,s,o){e.useProgramEx(it.PROGRAMEX_DRAWTEXTURE),e.useVDO(it.VDO_MESHQUADTEXTURE),e.uniformEx(it.GLOBALVALUE_VIEWS,0),e.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),e.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),e.uniformTexture(3,33984,t.bitmap._glTexture);var h=new Float32Array([i,_,o[0],o[1],0,0,i+r,_,o[2],o[3],0,0,i+r,_+a,o[4],o[5],0,0,i,_+a,o[6],o[7],0,0]),u=new Int32Array(h.buffer);u[4]=u[10]=u[16]=u[22]=4294967295,u[5]=u[11]=u[17]=u[23]=4294967295,e.setRectMesh(1,h,h.length),e.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),e.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(e)},t.cbook.filltext_native(u,i,_,r,a,n,s,o,h)},e.recover=function(){this._graphicsCmdEncoder=null,O.recover("FillTextCmd",this)},a(0,e,"text",function(){return this._text},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._text=t,this.createFillBorderText(e,this._text,this._x,this._y,this._font,this._color,this._strokeColor,this._strokeWidth,this._textAlign),$.syncBufferToRenderThread(e)}),a(0,e,"cmdID",function(){return"FillBorderText"}),a(0,e,"font",function(){return this._font},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._font=t,this.createFillBorderText(e,this._text,this._x,this._y,this._font,this._color,this._strokeColor,this._strokeWidth,this._textAlign),$.syncBufferToRenderThread(e)}),a(0,e,"color",function(){return this._color},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._color=t,this.createFillBorderText(e,this._text,this._x,this._y,this._font,this._color,this._strokeColor,this._strokeWidth,this._textAlign),$.syncBufferToRenderThread(e)}),a(0,e,"textAlign",function(){return this._textAlign},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._textAlign=t,this.createFillBorderText(e,this._text,this._x,this._y,this._font,this._color,this._strokeColor,this._strokeWidth,this._textAlign),$.syncBufferToRenderThread(e)}),a(0,e,"x",function(){return this._x},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._x=t,this.createFillBorderText(e,this._text,this._x,this._y,this._font,this._color,this._strokeColor,this._strokeWidth,this._textAlign),$.syncBufferToRenderThread(e)}),a(0,e,"y",function(){return this._y},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._y=t,this.createFillBorderText(e,this._text,this._x,this._y,this._font,this._color,this._strokeColor,this._strokeWidth,this._textAlign),$.syncBufferToRenderThread(e)}),t.create=function(e,i,_,r,a,n,s,o){t.cbook||new Error("Error:charbook not create!");var h=O.getItemByClass("FillBorderText",t),u=h._graphicsCmdEncoder=this._commandEncoder;return h._text=e,h._x=i,h._y=_,h._font=r,h._color=a,h._strokeColor=n,h._strokeWidth=s,h._textAlign=o,h._draw_texture_cmd_encoder_.clearEncoding(),h.createFillBorderText(h._draw_texture_cmd_encoder_,e,i,_,r,a,n,s,o),$.syncBufferToRenderThread(h._draw_texture_cmd_encoder_),u.useCommandEncoder(h._draw_texture_cmd_encoder_.getPtrID(),-1,-1),$.syncBufferToRenderThread(u),h},t.ID="FillBorderText",_(t,["cbook",function(){return this.cbook=lt.charbookInst}])}(),function(){function t(){this._graphicsCmdEncoder=null,this._index=0,this._text=null,this._x=NaN,this._y=NaN,this._font=null,this._color=null,this._textAlign=null,this._draw_texture_cmd_encoder_=$.instance.createCommandEncoder(64,32,!0)}r(t,"laya.layagl.cmdNative.FillTextCmdNative");var e=t.prototype;e.createFillText=function(e,i,_,r,a,n,s){var o=l.create(n).numColor,h={};h._curMat=new p,h._italicDeg=0,h._drawTextureUseColor=4294967295,h.fillStyle=n,h._fillColor=4294967295,h.setFillColor=function(t){h._fillColor=t},h.getFillColor=function(){return h._fillColor},h.mixRGBandAlpha=function(t){return t},h._drawTextureM=function(t,i,_,r,a,n,s,h){e.useProgramEx(it.PROGRAMEX_DRAWTEXTURE),e.useVDO(it.VDO_MESHQUADTEXTURE),e.uniformEx(it.GLOBALVALUE_VIEWS,0),e.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),e.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),e.uniformTexture(3,33984,t.bitmap._glTexture);var u=new Float32Array([i,_,h[0],h[1],0,0,i+r,_,h[2],h[3],0,0,i+r,_+a,h[4],h[5],0,0,i,_+a,h[6],h[7],0,0]),l=new Int32Array(u.buffer);l[4]=l[10]=l[16]=l[22]=o,l[5]=l[11]=l[17]=l[23]=4294967295,e.setRectMesh(1,u,u.length),e.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),e.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(e)},t.cbook.filltext_native(h,i,_,r,a,n,null,0,s)},e.recover=function(){this._graphicsCmdEncoder=null,O.recover("FillTextCmd",this)},a(0,e,"text",function(){return this._text},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._text=t,this.createFillText(e,this._text,this._x,this._y,this._font,this._color,this._textAlign),$.syncBufferToRenderThread(e)}),a(0,e,"cmdID",function(){return"FillText"}),a(0,e,"font",function(){return this._font},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._font=t,this.createFillText(e,this._text,this._x,this._y,this._font,this._color,this._textAlign),$.syncBufferToRenderThread(e)}),a(0,e,"color",function(){return this._color},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._color=t,this.createFillText(e,this._text,this._x,this._y,this._font,this._color,this._textAlign),$.syncBufferToRenderThread(e)}),a(0,e,"textAlign",function(){return this._textAlign},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._textAlign=t,this.createFillText(e,this._text,this._x,this._y,this._font,this._color,this._textAlign),$.syncBufferToRenderThread(e)}),a(0,e,"x",function(){return this._x},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._x=t,this.createFillText(e,this._text,this._x,this._y,this._font,this._color,this._textAlign),$.syncBufferToRenderThread(e)}),a(0,e,"y",function(){return this._y},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._y=t,this.createFillText(e,this._text,this._x,this._y,this._font,this._color,this._textAlign),$.syncBufferToRenderThread(e)}),t.create=function(e,i,_,r,a,n){t.cbook||new Error("Error:charbook not create!");var s=O.getItemByClass("FillTextCmd",t),o=s._graphicsCmdEncoder=this._commandEncoder;return s._text=e,s._x=i,s._y=_,s._font=r,s._color=a,s._textAlign=n,s._draw_texture_cmd_encoder_.clearEncoding(),s.createFillText(s._draw_texture_cmd_encoder_,e,i,_,r,a,n),$.syncBufferToRenderThread(s._draw_texture_cmd_encoder_),o.useCommandEncoder(s._draw_texture_cmd_encoder_.getPtrID(),-1,-1),$.syncBufferToRenderThread(o),s},t.ID="FillText",_(t,["cbook",function(){return this.cbook=lt.charbookInst}])}(),function(){function t(){this._graphicsCmdEncoder=null}r(t,"laya.layagl.cmdNative.RestoreCmdNative");var e=t.prototype;e.recover=function(){O.recover("RestoreCmd",this)},a(0,e,"cmdID",function(){return"Restore"}),t.create=function(){var e=O.getItemByClass("RestoreCmd",t),i=e._graphicsCmdEncoder=this._commandEncoder;return i.restore(),$.syncBufferToRenderThread(i),e},t.ID="Restore"}(),function(){function t(){this._graphicsCmdEncoder=null,this._paramData=new ParamData(12,!0)}r(t,"laya.layagl.cmdNative.RotateCmdNative");var e=t.prototype;e.recover=function(){O.recover("RotateCmd",this)},a(0,e,"cmdID",function(){return"Rotate"}),a(0,e,"angle",function(){return this._paramData._float32Data[0]},function(t){this._paramData._float32Data[0]=t,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"pivotX",function(){return this._paramData._float32Data[1]},function(t){this._paramData._float32Data[1]=t,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"pivotY",function(){return this._paramData._float32Data[2]},function(t){this._paramData._float32Data[2]=t,$.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i,_){var r=O.getItemByClass("RotateCmd",t),a=r._graphicsCmdEncoder=this._commandEncoder,n=r._paramData._float32Data;n[0]=e,n[1]=i,n[2]=_;var s=r._paramData.getPtrID();return $.syncBufferToRenderThread(r._paramData),a.setGlobalValueEx(it.GLOBALVALUE_MATRIX32,13,s,0),$.syncBufferToRenderThread(a),r},t.ID="Rotate"}(),function(){function t(){this._graphicsCmdEncoder=null}r(t,"laya.layagl.cmdNative.SaveCmdNative");var e=t.prototype;e.recover=function(){O.recover("SaveCmd",this)},a(0,e,"cmdID",function(){return"Save"}),t.create=function(){var e=O.getItemByClass("SaveCmd",t),i=e._graphicsCmdEncoder=this._commandEncoder;return i.save(),$.syncBufferToRenderThread(i),e},t.ID="Save"}(),function(){function t(){this._graphicsCmdEncoder=null,this._paramData=new ParamData(16,!0)}r(t,"laya.layagl.cmdNative.ScaleCmdNative");var e=t.prototype;e.recover=function(){O.recover("ScaleCmd",this)},a(0,e,"cmdID",function(){return"Scale"}),a(0,e,"scaleX",function(){return this._paramData._float32Data[0]},function(t){this._paramData._float32Data[0]=t,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"scaleY",function(){return this._paramData._float32Data[1]},function(t){this._paramData._float32Data[1]=t,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"pivotX",function(){return this._paramData._float32Data[2]},function(t){this._paramData._float32Data[2]=t,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"pivotY",function(){return this._paramData._float32Data[3]},function(t){this._paramData._float32Data[3]=t,$.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i,_,r){var a=O.getItemByClass("ScaleCmd",t),n=a._graphicsCmdEncoder=this._commandEncoder,s=a._paramData._float32Data;s[0]=e,s[1]=i,s[2]=_,s[3]=r;var o=a._paramData.getPtrID();return $.syncBufferToRenderThread(a._paramData),n.setGlobalValueEx(it.GLOBALVALUE_MATRIX32,12,o,0),$.syncBufferToRenderThread(n),a},t.ID="Scale"}(),function(){function t(){this._graphicsCmdEncoder=null,this._matrix=null,this._paramData=new ParamData(32,!0)}r(t,"laya.layagl.cmdNative.TransformCmdNative");var e=t.prototype;e.recover=function(){this._matrix=null,O.recover("TransformCmd",this)},a(0,e,"cmdID",function(){return"Transform"}),a(0,e,"matrix",function(){return this._matrix},function(t){this._matrix=t;var e=this._paramData._float32Data;e[0]=this._matrix.a,e[1]=this._matrix.b,e[2]=this._matrix.c,e[3]=this._matrix.d,e[4]=this._matrix.tx,e[5]=this._matrix.ty,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"pivotX",function(){return this._paramData._float32Data[6]},function(t){this._paramData._float32Data[6]=t,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"pivotY",function(){return this._paramData._float32Data[7]},function(t){this._paramData._float32Data[7]=t,$.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i,_){var r=O.getItemByClass("TransformCmd",t),a=r._graphicsCmdEncoder=this._commandEncoder,n=r._paramData._float32Data;n[0]=e.a,n[1]=e.b,n[2]=e.c,n[3]=e.d,n[4]=e.tx,n[5]=e.ty,n[6]=i,n[7]=_,r._matrix=e;var s=r._paramData.getPtrID();return $.syncBufferToRenderThread(r._paramData),a.setGlobalValueEx(it.GLOBALVALUE_MATRIX32,14,s,0),$.syncBufferToRenderThread(a),r},t.ID="Transform"}(),function(){function t(){this._graphicsCmdEncoder=null,this._paramData=new ParamData(8,!0)}r(t,"laya.layagl.cmdNative.TranslateCmdNative");var e=t.prototype;e.recover=function(){O.recover("TranslateCmd",this)},a(0,e,"ty",function(){return this._paramData._float32Data[1]},function(t){this._paramData._float32Data[1]=t,$.syncBufferToRenderThread(this._paramData)}),a(0,e,"cmdID",function(){return"Translate"}),a(0,e,"tx",function(){return this._paramData._float32Data[0]},function(t){this._paramData._float32Data[0]=t,$.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i){var _=O.getItemByClass("TranslateCmd",t),r=_._graphicsCmdEncoder=this._commandEncoder,a=_._paramData._float32Data;a[0]=e,a[1]=i;var n=_._paramData.getPtrID();return $.syncBufferToRenderThread(_._paramData),r.setGlobalValueEx(it.GLOBALVALUE_MATRIX32,9,n,0),$.syncBufferToRenderThread(r),_},t.ID="Translate"}(),function(){function t(t,e,i,_){this._idata=[]}r(t,"laya.layagl.CommandEncoder");var e=t.prototype;return e.getArrayData=function(){return this._idata},e.getPtrID=function(){return 0},e.beginEncoding=function(){},e.endEncoding=function(){},e.clearEncoding=function(){this._idata.length=0},e.getCount=function(){return this._idata.length},e.add_ShaderValue=function(t){this._idata.push(t)},e.addShaderUniform=function(t){this.add_ShaderValue(t)},t}()),Q=function(){function t(){}return r(t,"laya.layagl.ConchCmdReplace"),t.__init__=function(){var t,e=laya.display.cmd,i=laya.layagl.cmdNative;for(t in e)i[t+"Native"]&&(e[t].create=i[t+"Native"].create)},t}(),q=function(){function t(){this._commandEncoder=null}r(t,"laya.layagl.ConchGraphicsAdpt");var e=t.prototype;return e._createData=function(){this._commandEncoder=$.instance.createCommandEncoder(128,64,!0)},e._clearData=function(){this._commandEncoder&&this._commandEncoder.clearEncoding()},e._destroyData=function(){this._commandEncoder&&(this._commandEncoder.clearEncoding(),this._commandEncoder=null)},t.__init__=function(){var e=T.prototype,i=t.prototype,_=["_createData","_clearData","_destroyData"],r=0,a=0;a=_.length;var n;for(r=0;r<a;r++)e[n=_[r]]=i[n]},t}(),$=function(){function t(){}r(t,"laya.layagl.LayaGL");var e=t.prototype;return e.createCommandEncoder=function(t,e,i){return void 0===t&&(t=128),void 0===e&&(e=64),void 0===i&&(i=!1),new K(this,t,e,i)},e.beginCommandEncoding=function(t){},e.endCommandEncoding=function(){},t.getFrameCount=function(){return 0},t.syncBufferToRenderThread=function(t,e){void 0===e&&(e=0)},t.createArrayBufferRef=function(t,e,i){},t.createArrayBufferRefs=function(t,e,i,_){},t.EXECUTE_JS_THREAD_BUFFER=0,t.EXECUTE_RENDER_THREAD_BUFFER=1,t.EXECUTE_COPY_TO_RENDER=2,t.EXECUTE_COPY_TO_RENDER3D=3,t.VALUE_OPERATE_ADD=0,t.VALUE_OPERATE_SUB=1,t.VALUE_OPERATE_MUL=2,t.VALUE_OPERATE_DIV=3,t.VALUE_OPERATE_M2_MUL=4,t.VALUE_OPERATE_M3_MUL=5,t.VALUE_OPERATE_M4_MUL=6,t.VALUE_OPERATE_M32_MUL=7,t.VALUE_OPERATE_SET=8,t.VALUE_OPERATE_M32_TRANSLATE=9,t.VALUE_OPERATE_M32_SCALE=10,t.VALUE_OPERATE_M32_ROTATE=11,t.VALUE_OPERATE_M32_SCALE_PIVOT=12,t.VALUE_OPERATE_M32_ROTATE_PIVOT=13,t.VALUE_OPERATE_M32_TRANSFORM_PIVOT=14,t.VALUE_OPERATE_BYTE4_COLOR_MUL=15,t.ARRAY_BUFFER_TYPE_DATA=0,t.ARRAY_BUFFER_TYPE_CMD=1,t.ARRAY_BUFFER_REF_REFERENCE=0,t.ARRAY_BUFFER_REF_COPY=1,t.UPLOAD_SHADER_UNIFORM_TYPE_ID=0,t.UPLOAD_SHADER_UNIFORM_TYPE_DATA=1,t.instance=null,t}(),J=function(){function t(){this._customCmds=null,this._targets=null,this._width=0,this._height=0}r(t,"laya.layagl.LayaGLRenderingContext");var e=t.prototype;return e.drawTexture=function(t,e,i,_,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===_&&(_=0),void 0===r&&(r=0),this.drawImage(t,e,i,_,r)},e.drawImage=function(t,e,i,_,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===_&&(_=0),void 0===r&&(r=0),this._customCmds.push(E.create.call(this,t,e,i,_,r))},e.fillText=function(t,e,i,_,r,a){this._customCmds.push(A.create.call(this,t,e,i,_||G.defaultFontStr(),r,a))},e.save=function(){this._customCmds.push(x.create.call(this))},e.restore=function(){this._customCmds.push(b.create.call(this))},e.translate=function(t,e){this._customCmds.push(z.create.call(this,t,e))},e.rotate=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0),this._customCmds.push(B.create.call(this,t,e,i))},e.scale=function(t,e,i,_){void 0===i&&(i=0),void 0===_&&(_=0),this._customCmds.push(N.create.call(this,t,e,i,_))},e.transform=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0),this._customCmds.push(k.create.call(this,t,e,i))},e.beginRT=function(){ie.pushRT(),this._targets.start(),this.clear()},e.clear=function(){},e.endRT=function(){ie.popRT()},e.drawCanvas=function(t,e,i){var _=t.context._targets;this._customCmds.push(d.create.call(this,_,e,i,_.width,_.height))},e.drawTarget=function(t,e,i,_,r,a){var n=new ArrayBuffer(96),s=new Int32Array(n),o=new Float32Array(n),h=0!=r?r:e.width,u=0!=a?a:e.height,l=ie.flipyuv,c=0;o[c++]=i,o[c++]=_,o[c++]=l[0],o[c++]=l[1],s[c++]=4294967295,s[c++]=4294967295,o[c++]=i+h,o[c++]=_,o[c++]=l[2],o[c++]=l[3],s[c++]=4294967295,s[c++]=4294967295,o[c++]=i+h,o[c++]=_+u,o[c++]=l[4],o[c++]=l[5],s[c++]=4294967295,s[c++]=4294967295,o[c++]=i,o[c++]=_+u,o[c++]=l[6],o[c++]=l[7],s[c++]=4294967295,s[c++]=4294967295,t.useProgramEx(it.PROGRAMEX_DRAWTEXTURE),t.useVDO(it.VDO_MESHQUADTEXTURE),t.uniformEx(it.GLOBALVALUE_VIEWS,0),t.uniformEx(it.GLOBALVALUE_CLIP_MAT_DIR,1),t.uniformEx(it.GLOBALVALUE_CLIP_MAT_POS,2),t.uniformTexture(0,33984,e._getSource()),t.setRectMesh(1,n),t.modifyMesh(it.GLOBALVALUE_MATRIX32,0,7),t.modifyMesh(it.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15)},a(0,e,"asBitmap",function(){return!this._targets},function(t){if(t){if(this._targets||(this._targets=new ie(this._width,this._height,1,-1)),!this._width||!this._height)throw Error("asBitmap no size!")}else this._targets=null}),t}(),tt=function(){function t(){}return r(t,"laya.layagl.LayaGLRunner"),t.uploadShaderUniforms=function(t,e,i,_){for(var r=i._data,a=e.getArrayData(),n=0,s=0,o=a.length;s<o;s++){var h=a[s];if(_||-1!==h.textureID){var u=r[h.dataOffset];null!=u&&(n+=h.fun.call(h.caller,h,u))}}return n},t.uploadCustomUniform=function(t,e,i,_){var r=0,a=e[i];return a&&null!=_&&(r+=a.fun.call(a.caller,a,_)),r},t.uploadShaderUniformsForNative=function(t,e,i){var _=0;i._runtimeCopyValues.length>=0&&(_=1);var r=i._data;return t.uploadShaderUniforms(e,r,_)},t}(),et=function(){function e(){this._commStr="",this._commandEncoder=null,this._id=0,this._commandEncoder=$.instance.createCommandEncoder(64,16,!1)}r(e,"laya.layagl.LayaGLTemplate");return e.prototype.addComd=function(t,e){this._commStr+=t+"("+e+");",this._commandEncoder[t].apply(this._commandEncoder,e)},e.createByRenderType=function(i){var _=e.GLS[i]=new e;g.isConchApp&&t.conch.setGLTemplate(i,_._commandEncoder.getPtrID());for(var r=1;r<=8192;){if(i&r&&e.__FUN_PARAM__[r])for(var a=e.__FUN_PARAM__[r],n=0,s=a.length;n<s;n++){var o=a[n];_.addComd(o.func,o.args)}r<<=1}return _._id=i,console.log("template="+_._commStr),_},e.createByRenderTypeEnd=function(i){var _=e.GLSE[i]=new e;g.isConchApp&&t.conch.setEndGLTemplate(i,_._commandEncoder.getPtrID());for(var r=8192;r>1;){if(i&r&&e.__FUN_PARAM_END_[r])for(var a=e.__FUN_PARAM_END_[r],n=0,s=a.length;n<s;n++){var o=a[n];_.addComd(o.func,o.args)}r>>=1}return _._id=i,console.log("templateEnd="+_._commStr),_},e.__init__=function(){e.__FUN_PARAM__[1]=[{func:"setGlobalValueByParamData",args:[it.GLOBALVALUE_DRAWTEXTURE_COLOR,15,88]}],e.__FUN_PARAM__[2]=[{func:"calcLocalMatrix32",args:[60,64,24,28,32,36,40,44,48,52,56]},{func:"setGlobalValueByParamData",args:[it.GLOBALVALUE_MATRIX32,7,64]}],e.__FUN_PARAM__[4]=[{func:"setGlobalValueByParamData",args:[it.GLOBALVALUE_BLENDFUNC_SRC,8,284]},{func:"setGlobalValueByParamData",args:[it.GLOBALVALUE_BLENDFUNC_DEST,8,288]}],e.__FUN_PARAM__[256]=[{func:"useCommandEncoderByParamData",args:[96,100,1]}],e.__FUN_PARAM__[512]=[{func:"callbackJSByParamData",args:[216,272]},{func:"useCommandEncoderByParamData",args:[92,-1,1]}],e.__FUN_PARAM__[1024]=[{func:"callbackJSByParamData",args:[216,248]},{func:"useCommandEncoderByParamData",args:[104,-1,3]}],e.__FUN_PARAM__[2048]=[{func:"callbackJSByParamData",args:[216,220]},{func:"useCommandEncoderByParamData",args:[108,-1,1]}],e.__FUN_PARAM__[64]=[{func:"setClipByParamData",args:[it.GLOBALVALUE_CLIP_MAT_DIR,it.GLOBALVALUE_CLIP_MAT_POS,it.GLOBALVALUE_MATRIX32,112]},{func:"setGlobalValueByParamData",args:[it.GLOBALVALUE_MATRIX32,9,128]}],e.__FUN_PARAM__[16]=[{func:"callbackJSByParamData",args:[216,260]},{func:"useCommandEncoderByParamData",args:[256,-1,0]}],e.__FUN_PARAM__[32]=[{func:"callbackJSByParamData",args:[216,276]},{func:"useCommandEncoderByParamData",args:[280,-1,0]}],e.__FUN_PARAM__[8]=[{func:"callbackJSByParamData",args:[216,224]},{func:"loadDataToRegByParamData",args:[0,252,4]},{func:"ifGreater0",args:[0,2147483647]},{func:"useCommandEncoderByParamData",args:[232,-1,0]}],e.__FUN_PARAM__[128]=[{func:"useCommandEncoderByParamData",args:[292,296,1]},{func:"useCommandEncoderByParamData",args:[300,304,1]}]},e.__init_END_=function(){e.__FUN_PARAM_END_[16]=[{func:"loadDataToRegByParamData",args:[0,252,4]},{func:"ifGreater0",args:[0,2]},{func:"callbackJSByParamData",args:[216,268]},{func:"useCommandEncoderByParamData",args:[264,-1,1]}],e.__FUN_PARAM_END_[8]=[{func:"callbackJSByParamData",args:[216,228]},{func:"useCommandEncoderByParamData",args:[236,-1,0]},{func:"useCommandEncoderByParamData",args:[240,244,1]}]},e.GLS=[],e.GLSE=[],e.__FUN_PARAM__=[],e.__FUN_PARAM_END_=[],e}(),it=function(){function t(){}return r(t,"laya.layagl.LayaNative2D"),t._init_simple_texture_cmdEncoder_=function(){(t._SIMPLE_TEXTURE_CMDENCODER_=$.instance.createCommandEncoder(124,32,!0)).useProgramEx(laya.layagl.LayaNative2D.PROGRAMEX_DRAWTEXTURE),t._SIMPLE_TEXTURE_CMDENCODER_.useVDO(laya.layagl.LayaNative2D.VDO_MESHQUADTEXTURE),t._SIMPLE_TEXTURE_CMDENCODER_.uniformEx(laya.layagl.LayaNative2D.GLOBALVALUE_VIEWS,0),t._SIMPLE_TEXTURE_CMDENCODER_.uniformEx(laya.layagl.LayaNative2D.GLOBALVALUE_CLIP_MAT_DIR,1),t._SIMPLE_TEXTURE_CMDENCODER_.uniformEx(laya.layagl.LayaNative2D.GLOBALVALUE_CLIP_MAT_POS,2),t._SIMPLE_TEXTURE_CMDENCODER_.uniformTextureByParamData(0,4,8),t._SIMPLE_TEXTURE_CMDENCODER_.blendFuncByGlobalValue(laya.layagl.LayaNative2D.GLOBALVALUE_BLENDFUNC_SRC,laya.layagl.LayaNative2D.GLOBALVALUE_BLENDFUNC_DEST),t._SIMPLE_TEXTURE_CMDENCODER_.setRectMeshByParamData(12,20,16),t._SIMPLE_TEXTURE_CMDENCODER_.modifyMesh(laya.layagl.LayaNative2D.GLOBALVALUE_MATRIX32,0,7),t._SIMPLE_TEXTURE_CMDENCODER_.modifyMesh(laya.layagl.LayaNative2D.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._SIMPLE_TEXTURE_CMDENCODER_)},t._init_simple_rect_cmdEncoder_=function(){(t._SIMPLE_RECT_CMDENCODER_=$.instance.createCommandEncoder(84,32,!0)).useProgramEx(laya.layagl.LayaNative2D.PROGRAMEX_DRAWTEXTURE),t._SIMPLE_RECT_CMDENCODER_.useVDO(laya.layagl.LayaNative2D.VDO_MESHQUADTEXTURE),t._SIMPLE_RECT_CMDENCODER_.uniformEx(laya.layagl.LayaNative2D.GLOBALVALUE_VIEWS,0),t._SIMPLE_RECT_CMDENCODER_.uniformEx(laya.layagl.LayaNative2D.GLOBALVALUE_CLIP_MAT_DIR,1),t._SIMPLE_RECT_CMDENCODER_.uniformEx(laya.layagl.LayaNative2D.GLOBALVALUE_CLIP_MAT_POS,2),t._SIMPLE_RECT_CMDENCODER_.setRectMeshByParamData(0,8,4),t._SIMPLE_RECT_CMDENCODER_.modifyMesh(laya.layagl.LayaNative2D.GLOBALVALUE_MATRIX32,0,7),t._SIMPLE_RECT_CMDENCODER_.modifyMesh(laya.layagl.LayaNative2D.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._SIMPLE_RECT_CMDENCODER_)},t._init_rect_border_cmdEncoder_=function(){(t._RECT_BORDER_CMD_ENCODER_=$.instance.createCommandEncoder(84,32,!0)).useProgramEx(laya.layagl.LayaNative2D.PROGRAMEX_DRAWVG),t._RECT_BORDER_CMD_ENCODER_.useVDO(laya.layagl.LayaNative2D.VDO_MESHVG),t._RECT_BORDER_CMD_ENCODER_.uniformEx(laya.layagl.LayaNative2D.GLOBALVALUE_VIEWS,0),t._RECT_BORDER_CMD_ENCODER_.uniformEx(laya.layagl.LayaNative2D.GLOBALVALUE_CLIP_MAT_DIR,1),t._RECT_BORDER_CMD_ENCODER_.uniformEx(laya.layagl.LayaNative2D.GLOBALVALUE_CLIP_MAT_POS,2),t._RECT_BORDER_CMD_ENCODER_.setMeshByParamData(20,0,4,140,8,12,16),t._RECT_BORDER_CMD_ENCODER_.modifyMesh(laya.layagl.LayaNative2D.GLOBALVALUE_MATRIX32,0,7),t._RECT_BORDER_CMD_ENCODER_.modifyMesh(laya.layagl.LayaNative2D.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),$.syncBufferToRenderThread(t._RECT_BORDER_CMD_ENCODER_)},t.__init__=function(){if(g.isConchApp){var e=$.instance;t.GLOBALVALUE_MATRIX32=e.addGlobalValueDefine(0,5126,6,new Float32Array([1,0,0,1,0,0])),t.GLOBALVALUE_DRAWTEXTURE_COLOR=e.addGlobalValueDefine(0,5124,1,new Uint32Array([4294967295])),t.GLOBALVALUE_ITALICDEG=e.addGlobalValueDefine(0,5126,1,new Float32Array([0])),t.GLOBALVALUE_CLIP_MAT_DIR=e.addGlobalValueDefine(0,5126,4,new Float32Array([1e6,0,0,1e6])),t.GLOBALVALUE_CLIP_MAT_POS=e.addGlobalValueDefine(0,5126,2,new Float32Array([0,0])),t.GLOBALVALUE_BLENDFUNC_SRC=e.addGlobalValueDefine(0,5124,1,new Int32Array([1])),t.GLOBALVALUE_BLENDFUNC_DEST=e.addGlobalValueDefine(0,5124,1,new Int32Array([771])),t.GLOBALVALUE_COLORFILTER_COLOR=e.addGlobalValueDefine(0,5126,16,new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])),t.GLOBALVALUE_COLORFILTER_ALPHA=e.addGlobalValueDefine(0,5126,4,new Float32Array([0,0,0,1])),t.GLOBALVALUE_BLURFILTER_STRENGTH=e.addGlobalValueDefine(0,5126,4,new Float32Array([0,0,0,0])),t.GLOBALVALUE_BLURFILTER_BLURINFO=e.addGlobalValueDefine(0,5126,2,new Float32Array([0,0])),t.GLOBALVALUE_GLOWFILTER_COLOR=e.addGlobalValueDefine(0,5126,4,new Float32Array([0,0,0,0])),t.GLOBALVALUE_GLOWFILTER_BLURINFO1=e.addGlobalValueDefine(0,5126,4,new Float32Array([0,0,0,0])),t.GLOBALVALUE_GLOWFILTER_BLURINFO2=e.addGlobalValueDefine(0,5126,4,new Float32Array([0,0,0,0])),e.endGlobalValueDefine(),t.PROGRAMEX_DRAWTEXTURE=$.instance.createProgramEx("/*\n\ttexture和fillrect使用的。\n*/\nattribute vec4 posuv;\nattribute vec4 attribColor;\nattribute vec4 attribFlags;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;\nvarying vec2 cliped;\nuniform vec2 size;\n\n#ifdef WORLDMAT\n\tuniform mat4 mmat;\n#endif\n\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\n\nvoid main() {\n\n#ifdef WORLDMAT\n\tvec4 pos=mmat*vec4(posuv.xy,0.,1.);\n\tgl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,0.,1.0);\n#else\n\tgl_Position =vec4((posuv.x/size.x-0.5)*2.0,(0.5-posuv.y/size.y)*2.0,0.,1.0);\n#endif\n  \n\tv_texcoordAlpha.xy = posuv.zw;\n\t//v_texcoordAlpha.z = attribColor.a/255.0;\n\tv_color = attribColor/255.0;\n\tv_color.xyz*=v_color.w;//反正后面也要预乘\n\t\n\tv_useTex = attribFlags.r/255.0;\n\tfloat clipw = length(clipMatDir.xy);\n\tfloat cliph = length(clipMatDir.zw);\n\tvec2 clippos = posuv.xy - clipMatPos.xy;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\n\tif(clipw>20000. && cliph>20000.)\n\t\tcliped = vec2(0.5,0.5);\n\telse {\n\t\t//转成0到1之间。/clipw/clipw 表示clippos与normalize之后的clip朝向点积之后，再除以clipw\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n\t}\n\n}","/*\n\ttexture和fillrect使用的。\n*/\n\nprecision mediump float;\n//precision highp float;\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\nuniform sampler2D texture;\nvarying vec2 cliped;\n\n#ifdef BLUR_FILTER\nuniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoordAlpha.xy-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4Color += texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}\n#endif\n\n#ifdef COLOR_FILTER\nuniform vec4 colorAlpha;\nuniform mat4 colorMat;\n#endif\n\n#ifdef GLOW_FILTER\nuniform vec4 u_color;\nuniform vec4 u_blurInfo1;/*\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\n*/\nuniform vec4 u_blurInfo2;/*\nuniform float u_textW;\nuniform float u_textH;\nuniform float u_strength;\n*/\n#endif\n\n#ifdef COLOR_ADD\nuniform vec4 colorAdd;\n#endif\n\nvoid main() {\n\tif(cliped.x<0.) discard;\n\tif(cliped.x>1.) discard;\n\tif(cliped.y<0.) discard;\n\tif(cliped.y>1.) discard;\n\t\n   vec4 color= texture2D(texture, v_texcoordAlpha.xy);\n   if(v_useTex<=0.)color = vec4(1.,1.,1.,1.);\n   color.a*=v_color.w;\n   //color.rgb*=v_color.w;\n   color.rgb*=v_color.rgb;\n   gl_FragColor=color;\n   \n   #ifdef COLOR_ADD\n\tgl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\n\tgl_FragColor.xyz *= colorAdd.a;\n   #endif\n   \n   #ifdef BLUR_FILTER\n\tgl_FragColor =   blur();\n\tgl_FragColor.w*=v_color.w;   \n   #endif\n   \n   #ifdef COLOR_FILTER\n\tmat4 alphaMat =colorMat;\n\n\talphaMat[0][3] *= gl_FragColor.a;\n\talphaMat[1][3] *= gl_FragColor.a;\n\talphaMat[2][3] *= gl_FragColor.a;\n\n\tgl_FragColor = gl_FragColor * alphaMat;\n\tgl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n   #endif\n   \n   #ifdef GLOW_FILTER\n\tconst float c_IterationTime = 10.0;\n\tfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\n\tvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n\tvec2 vec2FilterDir = vec2(-(u_blurInfo1.z)/u_blurInfo2.x,-(u_blurInfo1.w)/u_blurInfo2.y);\n\tvec2 vec2FilterOff = vec2(u_blurInfo1.x/u_blurInfo2.x/c_IterationTime * 2.0,u_blurInfo1.y/u_blurInfo2.y/c_IterationTime * 2.0);\n\tfloat maxNum = u_blurInfo1.x * u_blurInfo1.y;\n\tvec2 vec2Off = vec2(0.0,0.0);\n\tfloat floatOff = c_IterationTime/2.0;\n\tfor(float i = 0.0;i<=c_IterationTime; ++i){\n\t\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\t\tvec4Color += texture2D(texture, v_texcoordAlpha.xy + vec2FilterDir + vec2Off)/floatIterationTotalTime;\n\t\t}\n\t}\n\tgl_FragColor = vec4(u_color.rgb,vec4Color.a * u_blurInfo2.z);\n\tgl_FragColor.rgb *= gl_FragColor.a;   \n   #endif\n   \n}","posuv,attribColor,attribFlags","size,clipMatDir,clipMatPos,texture,colorMat,colorAlpha,strength_sig2_2sig2_gauss1,blurInfo,u_color,u_blurInfo1,u_blurInfo2"),t.PROGRAMEX_DRAWVG=$.instance.createProgramEx("attribute vec4 position;\nattribute vec4 attribColor;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;\n#ifdef WORLDMAT\n\tuniform mat4 mmat;\n#endif\nuniform mat4 u_mmat2;\n//uniform vec2 u_pos;\nuniform vec2 size;\nvarying vec4 color;\n//vec4 dirxy=vec4(0.9,0.1, -0.1,0.9);\n//vec4 clip=vec4(100.,30.,300.,600.);\nvarying vec2 cliped;\nvoid main(){\n\t\n#ifdef WORLDMAT\n\tvec4 pos=mmat*vec4(position.xy,0.,1.);\n\tgl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n#else\n\tgl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n#endif\t\n\tfloat clipw = length(clipMatDir.xy);\n\tfloat cliph = length(clipMatDir.zw);\n\tvec2 clippos = position.xy - clipMatPos.xy;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\n\tif(clipw>20000. && cliph>20000.)\n\t\tcliped = vec2(0.5,0.5);\n\telse {\n\t\t//clipdir是带缩放的方向，由于上面clippos是在缩放后的空间计算的，所以需要把方向先normalize一下\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n\t}\n  //pos2d.x = dot(clippos,dirx);\n  color=attribColor/255.;\n}","precision mediump float;\n//precision mediump float;\nvarying vec4 color;\n//uniform float alpha;\nvarying vec2 cliped;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor= color;// vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=color.a;\n\tif(cliped.x<0.) discard;\n\tif(cliped.x>1.) discard;\n\tif(cliped.y<0.) discard;\n\tif(cliped.y>1.) discard;\n}","position,attribColor","size,clipMatDir,clipMatPos"),t.PROGRAMEX_DRAWPARTICLE=$.instance.createProgramEx("attribute vec4 a_CornerTextureCoordinate;\nattribute vec3 a_Position;\nattribute vec3 a_Velocity;\nattribute vec4 a_StartColor;\nattribute vec4 a_EndColor;\nattribute vec3 a_SizeRotation;\nattribute vec2 a_Radius;\nattribute vec4 a_Radian;\nattribute float a_AgeAddScale;\nattribute float a_Time;\n\nvarying vec4 v_Color;\nvarying vec2 v_TextureCoordinate;\n\nuniform float u_CurrentTime;\nuniform float u_Duration;\nuniform float u_EndVelocity;\nuniform vec3 u_Gravity;\n\nuniform vec2 size;\nuniform mat4 u_mmat;\n\nvec4 ComputeParticlePosition(in vec3 position, in vec3 velocity,in float age,in float normalizedAge)\n{\n\n   float startVelocity = length(velocity);//起始标量速度\n   float endVelocity = startVelocity * u_EndVelocity;//结束标量速度\n\n   float velocityIntegral = startVelocity * normalizedAge +(endVelocity - startVelocity) * normalizedAge *normalizedAge/2.0;//计算当前速度的标量（单位空间），vt=v0*t+(1/2)*a*(t^2)\n   \n   vec3 addPosition = normalize(velocity) * velocityIntegral * u_Duration;//计算受自身速度影响的位置，转换标量到矢量    \n   addPosition += u_Gravity * age * normalizedAge;//计算受重力影响的位置\n   \n   float radius=mix(a_Radius.x, a_Radius.y, normalizedAge); //计算粒子受半径和角度影响（无需计算角度和半径时，可用宏定义优化屏蔽此计算）\n   float radianHorizontal =mix(a_Radian.x,a_Radian.z,normalizedAge);\n   float radianVertical =mix(a_Radian.y,a_Radian.w,normalizedAge);\n   \n   float r =cos(radianVertical)* radius;\n   addPosition.y += sin(radianVertical) * radius;\n\t\n   addPosition.x += cos(radianHorizontal) *r;\n   addPosition.z += sin(radianHorizontal) *r;\n  \n   addPosition.y=-addPosition.y;//2D粒子位置更新需要取负，2D粒子坐标系Y轴正向朝上\n   position+=addPosition;\n   return  vec4(position,1.0);\n}\n\nfloat ComputeParticleSize(in float startSize,in float endSize, in float normalizedAge)\n{    \n    float size = mix(startSize, endSize, normalizedAge);\n    return size;\n}\n\nmat2 ComputeParticleRotation(in float rot,in float age)\n{    \n    float rotation =rot * age;\n    //计算2x2旋转矩阵.\n    float c = cos(rotation);\n    float s = sin(rotation);\n    return mat2(c, -s, s, c);\n}\n\nvec4 ComputeParticleColor(in vec4 startColor,in vec4 endColor,in float normalizedAge)\n{\n\tvec4 color=mix(startColor,endColor,normalizedAge);\n    //硬编码设置，使粒子淡入很快，淡出很慢,6.7的缩放因子把置归一在0到1之间，可以谷歌x*(1-x)*(1-x)*6.7的制图表\n    color.a *= normalizedAge * (1.0-normalizedAge) * (1.0-normalizedAge) * 6.7;\n   \n    return color;\n}\n\nvoid main()\n{\n   float age = u_CurrentTime - a_Time;\n   age *= 1.0 + a_AgeAddScale;\n   float normalizedAge = clamp(age / u_Duration,0.0,1.0);\n   gl_Position = ComputeParticlePosition(a_Position, a_Velocity, age, normalizedAge);//计算粒子位置\n   float pSize = ComputeParticleSize(a_SizeRotation.x,a_SizeRotation.y, normalizedAge);\n   mat2 rotation = ComputeParticleRotation(a_SizeRotation.z, age);\n\t\n    mat4 mat=u_mmat;\n    gl_Position=vec4((mat*gl_Position).xy,0.0,1.0);\n    gl_Position.xy += (rotation*a_CornerTextureCoordinate.xy) * pSize*vec2(mat[0][0],mat[1][1]);\n    gl_Position=vec4((gl_Position.x/size.x-0.5)*2.0,(0.5-gl_Position.y/size.y)*2.0,0.0,1.0);\n   \n   v_Color = ComputeParticleColor(a_StartColor,a_EndColor, normalizedAge);\n   v_TextureCoordinate =a_CornerTextureCoordinate.zw;\n}\n\n","#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nvarying vec4 v_Color;\nvarying vec2 v_TextureCoordinate;\nuniform sampler2D u_texture;\n\nvoid main()\n{\t\n\tgl_FragColor=texture2D(u_texture,v_TextureCoordinate)*v_Color;\n\tgl_FragColor.xyz *= v_Color.w;\n}","a_CornerTextureCoordinate,a_Position,a_Velocity,a_StartColor,a_EndColor,a_SizeRotation,a_Radius,a_Radian,a_AgeAddScale,a_Time","u_CurrentTime,u_Duration,u_EndVelocity,u_Gravity,size,u_mmat,u_texture"),t.VDO_MESHQUADTEXTURE=e.createVDO(new Int32Array([5126,0,4,24,5121,16,4,24,5121,20,4,24])),t.VDO_MESHVG=e.createVDO(new Int32Array([5126,0,2,12,5121,8,4,12])),t.VDO_MESHPARTICLE=e.createVDO(new Int32Array([5126,0,4,116,5126,16,3,116,5126,28,3,116,5126,40,4,116,5126,56,4,116,5126,72,3,116,5126,84,2,116,5126,92,4,116,5126,108,1,116,5126,112,1,116])),t._init_simple_texture_cmdEncoder_(),t._init_simple_rect_cmdEncoder_(),t._init_rect_border_cmdEncoder_(),t.SHADER_MACRO_COLOR_FILTER=$.instance.defineShaderMacro("#define COLOR_FILTER",[{uname:4,id:t.GLOBALVALUE_COLORFILTER_COLOR},{uname:5,id:t.GLOBALVALUE_COLORFILTER_ALPHA}]),t.SHADER_MACRO_BLUR_FILTER=$.instance.defineShaderMacro("#define BLUR_FILTER",[{uname:6,id:t.GLOBALVALUE_BLURFILTER_STRENGTH},{uname:7,id:t.GLOBALVALUE_BLURFILTER_BLURINFO}]),t.SHADER_MACRO_GLOW_FILTER=$.instance.defineShaderMacro("#define GLOW_FILTER",[{uname:8,id:t.GLOBALVALUE_GLOWFILTER_COLOR},{uname:9,id:t.GLOBALVALUE_GLOWFILTER_BLURINFO1},{uname:10,id:t.GLOBALVALUE_GLOWFILTER_BLURINFO2}]),et.__init__(),et.__init_END_(),new lt,ft.charRender=new Wt}},t._SIMPLE_TEXTURE_CMDENCODER_=null,t._SIMPLE_RECT_CMDENCODER_=null,t._RECT_BORDER_CMD_ENCODER_=null,t.PROGRAMEX_DRAWTEXTURE=0,t.PROGRAMEX_DRAWVG=0,t.PROGRAMEX_DRAWRECT=0,t.PROGRAMEX_DRAWPARTICLE=0,t.VDO_MESHQUADTEXTURE=0,t.VDO_MESHVG=0,t.VDO_MESHPARTICLE=0,t.GLOBALVALUE_VIEWS=0,t.GLOBALVALUE_MATRIX32=0,t.GLOBALVALUE_DRAWTEXTURE_COLOR=0,t.GLOBALVALUE_ITALICDEG=0,t.GLOBALVALUE_CLIP_MAT_DIR=0,t.GLOBALVALUE_CLIP_MAT_POS=0,t.GLOBALVALUE_BLENDFUNC_SRC=0,t.GLOBALVALUE_BLENDFUNC_DEST=0,t.GLOBALVALUE_COLORFILTER_COLOR=0,t.GLOBALVALUE_COLORFILTER_ALPHA=0,t.GLOBALVALUE_BLURFILTER_STRENGTH=0,t.GLOBALVALUE_BLURFILTER_BLURINFO=0,t.SHADER_MACRO_COLOR_FILTER=0,t.SHADER_MACRO_BLUR_FILTER=0,t.SHADER_MACRO_GLOW_FILTER=0,t.GLOBALVALUE_GLOWFILTER_COLOR=0,t.GLOBALVALUE_GLOWFILTER_BLURINFO1=0,t.GLOBALVALUE_GLOWFILTER_BLURINFO2=0,t}(),_t=function(){function t(t,e,i,_,r,a,n){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===_&&(_=1),void 0===r&&(r=0),void 0===a&&(a=0),this._nums=n=n||new Float32Array(6),n[0]=t,n[1]=e,n[2]=i,n[3]=_,n[4]=r,n[5]=a,this._checkTransform()}r(t,"laya.layagl.MatrixConch");var e=t.prototype;return e.identity=function(){var t=this._nums;return t[0]=t[3]=1,t[1]=t[4]=t[5]=t[2]=0,this._bTransform=!1,this},e._checkTransform=function(){var t=this._nums;return this._bTransform=1!==t[0]||0!==t[1]||0!==t[2]||1!==t[3]},e.setTranslate=function(t,e){return this._nums[4]=t,this._nums[5]=e,this},e.translate=function(t,e){return this._nums[4]+=t,this._nums[5]+=e,this},e.scale=function(t,e){var i=this._nums;return i[0]*=t,i[3]*=e,i[2]*=t,i[1]*=e,i[4]*=t,i[5]*=e,this._bTransform=!0,this},e.rotate=function(t){var e=this._nums,i=Math.cos(t),_=Math.sin(t),r=e[0],a=e[2],n=e[4];return e[0]=r*i-e[1]*_,e[1]=r*_+e[1]*i,e[2]=a*i-e[3]*_,e[3]=a*_+e[3]*i,e[4]=n*i-e[5]*_,e[5]=n*_+e[5]*i,this._bTransform=!0,this},e.skew=function(t,e){var i=this._nums,_=Math.tan(t),r=Math.tan(e),a=i[0],n=i[1];return i[0]+=r*i[2],i[1]+=r*i[3],i[2]+=_*a,i[3]+=_*n,this},e.invertTransformPoint=function(t){var e=this._nums,i=e[0],_=e[1],r=e[2],a=e[3],n=e[4],s=i*a-_*r,o=a/s,h=-_/s,u=-r/s,l=i/s,c=(r*e[5]-a*n)/s,f=-(i*e[5]-_*n)/s;return t.setTo(o*t.x+u*t.y+c,h*t.x+l*t.y+f)},e.transformPoint=function(t){var e=this._nums;return t.setTo(e[0]*t.x+e[2]*t.y+e[4],e[1]*t.x+e[3]*t.y+e[5])},e.transformPointN=function(t){var e=this._nums;return t.setTo(e[0]*t.x+e[2]*t.y,e[1]*t.x+e[3]*t.y)},e.getScaleX=function(){var t=this._nums;return 0===t[1]?this.a:Math.sqrt(t[0]*t[0]+t[1]*t[1])},e.getScaleY=function(){var t=this._nums;return 0===t[2]?t[3]:Math.sqrt(t[2]*t[2]+t[3]*t[3])},e.invert=function(){var t=this._nums,e=t[0],i=t[1],_=t[2],r=t[3],a=t[4],n=e*r-i*_;return t[0]=r/n,t[1]=-i/n,t[2]=-_/n,t[3]=e/n,t[4]=(_*this.ty-r*a)/n,t[5]=-(e*this.ty-i*a)/n,this},e.setTo=function(t,e,i,_,r,a){var n=this._nums;return n[0]=t,n[1]=e,n[2]=i,n[3]=_,n[4]=r,n[5]=a,this},e.concat=function(t){var e=this._nums,i=t._nums,_=e[0],r=e[2],a=e[4];return e[0]=_*i[0]+e[1]*i[2],e[1]=_*i[1]+e[1]*i[3],e[2]=r*i[0]+e[3]*i[2],e[3]=r*i[1]+e[3]*i[3],e[4]=a*i[0]+e[5]*i[2]+i[4],e[5]=a*i[1]+e[5]*i[3]+i[5],this},e.scaleEx=function(t,e){var i=this._nums,_=i[0],r=i[1],a=i[2],n=i[3];0!==r||0!==a?(i[0]=t*_,i[1]=t*r,i[2]=e*a,i[3]=e*n):(i[0]=t*_,i[1]=0*n,i[2]=0*_,i[3]=e*n),this._bTransform=!0},e.rotateEx=function(t){var e=this._nums,i=Math.cos(t),_=Math.sin(t),r=e[0],a=e[1],n=e[2],s=e[3];0!==a||0!==n?(e[0]=i*r+_*n,e[1]=i*a+_*s,e[2]=-_*r+i*n,e[3]=-_*a+i*s):(e[0]=i*r,e[1]=_*s,e[2]=-_*r,e[3]=i*s),this._bTransform=!0},e.clone=function(){var e=this._nums,i=t.create(),_=i._nums;return _[0]=e[0],_[1]=e[1],_[2]=e[2],_[3]=e[3],_[4]=e[4],_[5]=e[5],i._bTransform=this._bTransform,i},e.copyTo=function(t){var e=this._nums,i=t._nums;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],t._bTransform=this._bTransform,t},e.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},e.destroy=function(){this.recover()},e.recover=function(){t._pool.push(this)},a(0,e,"a",function(){return this._nums[0]},function(t){this._nums[0]=t}),a(0,e,"b",function(){return this._nums[1]},function(t){this._nums[1]=t}),a(0,e,"c",function(){return this._nums[2]},function(t){this._nums[2]=t}),a(0,e,"d",function(){return this._nums[3]},function(t){this._nums[3]=t}),a(0,e,"tx",function(){return this._nums[4]},function(t){this._nums[4]=t}),a(0,e,"ty",function(){return this._nums[5]},function(t){this._nums[5]=t}),t.mul=function(t,e,i){var _=t._nums,r=e._nums,a=i._nums,n=_[0],s=_[1],o=_[2],h=_[3],u=_[4],l=_[5],c=r[0],f=r[1],d=r[2],E=r[3],A=r[4],D=r[5];return 0!==f||0!==d?(a[0]=n*c+s*d,a[1]=n*f+s*E,a[2]=o*c+h*d,a[3]=o*f+h*E,a[4]=c*u+d*l+A,a[5]=f*u+E*l+D):(a[0]=n*c,a[1]=s*E,a[2]=o*c,a[3]=h*E,a[4]=c*u+A,a[5]=E*l+D),i},t.mul16=function(t,e,i){var _=t._nums,r=e._nums,a=_[0],n=_[1],s=_[2],o=_[3],h=_[4],u=_[5],l=r[0],c=r[1],f=r[2],d=r[3],E=r[4],A=r[5];return 0!==c||0!==f?(i[0]=a*l+n*f,i[1]=a*c+n*d,i[4]=s*l+o*f,i[5]=s*c+o*d,i[12]=l*h+f*u+E,i[13]=c*h+d*u+A):(i[0]=a*l,i[1]=n*d,i[4]=s*l,i[5]=o*d,i[12]=l*h+E,i[13]=d*u+A),i},t.mulPre=function(t,e,i,_,r,a,n,s){var o=t._nums,h=s._nums,u=o[0],l=o[1],c=o[2],f=o[3],d=o[4],E=o[5];return 0!==i||0!==_?(h[0]=u*e+l*_,h[1]=u*i+l*r,h[2]=c*e+f*_,h[3]=c*i+f*r,h[4]=e*d+_*E+a,h[5]=i*d+r*E+n):(h[0]=u*e,h[1]=l*r,h[2]=c*e,h[3]=f*r,h[4]=e*d+a,h[5]=r*E+n),s},t.mulPos=function(t,e,i,_,r,a,n,s){var o=t._nums,h=s._nums,u=o[0],l=o[1],c=o[2],f=o[3],d=o[4],E=o[5];return 0!==l||0!==c?(h[0]=e*u+i*c,h[1]=e*l+i*f,h[2]=_*u+r*c,h[3]=_*l+r*f,h[4]=u*a+c*n+d,h[5]=l*a+f*n+E):(h[0]=e*u,h[1]=i*f,h[2]=_*u,h[3]=r*f,h[4]=u*a+d,h[5]=f*n+E),s},t.preMul=function(t,e,i){var _=t._nums,r=e._nums,a=i._nums,n=_[0],s=_[1],o=_[2],h=_[3],u=r[0],l=r[1],c=r[2],f=r[3],d=r[4],E=r[5];return a[0]=u*n,a[1]=a[2]=0,a[3]=f*h,a[4]=d*n+_[4],a[5]=E*h+_[5],0===l&&0===c&&0===s&&0===o||(a[0]+=l*o,a[3]+=c*s,a[1]+=u*s+l*h,a[2]+=c*n+f*o,a[4]+=E*o,a[5]+=d*s),i},t.preMulXY=function(t,e,i,_){var r=t._nums,a=_._nums,n=r[0],s=r[1],o=r[2],h=r[3];return a[0]=n,a[1]=s,a[2]=o,a[3]=h,a[4]=e*n+r[4]+i*o,a[5]=i*h+r[5]+e*s,_},t.create=function(e){var i;return t._pool.length?(i=t._pool.pop(),e&&(i._nums=e),i.identity(),i):new t(1,0,0,1,0,0,e)},t.A=0,t.B=1,t.C=2,t.D=3,t.TX=4,t.TY=5,t.EMPTY=new t,t.TEMP=new t,t._pool=[],t}(),rt=(function(){function t(){this._renderType=0,this._repaint=0,this._x=NaN,this._y=NaN}r(t,"laya.layagl.QuickTestTool");var e=t.prototype;e.render=function(e,i,_){V.spriteCount++,t._addType(this._renderType),t.showRenderTypeInfo(this._renderType),y.renders[this._renderType]._fun(this,e,i+this._x,_+this._y),this._repaint=0},e._stageRender=function(e,_,r){t._countStart(),t._PreStageRender.call(i.stage,e,_,r),t._countEnd()},t.getMCDName=function(e){return t._typeToNameDic[e]},t.showRenderTypeInfo=function(e,i){if(void 0===i&&(i=!1),i||!t.showedDic[e]){if(t.showedDic[e]=!0,!t._rendertypeToStrDic[e]){var _=[],r=0;for(r=1;r<=e;)r&e&&_.push(t.getMCDName(r&e)),r<<=1;t._rendertypeToStrDic[e]=_.join(",")}console.log("cmd:",t._rendertypeToStrDic[e])}},t.__init__=function(){t._typeToNameDic[1]="ALPHA",t._typeToNameDic[2]="TRANSFORM",t._typeToNameDic[256]="TEXTURE",t._typeToNameDic[512]="GRAPHICS",t._typeToNameDic[4096]="ONECHILD",t._typeToNameDic[8192]="CHILDS",t._typeToNameDic[3]="TRANSFORM|ALPHA",t._typeToNameDic[8]="CANVAS",t._typeToNameDic[4]="BLEND",t._typeToNameDic[16]="FILTERS",t._typeToNameDic[32]="MASK",t._typeToNameDic[64]="CLIP",t._typeToNameDic[1024]="LAYAGL3D"},t._countStart=function(){var e;for(e in t._countDic)t._countDic[e]=0},t._countEnd=function(){++t._i>60&&(t.showCountInfo(),t._i=0)},t._addType=function(e){t._countDic[e]?t._countDic[e]+=1:t._countDic[e]=1},t.showCountInfo=function(){console.log("===================");var e;for(e in t._countDic)console.log("count:"+t._countDic[e]),t.showRenderTypeInfo(e,!0)},t.enableQuickTest=function(){t.__init__(),F.prototype.render=t.prototype.render,t._PreStageRender=w.prototype.render,w.prototype.render=t.prototype._stageRender},t.showedDic={},t._rendertypeToStrDic={},t._typeToNameDic={},t._PreStageRender=null,t._countDic={},t._i=0}(),function(){function t(){}return r(t,"laya.webgl.canvas.BlendMode"),t._init_=function(e){t.fns=[t.BlendNormal,t.BlendAdd,t.BlendMultiply,t.BlendScreen,t.BlendOverlay,t.BlendLight,t.BlendMask,t.BlendDestinationOut],t.targetFns=[t.BlendNormalTarget,t.BlendAddTarget,t.BlendMultiplyTarget,t.BlendScreenTarget,t.BlendOverlayTarget,t.BlendLightTarget,t.BlendMask,t.BlendDestinationOut]},t.BlendNormal=function(t){Bt.setBlendFunc(t,1,771)},t.BlendAdd=function(t){Bt.setBlendFunc(t,1,772)},t.BlendMultiply=function(t){Bt.setBlendFunc(t,774,771)},t.BlendScreen=function(t){Bt.setBlendFunc(t,1,1)},t.BlendOverlay=function(t){Bt.setBlendFunc(t,1,769)},t.BlendLight=function(t){Bt.setBlendFunc(t,1,1)},t.BlendNormalTarget=function(t){Bt.setBlendFunc(t,1,771)},t.BlendAddTarget=function(t){Bt.setBlendFunc(t,1,772)},t.BlendMultiplyTarget=function(t){Bt.setBlendFunc(t,774,771)},t.BlendScreenTarget=function(t){Bt.setBlendFunc(t,1,1)},t.BlendOverlayTarget=function(t){Bt.setBlendFunc(t,1,769)},t.BlendLightTarget=function(t){Bt.setBlendFunc(t,1,1)},t.BlendMask=function(t){Bt.setBlendFunc(t,0,770)},t.BlendDestinationOut=function(t){Bt.setBlendFunc(t,0,0)},t.activeBlendFunction=null,t.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],t.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},t.NORMAL="normal",t.ADD="add",t.MULTIPLY="multiply",t.SCREEN="screen",t.LIGHT="lighter",t.OVERLAY="overlay",t.DESTINATIONOUT="destination-out",t.MASK="mask",t.fns=[],t.targetFns=[],t}()),at=function(){function t(t){this._color=null,this.setValue(t)}r(t,"laya.webgl.canvas.DrawStyle");var e=t.prototype;return e.setValue=function(t){this._color=t?t instanceof laya.utils.ColorUtils?t:l.create(t):l.create("#000000")},e.reset=function(){this._color=l.create("#000000")},e.toInt=function(){return this._color.numColor},e.equal=function(t){return"string"==typeof t?this._color.strColor===t:t instanceof laya.utils.ColorUtils&&this._color.numColor===t.numColor},e.toColorStr=function(){return this._color.strColor},t.create=function(e){if(e){var i=e instanceof laya.utils.ColorUtils?e:l.create(e);return i._drawStyle||(i._drawStyle=new t(e))}return t.DEFAULT},t.DEFAULT=new t("#000000"),t}(),nt=function(){function t(){this._lastOriX=0,this._lastOriY=0,this.paths=[],this._curPath=null}var e;r(t,"laya.webgl.canvas.Path");var i=t.prototype;return i.beginPath=function(t){this.paths.length=1,this._curPath=this.paths[0]=new e,this._curPath.convex=t},i.closePath=function(){this._curPath.loop=!0},i.newPath=function(){this._curPath=new e,this.paths.push(this._curPath)},i.addPoint=function(t,e){this._curPath.path.push(t,e)},i.push=function(t,i){this._curPath?this._curPath.path.length>0&&(this._curPath=new e,this.paths.push(this._curPath)):(this._curPath=new e,this.paths.push(this._curPath));var _=this._curPath;_.path=t.slice(),_.convex=i},i.reset=function(){this.paths.length=0},t.__init$=function(){e=function(){function t(){this.path=[],this.loop=!1,this.convex=!1}return r(t,""),t}()},t}(),st=function(){function t(){this._clipInfoID=-1,this._globalClipMatrix=new p,this._clipRect=new S}r(t,"laya.webgl.canvas.save.SaveClipRect");var e=t.prototype;return i.imps(e,{"laya.webgl.canvas.save.ISaveData":!0}),e.isSaveMark=function(){return!1},e.restore=function(e){this._globalClipMatrix.copyTo(e._globalClipMatrix),this._clipRect.clone(e._clipRect),e._clipInfoID=this._clipInfoID,t.POOL[t.POOL._length++]=this},t.save=function(e){if(131072!=(131072&e._saveMark._saveuse)){e._saveMark._saveuse|=131072;var i=t.POOL,_=i._length>0?i[--i._length]:new t;e._globalClipMatrix.copyTo(_._globalClipMatrix),e._clipRect.clone(_._clipRect),_._clipInfoID=e._clipInfoID;var r=e._save;r[r._length++]=_}},t.POOL=H._createArray(),t}(),ot=(function(){function t(){this._contextX=0,this._contextY=0,this._clipRect=new S,this._rect=new S,this._matrix=new p}r(t,"laya.webgl.canvas.save.SaveClipRectStencil");var e=t.prototype;i.imps(e,{"laya.webgl.canvas.save.ISaveData":!0}),e.isSaveMark=function(){return!1},e.restore=function(t){},t.save=function(t,e,i,_,r,a){},t.POOL=H._createArray()}(),function(){function t(){this._saveuse=0}r(t,"laya.webgl.canvas.save.SaveMark");var e=t.prototype;return i.imps(e,{"laya.webgl.canvas.save.ISaveData":!0}),e.isSaveMark=function(){return!0},e.restore=function(e){e._saveMark=this._preSaveMark,t.POOL[t.POOL._length++]=this},t.Create=function(e){var i=t.POOL,_=i._length>0?i[--i._length]:new t;return _._saveuse=0,_._preSaveMark=e._saveMark,e._saveMark=_,_},t.POOL=H._createArray(),t}()),ht=function(){function t(){this._matrix=new p}r(t,"laya.webgl.canvas.save.SaveTransform");var e=t.prototype;return i.imps(e,{"laya.webgl.canvas.save.ISaveData":!0}),e.isSaveMark=function(){return!1},e.restore=function(e){e._curMat=this._savematrix,t.POOL[t.POOL._length++]=this},t.save=function(e){var i=e._saveMark;if(2048!=(2048&i._saveuse)){i._saveuse|=2048;var _=t.POOL,r=_._length>0?_[--_._length]:new t;r._savematrix=e._curMat,e._curMat=e._curMat.copyTo(r._matrix);var a=e._save;a[a._length++]=r}},t.POOL=H._createArray(),t}(),ut=function(){function t(){this._mat=new p}r(t,"laya.webgl.canvas.save.SaveTranslate");var e=t.prototype;return i.imps(e,{"laya.webgl.canvas.save.ISaveData":!0}),e.isSaveMark=function(){return!1},e.restore=function(e){this._mat.copyTo(e._curMat),t.POOL[t.POOL._length++]=this},t.save=function(e){var i=t.POOL,_=i._length>0?i[--i._length]:new t;e._curMat.copyTo(_._mat);var r=e._save;r[r._length++]=_},t.POOL=H._createArray(),t}(),lt=function(){function t(){this.fontPages=[],this.fontPagesName=[],this._curPage=null,this.tempUV=[0,0,1,0,1,1,0,1],this.fontScaleX=1,this.fontScaleY=1,this._curStrPos=0,this.tempMat=new p,t.charbookInst=this,ft.charRender=g.isConchApp?new Wt:new Ut}var e;r(t,"laya.webgl.resource.CharBook");var a=t.prototype;return a.selectFont=function(e,i){var _,r=Math.max(this.fontScaleX,this.fontScaleY),a=i*r;if(e===t._lastFont&&a===t._lastFontSz)_=t._lastCharPage;else{var n=ft.getBmpSize(i)*r,s=e+Math.floor(n/t.gridSize),o=this.fontPagesName.indexOf(s);if(o<0){var h=new ft(e,n,g.isConchApp?0:Math.ceil(i/4));this.fontPages.push(h),this.fontPagesName.push(s),_=h}else _=this.fontPages[o];_.selectSize(i,n),t._lastFont=e,t._lastFontSz=a,t._lastCharPage=_}return _},a.isEmoji=function(e){return t._emojiReg.test(e)},a.getNextChar=function(t){var e=t.length,i=this._curStrPos;if(i>=e)return null;for(var _=i,r=0;_<e;_++){var a=t.charCodeAt(_);if(55296!=(55296&a))if(65038!==a&&65039!==a){if(8205!=a){if(1==r)break;_++;break}r=1}else r=1;else r=1}return this._curStrPos=_,t.substring(i,_)},a.hasFreedText=function(t,e){if(t&&t.length>0)for(var i=e,_=t.length;i<_;i++){var r=t[i];if(r)for(var a=0,n=r.length;a<n;a++){if(r[a].ri.tex.__destroyed)return!0}}return!1},a._fast_filltext=function(e,i,_,r,a,n,s,o,h,u,l){if(void 0===l&&(l=0),!(i&&i.length<1||_&&_.length<1)){if(t._curFont=n._font,this.fontScaleX=this.fontScaleY=1,t.scaleFontWithCtx){var c=e.getMatScaleX(),d=e.getMatScaleY();if(c<1e-4||d<.1)return;c>1&&(this.fontScaleX=c),d>1&&(this.fontScaleY=d)}n._italic&&(e._italicDeg=12),this._curPage=this.selectFont(n._family,n._size);var E=r,A=i,D=i,R=0,m=!_&&D instanceof laya.utils.WordText,T=!!_,P=t.cacheRenderInfoInWordText&&m?A.pageChars:[],v=t.cacheRenderInfoInWordText&&m?A.pageCharsStroke:[];switch(m?(D=A._text,(R=A.width)<0&&(R=A.width=this._curPage.getWidth(D))):R=this._curPage.getWidth(D),u){case f.ENUM_TEXTALIGN_CENTER:E=r-R/2;break;case f.ENUM_TEXTALIGN_RIGHT:E=r-R;break;default:E=r}A&&A.lastGCCnt!=this._curPage.gcCnt&&(A.lastGCCnt=this._curPage.gcCnt,m&&(this.hasFreedText(P,A.startID)||this.hasFreedText(v,A.startIDStroke))&&(P=A.pageChars=[],v=A.pageCharsStroke=[]));var p=m?A.startID:0,C=m?A.startIDStroke:0;if(!P||P.length<1){var M=null;t.scaleFontWithCtx&&(ft.charRender.scale(Math.max(this.fontScaleX,1),Math.max(this.fontScaleY,1)),(this.fontScaleX>1||this.fontScaleY>1)&&(M=""+(10*this.fontScaleX|0)+(10*this.fontScaleY|0))),v.length>0&&(v.length=0),p=-1,C=-1;var O=0;this._curStrPos=0;var S;if(T){var g=_[this._curStrPos++];S=g.char,O=g.x}else S=this.getNextChar(D);for(var y=n._bold;S;){var L,b=this.isEmoji(S);if((L=this._curPage.getChar(S,0,n._size,s,null,y,!1,M)).isSpace);else{var B=P[L.tex.id];if(B||(P[L.tex.id]=B=[],(p<0||p>L.tex.id)&&(p=L.tex.id)),B.push({ri:L,isEmoji:b,x:O,color:"#"+(16777215&s).toString(16),nColor:s,w:L.bmpWidth/this.fontScaleX,h:L.bmpHeight/this.fontScaleY}),o&&h>0){var I=this._curPage.getChar(S,h,n._size,o,null,y,!1,M),x=v[I.tex.id];x||(x=[],v[I.tex.id]=x,(C<0||C>I.tex.id)&&(C=I.tex.id)),x.push({ri:I,isEmoji:!1,x:O,color:"#"+(16777215&o).toString(16),nColor:o,w:I.bmpWidth/this.fontScaleX,h:I.bmpHeight/this.fontScaleY})}}T?(g=_[this._curStrPos++])?(S=g.char,O=g.x):S=null:(S=this.getNextChar(D),O+=L.width)}m&&(A.startID=p,A.startIDStroke=C)}this._drawResortedWords(e,E,v,C,a),this._drawResortedWords(e,E,P,p,a),e._italicDeg=0}},a.fillWords=function(e,i,_,r,a,n,s,o){if(i&&!(i.length<=0)){var h=l.create(n).numColor,u=s?l.create(s).numColor:0;t._curFont=a;var c=R.Parse(a);this._fast_filltext(e,null,i,_,r,c,h,u,o,0,0)}},a.filltext=function(e,i,_,r,a,n,s,o,h,u){if(void 0===u&&(u=0),!(i.length<=0)){var c=l.create(n).numColor,d=s?l.create(s).numColor:0;t._curFont=a;var E=R.Parse(a),A=0;switch(h){case"center":A=f.ENUM_TEXTALIGN_CENTER;break;case"right":A=f.ENUM_TEXTALIGN_RIGHT}this._fast_filltext(e,i,null,_,r,E,c,d,o,A,u)}},a.filltext_native=function(e,i,_,r,a,n,s,o,h,u){if(void 0===u&&(u=0),!(i.length<=0)){var c=l.create(n).numColor;if(t._curFont=a,this.fontScaleX=this.fontScaleY=1,t.scaleFontWithCtx){var f=e._curMat.getScaleX(),d=e._curMat.getScaleY();if(f<1e-4||d<.1)return;this.fontScaleX=f,this.fontScaleY=d,ft.charRender.scale(this.fontScaleX,this.fontScaleY)}var E=R.Parse(a),A=E._family,D=E._bold;E._italic&&(e._italicDeg=12),this._curPage=this.selectFont(A,E._size*this.fontScaleX);var m=_,T=i,P=i,v=0,p=P instanceof laya.utils.WordText,C=t.cacheRenderInfoInWordText&&p?T.pageChars:[];switch(p?(P=T.toString(),(v=T.width)<0&&(v=T.width=this._curPage.getWidth(P))):v=this._curPage.getWidth(P),h){case"center":m=_-v/2;break;case"right":m=_-v;break;default:m=_}if(C){for(var M=!1,O=0,S=C.length;O<S;O++){var g=C[O];if(g){for(var y=0,L=g.length;y<L;y++){if(g[y].ri.tex.__destroyed){M=!0;break}}if(M)break}}M&&(C=T.pageChars=[])}if(!C||C.length<=0){var b=null;t.scaleFontWithCtx&&(ft.charRender.scale(Math.max(this.fontScaleX,1),Math.max(this.fontScaleY,1)),(this.fontScaleX>1||this.fontScaleY>1)&&(b=""+(10*this.fontScaleX|0)+(10*this.fontScaleY|0)));var B=0;this._curStrPos=0;for(var I=this.getNextChar(P);I;){var x,N=this.isEmoji(I);if((x=s&&o?this._curPage.getChar(I,o,E._size,c,s,D,!1,b):this._curPage.getChar(I,0,E._size,c,s,D,!1,b)).isSpace);else{var F=C[x.tex.id];if(F||(C[x.tex.id]=F=[]),s&&o>0){var w=this._curPage.getChar(I,o,E._size,0,s,D,!1,b);(F=C[w.tex.id])||(F=[],C[w.tex.id]=F),F.push({ri:w,isEmoji:!1,x:B,color:s,nColor:s})}F.push({ri:x,isEmoji:N,x:B,color:n,nColor:c})}B+=x.width,I=this.getNextChar(P)}}var V=e._drawTextureUseColor;this._drawResortedWords_native(e,m,C,r),e._drawTextureUseColor=V,e._italicDeg=0}},a._drawResortedWords=function(t,e,i,_,r){var a=t.getFillColor();t.setFillColor(t.mixRGBandAlpha(16777215)),e-=this._curPage.margin_left,r-=this._curPage.margin_top;for(var n=_,s=i.length;n<s;n++){var o=i[n];if(o){var h=o.length;if(!(h<=0)){t._useNewTex2DSubmit(o[0].ri.tex.texture,4*h);for(var u=0;u<h;u++){var l=o[u],c=l.ri;c.isSpace||(c.touch(),t._drawTexRect(e+l.x,r,l.w,l.h,c.uv),t.touches&&t.touches.push(c))}}}}t.setFillColor(a),t._curSubmit._key.other=-1},a._drawResortedWords_native=function(e,i,_,r){for(var a=0,n=0,s=_.length;n<s;n++){var o=_[n];if(o)for(var h=0,u=o.length;h<u;h++){var l=o[h],c=l.ri;c.isSpace||(e._drawTextureUseColor=!t.getFontBmpWithColor&&!l.isEmoji,a!=l.nColor&&(e.fillStyle=l.color,a=l.nColor),c.touch(),this._drawCharRenderInfo(e,l.ri,i+l.x,r))}}},a._drawCharRenderInfo=function(t,e,i,_){t._drawTextureM(e.tex.texture,i-this._curPage.margin_left,_-this._curPage.margin_top,e.bmpWidth,e.bmpHeight,null,1,e.uv),t.touches&&t.touches.push(e)},a.GC=function(){var t=this.fontPages.length;if(t){var e=V.loopCount%t;this.fontPages[e].removeLRU()}},t.textureWidth=512,t.cacheRenderInfoInWordText=!0,t.scaleFontWithCtx=!0,t.getFontBmpWithColor=!0,t.gridSize=16,t.debug=!1,t._curFont=null,t.charbookInst=null,t._fontMem=0,t._lastFont=null,t._lastFontSz=0,t._lastCharPage=null,_(t,["_emojiReg",function(){return this._emojiReg=/(?:0\u20E3|1\u20E3|2\u20E3|3\u20E3|4\u20E3|5\u20E3|6\u20E3|7\u20E3|8\u20E3|9\u20E3|#\u20E3|\*\u20E3|\uD83C(?:\uDDE6\uD83C(?:\uDDE8|\uDDE9|\uDDEA|\uDDEB|\uDDEC|\uDDEE|\uDDF1|\uDDF2|\uDDF4|\uDDF6|\uDDF7|\uDDF8|\uDDF9|\uDDFA|\uDDFC|\uDDFD|\uDDFF)|\uDDE7\uD83C(?:\uDDE6|\uDDE7|\uDDE9|\uDDEA|\uDDEB|\uDDEC|\uDDED|\uDDEE|\uDDEF|\uDDF1|\uDDF2|\uDDF3|\uDDF4|\uDDF6|\uDDF7|\uDDF8|\uDDF9|\uDDFB|\uDDFC|\uDDFE|\uDDFF)|\uDDE8\uD83C(?:\uDDE6|\uDDE8|\uDDE9|\uDDEB|\uDDEC|\uDDED|\uDDEE|\uDDF0|\uDDF1|\uDDF2|\uDDF3|\uDDF4|\uDDF5|\uDDF7|\uDDFA|\uDDFB|\uDDFC|\uDDFD|\uDDFE|\uDDFF)|\uDDE9\uD83C(?:\uDDEA|\uDDEC|\uDDEF|\uDDF0|\uDDF2|\uDDF4|\uDDFF)|\uDDEA\uD83C(?:\uDDE6|\uDDE8|\uDDEA|\uDDEC|\uDDED|\uDDF7|\uDDF8|\uDDF9|\uDDFA)|\uDDEB\uD83C(?:\uDDEE|\uDDEF|\uDDF0|\uDDF2|\uDDF4|\uDDF7)|\uDDEC\uD83C(?:\uDDE6|\uDDE7|\uDDE9|\uDDEA|\uDDEB|\uDDEC|\uDDED|\uDDEE|\uDDF1|\uDDF2|\uDDF3|\uDDF5|\uDDF6|\uDDF7|\uDDF8|\uDDF9|\uDDFA|\uDDFC|\uDDFE)|\uDDED\uD83C(?:\uDDF0|\uDDF2|\uDDF3|\uDDF7|\uDDF9|\uDDFA)|\uDDEE\uD83C(?:\uDDE8|\uDDE9|\uDDEA|\uDDF1|\uDDF2|\uDDF3|\uDDF4|\uDDF6|\uDDF7|\uDDF8|\uDDF9)|\uDDEF\uD83C(?:\uDDEA|\uDDF2|\uDDF4|\uDDF5)|\uDDF0\uD83C(?:\uDDEA|\uDDEC|\uDDED|\uDDEE|\uDDF2|\uDDF3|\uDDF5|\uDDF7|\uDDFC|\uDDFE|\uDDFF)|\uDDF1\uD83C(?:\uDDE6|\uDDE7|\uDDE8|\uDDEE|\uDDF0|\uDDF7|\uDDF8|\uDDF9|\uDDFA|\uDDFB|\uDDFE)|\uDDF2\uD83C(?:\uDDE6|\uDDE8|\uDDE9|\uDDEA|\uDDEB|\uDDEC|\uDDED|\uDDF0|\uDDF1|\uDDF2|\uDDF3|\uDDF4|\uDDF5|\uDDF6|\uDDF7|\uDDF8|\uDDF9|\uDDFA|\uDDFB|\uDDFC|\uDDFD|\uDDFE|\uDDFF)|\uDDF3\uD83C(?:\uDDE6|\uDDE8|\uDDEA|\uDDEB|\uDDEC|\uDDEE|\uDDF1|\uDDF4|\uDDF5|\uDDF7|\uDDFA|\uDDFF)|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C(?:\uDDE6|\uDDEA|\uDDEB|\uDDEC|\uDDED|\uDDF0|\uDDF1|\uDDF2|\uDDF3|\uDDF7|\uDDF8|\uDDF9|\uDDFC|\uDDFE)|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C(?:\uDDEA|\uDDF4|\uDDF8|\uDDFA|\uDDFC)|\uDDF8\uD83C(?:\uDDE6|\uDDE7|\uDDE8|\uDDE9|\uDDEA|\uDDEC|\uDDED|\uDDEE|\uDDEF|\uDDF0|\uDDF1|\uDDF2|\uDDF3|\uDDF4|\uDDF7|\uDDF8|\uDDF9|\uDDFB|\uDDFD|\uDDFE|\uDDFF)|\uDDF9\uD83C(?:\uDDE6|\uDDE8|\uDDE9|\uDDEB|\uDDEC|\uDDED|\uDDEF|\uDDF0|\uDDF1|\uDDF2|\uDDF3|\uDDF4|\uDDF7|\uDDF9|\uDDFB|\uDDFC|\uDDFF)|\uDDFA\uD83C(?:\uDDE6|\uDDEC|\uDDF2|\uDDF8|\uDDFE|\uDDFF)|\uDDFB\uD83C(?:\uDDE6|\uDDE8|\uDDEA|\uDDEC|\uDDEE|\uDDF3|\uDDFA)|\uDDFC\uD83C(?:\uDDEB|\uDDF8)|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C(?:\uDDEA|\uDDF9)|\uDDFF\uD83C(?:\uDDE6|\uDDF2|\uDDFC)))|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267B\u267F\u2692-\u2694\u2696\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD79\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED0\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3]|\uD83E[\uDD10-\uDD18\uDD80-\uDD84\uDDC0]/g},"_uint32",function(){return this._uint32=new Uint32Array(1)},"trash",function(){return this.trash=new e(t.textureWidth)}]),t.__init$=function(){e=function(){function t(t){this.poolLen=0,this.cleanTm=0,this.texW=0,this.pool=new Array(10),this.texW=t}r(t,"");var e=t.prototype;return e.getAPage=function(t){if(this.poolLen>0){var e=this.pool[--this.poolLen];return e.setGridNum(t),this.poolLen>0&&this.clean(),e}return new Kt(this.texW,this.texW,t)},e.discardPage=function(t){this.clean(),t&&(this.poolLen>=this.pool.length&&(this.pool=this.pool.concat(new Array(10))),t.reset(),this.pool[this.poolLen++]=t)},e.clean=function(){var t=i.stage.getFrameTm();if(0===this.cleanTm&&(this.cleanTm=t),t-this.cleanTm>3e4){for(var e=0;e<this.poolLen;e++){var _=this.pool[e];t-_._discardTm>2e4&&(_.destroy(),this.pool[e]=this.pool[this.poolLen-1],this.poolLen--,e--)}this.cleanTm=t}},t}()},t}(),ct=function(){function t(t){this._par=null,this._loaded=!0,this.bitmap={},this.bitmap.id=t.id,this._par=t}r(t,"laya.webgl.resource.CharInternalTexture");return t.prototype._getSource=function(){return this._par._source},t}(),ft=function(){function t(t,e,i){this.pages=[],this.fontFamily=null,this._slotW=0,this._gridW=0,this._gridNum=0,this._baseSize=0,this._lastSz=0,this._spaceWidthMap=[],this._minScoreID=-1,this._selectedSizeIdx=0,this.margin_left=0,this.margin_top=0,this.margin_bottom=0,this.margin_right=0,this.gcCnt=0,this._textureWidth=lt.textureWidth,this.fontFamily=t,this.margin_top=this.margin_left=this.margin_right=this.margin_bottom=i,this._baseSize=Math.floor(e/lt.gridSize)*lt.gridSize,this._selectedSizeIdx=e-this._baseSize|0,this._slotW=Math.ceil(e/lt.gridSize)*lt.gridSize,this._gridW=Math.floor(this._textureWidth/this._slotW),this._gridW<=0&&console.error("文字太大,需要修改texture大小"),this._gridNum=this._gridW*this._gridW,console.log("gridInfo:slotW="+this._slotW+",gridw="+this._gridW+",gridNum="+this._gridNum+",textureW="+this._textureWidth)}r(t,"laya.webgl.resource.CharPages");var e=t.prototype;return e.getWidth=function(e){return t.charRender.getWidth(e)},e.selectSize=function(t,e){this._selectedSizeIdx=e-this._baseSize|0},e.getSpaceChar=function(t){if(this._spaceWidthMap[this._selectedSizeIdx])return this._spaceWidthMap[this._selectedSizeIdx];var e=new dt;return this._spaceWidthMap[this._selectedSizeIdx]=e,e.width=this.getWidth(" "),e.isSpace=!0,e},e.getChar=function(t,e,i,_,r,a,n,s){if(" "===t)return this.getSpaceChar(n);var o,h=e>0?t+"_"+e:t;_&=16777215,lt.getFontBmpWithColor&&(h+=16777215===_?"#w":16711680===_?"#b":1048320===_?"#g":255===_?"#r":"#"+_.toString(16)),a&&(h+="B"),s&&(h+=s);for(var u=0,l=this.pages.length;u<l;u++){var c=this.pages[u].charMaps[this._selectedSizeIdx];if(c&&(o=c.get(h)))return n&&o.touch(),o}o=new dt,this._getASlot(o);var f=o.tex.charMaps[this._selectedSizeIdx];!f&&(f=o.tex.charMaps[this._selectedSizeIdx]=new Map),f.set(h,o),n&&o.touch();var d="";lt.getFontBmpWithColor&&(d=((65280&_)+((255&_)<<16)+((16711680&_)>>16)).toString(16),d="#000000".substr(0,7-d.length)+d),o.height=i;var E=this.getCharBmp(t,lt._curFont,e,d,r,o);o.bmpWidth=E.width,o.bmpHeight=E.height;var A=Math.floor(o.pos/this._gridW),D=o.pos%this._gridW*this._slotW,R=A*this._slotW,m=this._textureWidth,T=D/m,P=R/m,v=(D+E.width)/m,p=(R+E.height)/m,C=o.uv;return C[0]=T,C[1]=P,C[2]=v,C[3]=P,C[4]=v,C[5]=p,C[6]=T,C[7]=p,o.tex.addChar(E,D,R),o},e._getASlot=function(t){for(var e,i=this.pages.length,_=0,r=0;r<i;r++)if(e=this.pages[r],(_=e.findAGrid())>=0)return t.tex=e,void(t.pos=_);if(e=lt.trash.getAPage(this._gridNum),this.pages.push(e),-1==(_=e.findAGrid()))throw"_getASlot error!";t.tex=e,t.pos=_},e.getAllPageScore=function(){for(var t=0,e=this.pages.length,i=V.loopCount,_=0,r=1e4;t<e;t++){var a=this.pages[t];a._scoreTick==i?_+=a._score:a._score=0,a._score<r&&(r=a._score,this._minScoreID=t)}return _},e.removeLRU=function(){var t;if(this._gridNum*this.pages.length-this.getAllPageScore()>=this._gridNum){if(this._minScoreID>=0){console.log("remove font page "+this._minScoreID);var e=(t=this.pages[this._minScoreID])._score;lt.trash.discardPage(t),this.pages[this._minScoreID]=this.pages[this.pages.length-1],this.pages.pop();for(var i=V.loopCount,_=0,r=this.pages.length;_<r&&e>0;_++){e-=(t=this.pages[_]).removeOld(i)}}return this.gcCnt++,!0}return!1},e.getCharBmp=function(e,i,_,r,a,n){return t.charRender.getCharBmp(e,i,_,r,a,n,this.margin_left,this.margin_top,this.margin_right,this.margin_bottom)},t.getBmpSize=function(t){return 1.5*t},t.charRender=null,t}(),dt=function(){function t(){this.tex=null,this.uv=[0,0,1,1],this.pos=0,this.width=0,this.height=0,this.bmpWidth=0,this.bmpHeight=0,this.touchTick=0,this.isSpace=!1}r(t,"laya.webgl.resource.CharRenderInfo");return t.prototype.touch=function(){var t=V.loopCount;this.tex._scoreTick!=t&&(this.tex._score=0,this.tex._scoreTick=t),this.touchTick!=t&&this.tex._score++,this.touchTick=t},t}(),Et=function(){function t(){}r(t,"laya.webgl.resource.ICharRender");var e=t.prototype;return e.getWidth=function(t){return 0},e.scale=function(t,e){},e.getCharBmp=function(t,e,i,_,r,a,n,s,o,h){return null},t}(),At=function(){function t(){}return r(t,"laya.webgl.resource.WebGLRTMgr"),t.getRT=function(e,i){i|=0,(e|=0)>=1e4&&console.error("getRT error! w too big");var _,r=1e4*i+e,a=t.dict[r];return a&&a.length>0?(_=a.pop(),_._mgrKey=r,_):(_=new ie(e,i,1,-1),_._mgrKey=r,_)},t.releaseRT=function(e){if(!(e._mgrKey<=0)){var i=t.dict[e._mgrKey];!i&&(i=[],t.dict[e._mgrKey]=i),e._mgrKey=0,i.push(e)}},t.dict={},t}(),Dt=function(){function t(){this.ALPHA=1,this.shaderType=0,this.defines=new Gt,this.fillStyle=at.DEFAULT,this.strokeStyle=at.DEFAULT}r(t,"laya.webgl.shader.d2.Shader2D");return t.prototype.destroy=function(){this.defines=null,this.filters=null},t.__init__=function(){var t,e;t="/*\n\ttexture和fillrect使用的。\n*/\nattribute vec4 posuv;\nattribute vec4 attribColor;\nattribute vec4 attribFlags;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;\nvarying vec2 cliped;\nuniform vec2 size;\n\n#ifdef WORLDMAT\n\tuniform mat4 mmat;\n#endif\n\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\n\nvoid main() {\n\n#ifdef WORLDMAT\n\tvec4 pos=mmat*vec4(posuv.xy,0.,1.);\n\tgl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,0.,1.0);\n#else\n\tgl_Position =vec4((posuv.x/size.x-0.5)*2.0,(0.5-posuv.y/size.y)*2.0,0.,1.0);\n#endif\n  \n\tv_texcoordAlpha.xy = posuv.zw;\n\t//v_texcoordAlpha.z = attribColor.a/255.0;\n\tv_color = attribColor/255.0;\n\tv_color.xyz*=v_color.w;//反正后面也要预乘\n\t\n\tv_useTex = attribFlags.r/255.0;\n\tfloat clipw = length(clipMatDir.xy);\n\tfloat cliph = length(clipMatDir.zw);\n\tvec2 clippos = posuv.xy - clipMatPos.xy;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\n\tif(clipw>20000. && cliph>20000.)\n\t\tcliped = vec2(0.5,0.5);\n\telse {\n\t\t//转成0到1之间。/clipw/clipw 表示clippos与normalize之后的clip朝向点积之后，再除以clipw\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n\t}\n\n}",e="/*\n\ttexture和fillrect使用的。\n*/\n\nprecision mediump float;\n//precision highp float;\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\nuniform sampler2D texture;\nvarying vec2 cliped;\n\n#ifdef BLUR_FILTER\nuniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoordAlpha.xy-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4Color += texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}\n#endif\n\n#ifdef COLOR_FILTER\nuniform vec4 colorAlpha;\nuniform mat4 colorMat;\n#endif\n\n#ifdef GLOW_FILTER\nuniform vec4 u_color;\nuniform vec4 u_blurInfo1;/*\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\n*/\nuniform vec4 u_blurInfo2;/*\nuniform float u_textW;\nuniform float u_textH;\nuniform float u_strength;\n*/\n#endif\n\n#ifdef COLOR_ADD\nuniform vec4 colorAdd;\n#endif\n\nvoid main() {\n\tif(cliped.x<0.) discard;\n\tif(cliped.x>1.) discard;\n\tif(cliped.y<0.) discard;\n\tif(cliped.y>1.) discard;\n\t\n   vec4 color= texture2D(texture, v_texcoordAlpha.xy);\n   if(v_useTex<=0.)color = vec4(1.,1.,1.,1.);\n   color.a*=v_color.w;\n   //color.rgb*=v_color.w;\n   color.rgb*=v_color.rgb;\n   gl_FragColor=color;\n   \n   #ifdef COLOR_ADD\n\tgl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\n\tgl_FragColor.xyz *= colorAdd.a;\n   #endif\n   \n   #ifdef BLUR_FILTER\n\tgl_FragColor =   blur();\n\tgl_FragColor.w*=v_color.w;   \n   #endif\n   \n   #ifdef COLOR_FILTER\n\tmat4 alphaMat =colorMat;\n\n\talphaMat[0][3] *= gl_FragColor.a;\n\talphaMat[1][3] *= gl_FragColor.a;\n\talphaMat[2][3] *= gl_FragColor.a;\n\n\tgl_FragColor = gl_FragColor * alphaMat;\n\tgl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n   #endif\n   \n   #ifdef GLOW_FILTER\n\tconst float c_IterationTime = 10.0;\n\tfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\n\tvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n\tvec2 vec2FilterDir = vec2(-(u_blurInfo1.z)/u_blurInfo2.x,-(u_blurInfo1.w)/u_blurInfo2.y);\n\tvec2 vec2FilterOff = vec2(u_blurInfo1.x/u_blurInfo2.x/c_IterationTime * 2.0,u_blurInfo1.y/u_blurInfo2.y/c_IterationTime * 2.0);\n\tfloat maxNum = u_blurInfo1.x * u_blurInfo1.y;\n\tvec2 vec2Off = vec2(0.0,0.0);\n\tfloat floatOff = c_IterationTime/2.0;\n\tfor(float i = 0.0;i<=c_IterationTime; ++i){\n\t\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\t\tvec4Color += texture2D(texture, v_texcoordAlpha.xy + vec2FilterDir + vec2Off)/floatIterationTotalTime;\n\t\t}\n\t}\n\tgl_FragColor = vec4(u_color.rgb,vec4Color.a * u_blurInfo2.z);\n\tgl_FragColor.rgb *= gl_FragColor.a;   \n   #endif\n   \n}",te.preCompile2D(0,1,t,e,null),t="attribute vec4 position;\nattribute vec4 attribColor;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;\n#ifdef WORLDMAT\n\tuniform mat4 mmat;\n#endif\nuniform mat4 u_mmat2;\n//uniform vec2 u_pos;\nuniform vec2 size;\nvarying vec4 color;\n//vec4 dirxy=vec4(0.9,0.1, -0.1,0.9);\n//vec4 clip=vec4(100.,30.,300.,600.);\nvarying vec2 cliped;\nvoid main(){\n\t\n#ifdef WORLDMAT\n\tvec4 pos=mmat*vec4(position.xy,0.,1.);\n\tgl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n#else\n\tgl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n#endif\t\n\tfloat clipw = length(clipMatDir.xy);\n\tfloat cliph = length(clipMatDir.zw);\n\tvec2 clippos = position.xy - clipMatPos.xy;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\n\tif(clipw>20000. && cliph>20000.)\n\t\tcliped = vec2(0.5,0.5);\n\telse {\n\t\t//clipdir是带缩放的方向，由于上面clippos是在缩放后的空间计算的，所以需要把方向先normalize一下\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n\t}\n  //pos2d.x = dot(clippos,dirx);\n  color=attribColor/255.;\n}",e="precision mediump float;\n//precision mediump float;\nvarying vec4 color;\n//uniform float alpha;\nvarying vec2 cliped;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor= color;// vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=color.a;\n\tif(cliped.x<0.) discard;\n\tif(cliped.x>1.) discard;\n\tif(cliped.y<0.) discard;\n\tif(cliped.y>1.) discard;\n}",te.preCompile2D(0,4,t,e,null),t="/*\n\ttexture和fillrect使用的。\n*/\nattribute vec4 posuv;\nattribute vec4 attribColor;\nattribute vec4 attribFlags;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;\nvarying vec2 cliped;\nuniform vec2 size;\n\n#ifdef WORLDMAT\n\tuniform mat4 mmat;\n#endif\n\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\n\nvoid main() {\n\n#ifdef WORLDMAT\n\tvec4 pos=mmat*vec4(posuv.xy,0.,1.);\n\tgl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,0.,1.0);\n#else\n\tgl_Position =vec4((posuv.x/size.x-0.5)*2.0,(0.5-posuv.y/size.y)*2.0,0.,1.0);\n#endif\n  \n\tv_texcoordAlpha.xy = posuv.zw;\n\t//v_texcoordAlpha.z = attribColor.a/255.0;\n\tv_color = attribColor/255.0;\n\tv_color.xyz*=v_color.w;//反正后面也要预乘\n\t\n\tv_useTex = attribFlags.r/255.0;\n\tfloat clipw = length(clipMatDir.xy);\n\tfloat cliph = length(clipMatDir.zw);\n\tvec2 clippos = posuv.xy - clipMatPos.xy;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\n\tif(clipw>20000. && cliph>20000.)\n\t\tcliped = vec2(0.5,0.5);\n\telse {\n\t\t//转成0到1之间。/clipw/clipw 表示clippos与normalize之后的clip朝向点积之后，再除以clipw\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n\t}\n\n}",e='#ifdef FSHIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n\n#import?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n\n#import?COLOR_FILTER "parts/ColorFilter.glsl" with ColorFilter_ps_uniform;\n\n#import?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n\n#import?COLOR_ADD "parts/ColorAdd.glsl" with ColorAdd_ps_uniform;\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n   color.a*=alpha;\n   gl_FragColor=color;\n   \n   #import?COLOR_ADD "parts/ColorAdd.glsl" with ColorAdd_ps_logic;\n   \n   #import?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   \n   #import?COLOR_FILTER "parts/ColorFilter.glsl" with ColorFilter_ps_logic;\n   \n   #import?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',te.preCompile2D(0,256,t,e,null),t="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",e="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",te.preCompile2D(0,512,t,e,null)},t}(),Rt=function(){function t(t,e,i){this._value=0,this._name2int=t,this._int2name=e,this._int2nameMap=i}r(t,"laya.webgl.shader.ShaderDefinesBase");var e=t.prototype;return e.add=function(t){return"string"==typeof t&&(t=this._name2int[t]),this._value|=t,this._value},e.addInt=function(t){return this._value|=t,this._value},e.remove=function(t){return"string"==typeof t&&(t=this._name2int[t]),this._value&=~t,this._value},e.isDefine=function(t){return(this._value&t)===t},e.getValue=function(){return this._value},e.setValue=function(t){this._value=t},e.toNameDic=function(){var e=this._int2nameMap[this._value];return e||t._toText(this._value,this._int2name,this._int2nameMap)},t._reg=function(t,e,i,_){i[t]=e,_[e]=t},t._toText=function(t,e,i){var _=i[t];if(_)return _;for(var r={},a=1,n=0;n<32&&!((a=1<<n)>t);n++)if(t&a){var s=e[a];s&&(r[s]="")}return i[t]=r,r},t._toInt=function(t,e){for(var i=t.split("."),_=0,r=0,a=i.length;r<a;r++){var n=e[i[r]];if(!n)throw new Error("Defines to int err:"+t+"/"+i[r]);_|=n}return _},t}(),mt=function(){function t(){this.ib=null,this.vb=null;bt.mainContext;this.ib=ae.create(35048),this.vb=ne.create(8)}r(t,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var e=t.prototype;return e.addSkinMesh=function(t){t.getData2(this.vb,this.ib,this.vb._byteLength/32)},e.reset=function(){this.vb.clear(),this.ib.clear()},t.getInstance=function(){return t.instance=t.instance||new t},t.instance=null,t}(),Tt=(function(){function t(){}r(t,"laya.webgl.shader.ShaderValue")}(),function(){function t(){}return r(t,"laya.webgl.shapes.BasePoly"),t.createLine2=function(e,i,_,r,a,n){if(e.length<4)return null;var s=t.tempData.length>e.length+2?t.tempData:new Array(e.length+2);s[0]=e[0],s[1]=e[1];var o=2,h=0,u=e.length;for(h=2;h<u;h+=2)Math.abs(e[h]-e[h-2])+Math.abs(e[h+1]-e[h-1])>.01&&(s[o++]=e[h],s[o++]=e[h+1]);n&&Math.abs(e[0]-s[o-2])+Math.abs(e[1]-s[o-1])>.01&&(s[o++]=e[0],s[o++]=e[1]);var l=a;u=o/2;var c,f,d,E,A,D,R,m,T,P,v,p,C,M,O,S,g,y,L,b,B=_/2;for(d=s[0],E=s[1],P=d-(A=s[2]),T=(T=-(E-(D=s[3])))/(b=Math.sqrt(T*T+P*P))*B,P=P/b*B,l.push(d-T,E-P,d+T,E+P),h=1;h<u-1;h++)d=s[2*(h-1)],E=s[2*(h-1)+1],A=s[2*h],D=s[2*h+1],R=s[2*(h+1)],m=s[2*(h+1)+1],P=d-A,p=A-R,O=(-(T=(T=-(E-D))/(b=Math.sqrt(T*T+P*P))*B)+d)*(-(P=P/b*B)+D)-(-T+A)*(-P+E),y=(-(v=(v=-(D-m))/(b=Math.sqrt(v*v+p*p))*B)+R)*(-(p=p/b*B)+D)-(-v+A)*(-p+m),L=(C=-P+E-(-P+D))*(g=-v+A-(-v+R))-(S=-p+m-(-p+D))*(M=-T+A-(-T+d)),Math.abs(L)<.1?(L+=10.1,l.push(A-T,D-P,A+T,D+P)):(((c=(M*y-g*O)/L)-A)*(c-A)+((f=(S*O-C*y)/L)-D)+(f-D),l.push(c,f,A-(c-A),D-(f-D)));for(d=s[o-4],E=s[o-3],P=d-(A=s[o-2]),T=(T=-(E-(D=s[o-1])))/(b=Math.sqrt(T*T+P*P))*B,P=P/b*B,l.push(A-T,D-P,A+T,D+P),h=1;h<u;h++)i.push(r+2*(h-1),r+2*(h-1)+1,r+2*h+1,r+2*h+1,r+2*h,r+2*(h-1));return l},t.createLineTriangle=function(t,e,i,_,r,a,n){var s=t.slice(),o=s.length,h=s[0],u=s[1],l=s[2],c=(s[2],0),f=0,d=0,E=0,A=o/2;if(!(A<=1)&&2!=A){for(var D=new Array(4*A),R=0,m=0,T=0;T<A-1;T++)h=s[m++],u=s[m++],l=s[m++],E=s[m++]-u,0!=(d=l-h)&&0!=E&&(c=Math.sqrt(d*d+E*E))>.001&&(D[f=4*R]=h,D[f+1]=u,D[f+2]=d/c,D[f+3]=E/c,R++);for(_?(h=s[o-2],u=s[o-1],l=s[0],E=s[1]-u,0!=(d=l-h)&&0!=E&&(c=Math.sqrt(d*d+E*E))>.001&&(D[f=4*R]=h,D[f+1]=u,D[f+2]=d/c,D[f+3]=E/c,R++)):(D[f=4*R]=h,D[f+1]=u,D[f+2]=d/c,D[f+3]=E/c,R++),m=0,T=0;T<A;T++){h=s[m],u=s[m+1],l=s[m+2],s[m+3];s[m+4],s[m+5]}}},_(t,["tempData",function(){return this.tempData=new Array(256)}]),t}()),Pt=function(){function t(){}return r(t,"laya.webgl.shapes.Earcut"),t.earcut=function(e,i,_){_=_||2;var r=i&&i.length,a=r?i[0]*_:e.length,n=t.linkedList(e,0,a,_,!0),s=[];if(!n)return s;var o,h,u,l,c,f,d;if(r&&(n=t.eliminateHoles(e,i,n,_)),e.length>80*_){o=u=e[0],h=l=e[1];for(var E=_;E<a;E+=_)c=e[E],f=e[E+1],c<o&&(o=c),f<h&&(h=f),c>u&&(u=c),f>l&&(l=f);d=0!==(d=Math.max(u-o,l-h))?1/d:0}return t.earcutLinked(n,s,_,o,h,d),s},t.linkedList=function(e,i,_,r,a){var n,s;if(a===t.signedArea(e,i,_,r)>0)for(n=i;n<_;n+=r)s=t.insertNode(n,e[n],e[n+1],s);else for(n=_-r;n>=i;n-=r)s=t.insertNode(n,e[n],e[n+1],s);return s&&t.equals(s,s.next)&&(t.removeNode(s),s=s.next),s},t.filterPoints=function(e,i){if(!e)return e;i||(i=e);var _,r=e;do{if(_=!1,r.steiner||!t.equals(r,r.next)&&0!==t.area(r.prev,r,r.next))r=r.next;else{if(t.removeNode(r),(r=i=r.prev)===r.next)break;_=!0}}while(_||r!==i);return i},t.earcutLinked=function(e,i,_,r,a,n,s){if(e){!s&&n&&t.indexCurve(e,r,a,n);for(var o,h,u=e;e.prev!==e.next;)if(o=e.prev,h=e.next,n?t.isEarHashed(e,r,a,n):t.isEar(e))i.push(o.i/_),i.push(e.i/_),i.push(h.i/_),t.removeNode(e),e=h.next,u=h.next;else if((e=h)===u){s?1===s?(e=t.cureLocalIntersections(e,i,_),t.earcutLinked(e,i,_,r,a,n,2)):2===s&&t.splitEarcut(e,i,_,r,a,n):t.earcutLinked(t.filterPoints(e,null),i,_,r,a,n,1);break}}},t.isEar=function(e){var i=e.prev,_=e,r=e.next;if(t.area(i,_,r)>=0)return!1;for(var a=e.next.next;a!==e.prev;){if(t.pointInTriangle(i.x,i.y,_.x,_.y,r.x,r.y,a.x,a.y)&&t.area(a.prev,a,a.next)>=0)return!1;a=a.next}return!0},t.isEarHashed=function(e,i,_,r){var a=e.prev,n=e,s=e.next;if(t.area(a,n,s)>=0)return!1;for(var o=a.x<n.x?a.x<s.x?a.x:s.x:n.x<s.x?n.x:s.x,h=a.y<n.y?a.y<s.y?a.y:s.y:n.y<s.y?n.y:s.y,u=a.x>n.x?a.x>s.x?a.x:s.x:n.x>s.x?n.x:s.x,l=a.y>n.y?a.y>s.y?a.y:s.y:n.y>s.y?n.y:s.y,c=t.zOrder(o,h,i,_,r),f=t.zOrder(u,l,i,_,r),d=e.nextZ;d&&d.z<=f;){if(d!==e.prev&&d!==e.next&&t.pointInTriangle(a.x,a.y,n.x,n.y,s.x,s.y,d.x,d.y)&&t.area(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(d=e.prevZ;d&&d.z>=c;){if(d!==e.prev&&d!==e.next&&t.pointInTriangle(a.x,a.y,n.x,n.y,s.x,s.y,d.x,d.y)&&t.area(d.prev,d,d.next)>=0)return!1;d=d.prevZ}return!0},t.cureLocalIntersections=function(e,i,_){var r=e;do{var a=r.prev,n=r.next.next;!t.equals(a,n)&&t.intersects(a,r,r.next,n)&&t.locallyInside(a,n)&&t.locallyInside(n,a)&&(i.push(a.i/_),i.push(r.i/_),i.push(n.i/_),t.removeNode(r),t.removeNode(r.next),r=e=n),r=r.next}while(r!==e);return r},t.splitEarcut=function(e,i,_,r,a,n){var s=e;do{for(var o=s.next.next;o!==s.prev;){if(s.i!==o.i&&t.isValidDiagonal(s,o)){var h=t.splitPolygon(s,o);return s=t.filterPoints(s,s.next),h=t.filterPoints(h,h.next),t.earcutLinked(s,i,_,r,a,n),void t.earcutLinked(h,i,_,r,a,n)}o=o.next}s=s.next}while(s!==e)},t.eliminateHoles=function(e,i,_,r){var a,n,s,o,h,u=[];for(a=0,n=i.length;a<n;a++)s=i[a]*r,o=a<n-1?i[a+1]*r:e.length,(h=t.linkedList(e,s,o,r,!1))===h.next&&(h.steiner=!0),u.push(t.getLeftmost(h));for(u.sort(t.compareX),a=0;a<u.length;a++)t.eliminateHole(u[a],_),_=t.filterPoints(_,_.next);return _},t.compareX=function(t,e){return t.x-e.x},t.eliminateHole=function(e,i){if(i=t.findHoleBridge(e,i)){var _=t.splitPolygon(i,e);t.filterPoints(_,_.next)}},t.findHoleBridge=function(e,i){var _,r=i,a=e.x,n=e.y,s=-1/0;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){var o=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(o<=a&&o>s){if(s=o,o===a){if(n===r.y)return r;if(n===r.next.y)return r.next}_=r.x<r.next.x?r:r.next}}r=r.next}while(r!==i);if(!_)return null;if(a===s)return _.prev;var h,u=_,l=_.x,c=_.y,f=1/0;for(r=_.next;r!==u;)a>=r.x&&r.x>=l&&a!==r.x&&t.pointInTriangle(n<c?a:s,n,l,c,n<c?s:a,n,r.x,r.y)&&((h=Math.abs(n-r.y)/(a-r.x))<f||h===f&&r.x>_.x)&&t.locallyInside(r,e)&&(_=r,f=h),r=r.next;return _},t.indexCurve=function(e,i,_,r){var a=e;do{null===a.z&&(a.z=t.zOrder(a.x,a.y,i,_,r)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next}while(a!==e);a.prevZ.nextZ=null,a.prevZ=null,t.sortLinked(a)},t.sortLinked=function(t){var e,i,_,r,a,n,s,o,h=1;do{for(i=t,t=null,a=null,n=0;i;){for(n++,_=i,s=0,e=0;e<h&&(s++,_=_.nextZ);e++);for(o=h;s>0||o>0&&_;)0!==s&&(0===o||!_||i.z<=_.z)?(r=i,i=i.nextZ,s--):(r=_,_=_.nextZ,o--),a?a.nextZ=r:t=r,r.prevZ=a,a=r;i=_}a.nextZ=null,h*=2}while(n>1);return t},t.zOrder=function(t,e,i,_,r){return t=32767*(t-i)*r,e=32767*(e-_)*r,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1},t.getLeftmost=function(t){var e=t,i=t;do{e.x<i.x&&(i=e),e=e.next}while(e!==t);return i},t.pointInTriangle=function(t,e,i,_,r,a,n,s){return(r-n)*(e-s)-(t-n)*(a-s)>=0&&(t-n)*(_-s)-(i-n)*(e-s)>=0&&(i-n)*(a-s)-(r-n)*(_-s)>=0},t.isValidDiagonal=function(e,i){return e.next.i!==i.i&&e.prev.i!==i.i&&!t.intersectsPolygon(e,i)&&t.locallyInside(e,i)&&t.locallyInside(i,e)&&t.middleInside(e,i)},t.area=function(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)},t.equals=function(t,e){return t.x===e.x&&t.y===e.y},t.intersects=function(e,i,_,r){return!!(t.equals(e,i)&&t.equals(_,r)||t.equals(e,r)&&t.equals(_,i))||t.area(e,i,_)>0!=t.area(e,i,r)>0&&t.area(_,r,e)>0!=t.area(_,r,i)>0},t.intersectsPolygon=function(e,i){var _=e;do{if(_.i!==e.i&&_.next.i!==e.i&&_.i!==i.i&&_.next.i!==i.i&&t.intersects(_,_.next,e,i))return!0;_=_.next}while(_!==e);return!1},t.locallyInside=function(e,i){return t.area(e.prev,e,e.next)<0?t.area(e,i,e.next)>=0&&t.area(e,e.prev,i)>=0:t.area(e,i,e.prev)<0||t.area(e,e.next,i)<0},t.middleInside=function(t,e){var i=t,_=!1,r=(t.x+e.x)/2,a=(t.y+e.y)/2;do{i.y>a!=i.next.y>a&&i.next.y!==i.y&&r<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(_=!_),i=i.next}while(i!==t);return _},t.splitPolygon=function(t,e){var i=new vt(t.i,t.x,t.y),_=new vt(e.i,e.x,e.y),r=t.next,a=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,_.next=i,i.prev=_,a.next=_,_.prev=a,_},t.insertNode=function(t,e,i,_){var r=new vt(t,e,i);return _?(r.next=_.next,r.prev=_,_.next.prev=r,_.next=r):(r.prev=r,r.next=r),r},t.removeNode=function(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)},t.signedArea=function(t,e,i,_){for(var r=0,a=e,n=i-_;a<i;a+=_)r+=(t[n]-t[a])*(t[a+1]+t[n+1]),n=a;return r},t}(),vt=function(){function t(t,e,i){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return r(t,"laya.webgl.shapes.EarcutNode"),t}(),pt=function(){function t(e){this.clipInfoID=-1,this._numEle=0,this._ref=1,this._key=new Mt,void 0===e&&(e=1e4),this._renderType=e,this._id=++t.ID}r(t,"laya.webgl.submit.Submit");var e=t.prototype;return i.imps(e,{"laya.webgl.submit.ISubmit":!0}),e.getID=function(){return this._id},e.releaseRender=function(){t.RENDERBASE!=this&&--this._ref<1&&(t.POOL[t._poolSize++]=this,this.shaderValue.release(),this.shaderValue=null,this._mesh=null,this._parent&&(this._parent.releaseRender(),this._parent=null))},e.getRenderType=function(){return this._renderType},e.renderSubmit=function(){if(0===this._numEle||!this._mesh||0==this._numEle)return 1;var t=this.shaderValue.textureHost;if(t){var e=t._getSource();if(!e)return 1;this.shaderValue.texture=e}var i=bt.mainContext;return this._mesh.useMesh(i),this.shaderValue.upload(),rt.activeBlendFunction!==this._blendFn&&(Bt.setBlend(i,!0),this._blendFn(i),rt.activeBlendFunction=this._blendFn),i.drawElements(4,this._numEle,5123,this._startIdx),V.drawCall++,V.trianglesFaces+=this._numEle/3,1},e._cloneInit=function(t,e,i,_){t._ref=1,t._mesh=i,t._id=this._id,t._key.copyFrom(this._key),t._parent=this,t._blendFn=this._blendFn,t._renderType=this._renderType,t._startIdx=_*St.BYTES_PIDX,t._numEle=this._numEle,t.shaderValue=this.shaderValue,this.shaderValue.ref++,this._ref++},e.clone=function(t,e,i){return null},e.reUse=function(t,e){return 0},e.toString=function(){return"ibindex:"+this._startIdx+" num:"+this._numEle+" key="+this._key},t.__init__=function(){var e=t.RENDERBASE=new t(-1);e.shaderValue=new Z(0,0),e.shaderValue.ALPHA=1,e._ref=4294967295},t.create=function(e,i,_){var r=t._poolSize?t.POOL[--t._poolSize]:new t;r._ref=1,r._mesh=i,r._key.clear(),r._startIdx=i.indexNum*St.BYTES_PIDX,r._numEle=0;var a=e._nBlendType;r._blendFn=e._targets?rt.targetFns[a]:rt.fns[a],r.shaderValue=_,r.shaderValue.setValue(e._shader2D);var n=e._shader2D.filters;return n&&r.shaderValue.setFilters(n),r},t.createShape=function(e,i,_,r){var a=t._poolSize?t.POOL[--t._poolSize]:new t;a._mesh=i,a._numEle=_,a._startIdx=2*i.indexNum,a._ref=1,a.shaderValue=r,a.shaderValue.setValue(e._shader2D);var n=e._nBlendType;return a._blendFn=e._targets?rt.targetFns[n]:rt.fns[n],a},t.TYPE_2D=1e4,t.TYPE_CANVAS=10003,t.TYPE_CMDSETRT=10004,t.TYPE_CUSTOM=10005,t.TYPE_BLURRT=10006,t.TYPE_CMDDESTORYPRERT=10007,t.TYPE_DISABLESTENCIL=10008,t.TYPE_OTHERIBVB=10009,t.TYPE_PRIMITIVE=10010,t.TYPE_RT=10011,t.TYPE_BLUR_RT=10012,t.TYPE_TARGET=10013,t.TYPE_CHANGE_VALUE=10014,t.TYPE_SHAPE=10015,t.TYPE_TEXTURE=10016,t.TYPE_FILLTEXTURE=10017,t.KEY_ONCE=-1,t.KEY_FILLRECT=1,t.KEY_DRAWTEXTURE=2,t.KEY_VG=3,t.KEY_TRIANGLES=4,t.RENDERBASE=null,t.ID=1,t.preRender=null,t._poolSize=0,t.POOL=[],t}(),Ct=function(){function t(){this.fun=null,this._this=null,this.args=null,this._ref=1,this._key=new Mt}r(t,"laya.webgl.submit.SubmitCMD");var e=t.prototype;return i.imps(e,{"laya.webgl.submit.ISubmit":!0}),e.renderSubmit=function(){return this.fun.apply(this._this,this.args),1},e.getRenderType=function(){return 0},e.reUse=function(t,e){return this._ref++,e},e.releaseRender=function(){if(--this._ref<1){var e=t.POOL;e[e._length++]=this}},e.clone=function(t,e,i){return null},t.create=function(e,i,_){var r=t.POOL._length?t.POOL[--t.POOL._length]:new t;return r.fun=i,r.args=e,r._this=_,r._ref=1,r._key.clear(),r},t.POOL=(t.POOL=[],t.POOL._length=0,t.POOL),t}(),Mt=function(){function t(){this.blendShader=0,this.alpha=1,this.submitType=0,this.other=0,this.clear()}r(t,"laya.webgl.submit.SubmitKey");var e=t.prototype;return e.clear=function(){this.submitType=-1,this.blendShader=this.other=0},e.copyFrom=function(t){this.other=t.other,this.blendShader=t.blendShader,this.submitType=t.submitType},e.copyFrom2=function(t,e,i){this.blendShader=t.blendShader,this.other=i,this.submitType=e},e.equal3_2=function(t,e,i){return this.submitType===e&&this.other===i&&this.blendShader===t.blendShader},e.equal4_2=function(t,e,i){return this.submitType===e&&this.other===i&&this.blendShader===t.blendShader},e.equal_3=function(t){return this.submitType===t.submitType&&this.blendShader===t.blendShader},e.equal=function(t){return this.other===t.other&&this.submitType===t.submitType&&this.blendShader===t.blendShader},t}(),Ot=function(){function t(){this._mesh=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this._ref=1,this.srcRT=null,this._key=new Mt}r(t,"laya.webgl.submit.SubmitTarget");var e=t.prototype;return i.imps(e,{"laya.webgl.submit.ISubmit":!0}),e.renderSubmit=function(){var t=bt.mainContext;this._mesh.useMesh(t);var e=this.srcRT;return e&&(this.shaderValue.texture=e._getSource(),this.shaderValue.upload(),this.blend(),V.drawCall++,V.trianglesFaces+=this._numEle/3,bt.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},e.blend=function(){if(rt.activeBlendFunction!==rt.fns[this.blendType]){var t=bt.mainContext;t.enable(3042),rt.fns[this.blendType](t),rt.activeBlendFunction=rt.fns[this.blendType]}},e.getRenderType=function(){return 0},e.releaseRender=function(){if(--this._ref<1){var e=t.POOL;e[e._length++]=this}},e.reUse=function(t,e){return this._startIdx=e,this._ref++,e},t.create=function(e,i,_,r){var a=t.POOL._length?t.POOL[--t.POOL._length]:new t;if(a._mesh=i,a.srcRT=r,a._startIdx=i.indexNum*St.BYTES_PIDX,a._ref=1,a._key.clear(),a._numEle=0,a.blendType=e._nBlendType,a._key.blendShader=a.blendType,a.shaderValue=_,a.shaderValue.setValue(e._shader2D),e._colorFiler){var n=e._colorFiler;_.defines.add(n.type),_.colorMat=n._mat,_.colorAlpha=n._alpha}return a},t.POOL=(t.POOL=[],t.POOL._length=0,t.POOL),t}(),St=(function(){function t(){}r(t,"laya.webgl.text.ArabicReshaper");var e=t.prototype;e.characterMapContains=function(e){for(var i=0;i<t.charsMap.length;++i)if(t.charsMap[i][0]===e)return!0;return!1},e.getCharRep=function(e){for(var i=0;i<t.charsMap.length;++i)if(t.charsMap[i][0]===e)return t.charsMap[i];return!1},e.getCombCharRep=function(e,i){for(var _=0;_<t.combCharsMap.length;++_)if(t.combCharsMap[_][0][0]===e&&t.combCharsMap[_][0][1]===i)return t.combCharsMap[_];return!1},e.isTransparent=function(e){for(var i=0;i<t.transChars.length;++i)if(t.transChars[i]===e)return!0;return!1},e.getOriginalCharsFromCode=function(e){var i=0;for(i=0;i<t.charsMap.length;++i)if(t.charsMap[i].indexOf(e)>-1)return String.fromCharCode(t.charsMap[i][0]);for(i=0;i<t.combCharsMap.length;++i)if(t.combCharsMap[i].indexOf(e)>-1)return String.fromCharCode(t.combCharsMap[i][0][0])+String.fromCharCode(t.combCharsMap[i][0][1]);return String.fromCharCode(e)},e.convertArabic=function(t){for(var e,i,_="",r=0;r<t.length;++r){var a=t.charCodeAt(r);if(this.characterMapContains(a)){for(var n=null,s=null,o=r-1,h=r+1;o>=0&&this.isTransparent(t.charCodeAt(o));--o);for((!(e=!!(n=o>=0?t.charCodeAt(o):null)&&this.getCharRep(n))||null==e[2]&&null==e[3])&&(n=null);h<t.length&&this.isTransparent(t.charCodeAt(h));++h);if(s=h<t.length?t.charCodeAt(h):null,(!(e=!!s&&this.getCharRep(s))||null==e[3]&&null==e[4])&&(s=null),1604===a&&null!=s&&(1570===s||1571===s||1573===s||1575===s)){i=this.getCombCharRep(a,s),_+=null!=n?String.fromCharCode(i[4]):String.fromCharCode(i[1]),++r;continue}if(e=this.getCharRep(a),null!=n&&null!=s&&null!=e[3]){_+=String.fromCharCode(e[3]);continue}if(null!=n&&null!=e[4]){_+=String.fromCharCode(e[4]);continue}if(null!=s&&null!=e[2]){_+=String.fromCharCode(e[2]);continue}_+=String.fromCharCode(e[1])}else _+=String.fromCharCode(a)}return _},e.convertArabicBack=function(t){var e="",i=0,_=0;for(_=0;_<t.length;++_)i=t.charCodeAt(_),e+=this.getOriginalCharsFromCode(i);return e},_(t,["charsMap",function(){return this.charsMap=[[1569,65152,null,null,null],[1570,65153,null,null,65154],[1571,65155,null,null,65156],[1572,65157,null,null,65158],[1573,65159,null,null,65160],[1574,65161,65163,65164,65162],[1575,65165,null,null,65166],[1576,65167,65169,65170,65168],[1577,65171,null,null,65172],[1578,65173,65175,65176,65174],[1579,65177,65179,65180,65178],[1580,65181,65183,65184,65182],[1581,65185,65187,65188,65186],[1582,65189,65191,65192,65190],[1583,65193,null,null,65194],[1584,65195,null,null,65196],[1585,65197,null,null,65198],[1586,65199,null,null,65200],[1587,65201,65203,65204,65202],[1588,65205,65207,65208,65206],[1589,65209,65211,65212,65210],[1590,65213,65215,65216,65214],[1591,65217,65219,65220,65218],[1592,65221,65223,65224,65222],[1593,65225,65227,65228,65226],[1594,65229,65231,65232,65230],[1600,1600,1600,1600,1600],[1601,65233,65235,65236,65234],[1602,65237,65239,65240,65238],[1603,65241,65243,65244,65242],[1604,65245,65247,65248,65246],[1605,65249,65251,65252,65250],[1606,65253,65255,65256,65254],[1607,65257,65259,65260,65258],[1608,65261,null,null,65262],[1609,65263,null,null,65264],[1610,65265,65267,65268,65266],[1662,64342,64344,64345,64343],[1740,64508,64510,64511,64509],[1670,64378,64380,64381,64379],[1705,64398,64400,64401,64399],[1711,64402,64404,64405,64403],[1688,64394,null,null,64395]]},"combCharsMap",function(){return this.combCharsMap=[[[1604,1570],65269,null,null,65270],[[1604,1571],65271,null,null,65272],[[1604,1573],65273,null,null,65274],[[1604,1575],65275,null,null,65276]]},"transChars",function(){return this.transChars=[1552,1554,1555,1556,1557,1611,1612,1613,1614,1615,1616,1617,1618,1619,1620,1621,1622,1623,1624,1648,1750,1751,1752,1753,1754,1755,1756,1759,1760,1761,1762,1763,1764,1767,1768,1770,1771,1772,1773]}])}(),function(){function t(){}return r(t,"laya.webgl.utils.CONST3D2D"),t.BYTES_PE=4,t.BYTES_PIDX=2,t.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],t.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],t._TMPARRAY=[],t._OFFSETX=0,t._OFFSETY=0,t}()),gt=(function(){function t(){}r(t,"laya.webgl.utils.MatirxArray"),t.ArrayMul=function(e,i,_){if(e)if(i)for(var r=NaN,a=NaN,n=NaN,s=NaN,o=0;o<4;o++)r=e[o],a=e[o+4],n=e[o+8],s=e[o+12],_[o]=r*i[0]+a*i[1]+n*i[2]+s*i[3],_[o+4]=r*i[4]+a*i[5]+n*i[6]+s*i[7],_[o+8]=r*i[8]+a*i[9]+n*i[10]+s*i[11],_[o+12]=r*i[12]+a*i[13]+n*i[14]+s*i[15];else t.copyArray(e,_);else t.copyArray(i,_)},t.copyArray=function(t,e){if(t&&e)for(var i=0;i<t.length;i++)e[i]=t[i]}}(),function(){function t(t,e,i){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=t,this._vb=new ne(t,35048),e?this._vb._resizeBuffer(e,!1):c.webGL2D_MeshAllocMaxMem&&this._vb._resizeBuffer(65536*t,!1),this._ib=new ae,i&&this._ib._resizeBuffer(i,!1)}r(t,"laya.webgl.utils.Mesh2D");var e=t.prototype;return e.cloneWithNewVB=function(){var e=new t(this._stride,0,0);return e._ib=this._ib,e._quadNum=this._quadNum,e._attribInfo=this._attribInfo,e},e.cloneWithNewVBIB=function(){var e=new t(this._stride,0,0);return e._attribInfo=this._attribInfo,e},e.getVBW=function(){return this._vb.setNeedUpload(),this._vb},e.getVBR=function(){return this._vb},e.getIBR=function(){return this._ib},e.getIBW=function(){return this._ib.setNeedUpload(),this._ib},e.createQuadIB=function(t){this._quadNum=t,this._ib._resizeBuffer(6*t*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var e=this._ib.getUint16Array(),i=0,_=0,r=0;r<t;r++)e[i++]=_,e[i++]=_+2,e[i++]=_+1,e[i++]=_,e[i++]=_+3,e[i++]=_+2,_+=4;this._ib.setNeedUpload()},e.setAttributes=function(t){if(this._attribInfo=t,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},e.configVAO=function(t){if(!this._applied){this._applied=!0,this._vao||(this._vao=t.createVertexArray()),Bt.bindVertexArray(t,this._vao),this._vb._bindForVAO(),this._ib.setNeedUpload(),this._ib._bind_uploadForVAO();for(var e=this._attribInfo.length/3,i=0,_=0;_<e;_++){var r=this._attribInfo[i+1],a=this._attribInfo[i],n=this._attribInfo[i+2];t.enableVertexAttribArray(_),t.vertexAttribPointer(_,r,a,!1,this._stride,n),i+=3}Bt.bindVertexArray(t,null)}},e.useMesh=function(t){this._applied||this.configVAO(t),Bt.bindVertexArray(t,this._vao),this._vb.bind(),this._ib._bind_upload()||this._ib.bind(),this._vb._bind_upload()||this._vb.bind()},e.getEleNum=function(){return this._ib.getBuffer().byteLength/2},e.releaseMesh=function(){},e.destroy=function(){},e.clearVB=function(){this._vb.clear()},t._gvaoid=0,t}()),yt=function(){function t(){}return r(t,"laya.webgl.utils.RenderState2D"),t.mat2MatArray=function(e,i){var _=e,r=i;return r[0]=_.a,r[1]=_.b,r[2]=t.EMPTYMAT4_ARRAY[2],r[3]=t.EMPTYMAT4_ARRAY[3],r[4]=_.c,r[5]=_.d,r[6]=t.EMPTYMAT4_ARRAY[6],r[7]=t.EMPTYMAT4_ARRAY[7],r[8]=t.EMPTYMAT4_ARRAY[8],r[9]=t.EMPTYMAT4_ARRAY[9],r[10]=t.EMPTYMAT4_ARRAY[10],r[11]=t.EMPTYMAT4_ARRAY[11],r[12]=_.tx,r[13]=_.ty,r[14]=t.EMPTYMAT4_ARRAY[14],r[15]=t.EMPTYMAT4_ARRAY[15],i},t.restoreTempArray=function(){t.TEMPMAT4_ARRAY[0]=1,t.TEMPMAT4_ARRAY[1]=0,t.TEMPMAT4_ARRAY[4]=0,t.TEMPMAT4_ARRAY[5]=1,t.TEMPMAT4_ARRAY[12]=0,t.TEMPMAT4_ARRAY[13]=0},t.clear=function(){t.worldScissorTest=!1,t.worldAlpha=1},t._MAXSIZE=99999999,t.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t.worldMatrix4=t.TEMPMAT4_ARRAY,t.worldAlpha=1,t.worldScissorTest=!1,t.worldShaderDefines=null,t.worldFilters=null,t.width=0,t.height=0,_(t,["worldMatrix",function(){return this.worldMatrix=new p}]),t}(),Lt=function(){function t(t,i,_,r){function a(t){var i=[],_=new e(i);return n._compileToTree(_,t.split("\n"),0,i,r),_}var n=this,s=h.now();this._VS=a(t),this._PS=a(i),this._nameMap=_,h.now()-s>2&&console.log("ShaderCompile use time:"+(h.now()-s)+"  size:"+t.length+"/"+i.length)}var e,i;r(t,"laya.webgl.utils.ShaderCompile");var a=t.prototype;return a._compileToTree=function(i,_,r,a,n){var s,o,h,u,l,c,f,d=0,E=0,A=0,D=0;for(E=r;E<_.length;E++)if(!((h=_[E]).length<1)&&0!==(d=h.indexOf("//"))){if(d>=0&&(h=h.substr(0,d)),s=f||new e(a),f=null,s.text=h,s.noCompile=!0,(d=h.indexOf("#"))>=0){for(u="#",D=d+1,A=h.length;D<A;D++){var R=h.charAt(D);if(" "===R||"\t"===R||"?"===R)break;u+=R}switch(s.name=u,u){case"#ifdef":case"#ifndef":if(s.src=h,s.noCompile=null!=h.match(/[!&|()=<>]/),s.noCompile?console.log("function():Boolean{return "+h.substr(d+s.name.length)+"}"):(c=h.replace(/^\s*/,"").split(/\s+/),s.setCondition(c[1],"#ifdef"===u?1:2),s.text="//"+s.text),s.setParent(i),i=s,n)for(c=h.substr(D).split(t._splitToWordExps3),D=0;D<c.length;D++)(h=c[D]).length&&(n[h]=!0);continue;case"#if":if(s.src=h,s.noCompile=!0,s.setParent(i),i=s,n)for(c=h.substr(D).split(t._splitToWordExps3),D=0;D<c.length;D++)(h=c[D]).length&&"defined"!=h&&(n[h]=!0);continue;case"#else":s.src=h,o=(i=i.parent).childs[i.childs.length-1],s.noCompile=o.noCompile,s.noCompile||(s.condition=o.condition,s.conditionType=1==o.conditionType?2:1,s.text="//"+s.text+" "+o.text+" "+s.conditionType),s.setParent(i),i=s;continue;case"#endif":o=(i=i.parent).childs[i.childs.length-1],s.noCompile=o.noCompile,s.noCompile||(s.text="//"+s.text),s.setParent(i);continue;case"#include":c=t.splitToWords(h,null);var m=t.includes[c[1]];if(!m)throw"ShaderCompile error no this include file:"+c[1];if((d=c[0].indexOf("?"))<0){s.setParent(i),h=m.getWith("with"==c[2]?c[3]:null),this._compileToTree(s,h.split("\n"),0,a,n),s.text="";continue}s.setCondition(c[0].substr(d+1),1),s.text=m.getWith("with"==c[2]?c[3]:null);break;case"#import":l=(c=t.splitToWords(h,null))[1],a.push({node:s,file:t.includes[l],ofs:s.text.length});continue}}else{if((o=i.childs[i.childs.length-1])&&!o.name){a.length>0&&t.splitToWords(h,o),f=s,o.text+="\n"+h;continue}a.length>0&&t.splitToWords(h,s)}s.setParent(i)}},a.createShader=function(t,e,i,_){var r={},a="";if(t)for(var n in t)a+="#define "+n+"\n",r[n]=!0;var s=this._VS.toscript(r,[]),o=this._PS.toscript(r,[]);return(i||te.create)(a+s.join("\n"),a+o.join("\n"),e,this._nameMap,_)},t._parseOne=function(e,i,_,r,a,n){var s={type:t.shaderParamsMap[_[r+1]],name:_[r+2],size:isNaN(parseInt(_[r+3]))?1:parseInt(_[r+3])};return n&&("attribute"==a?e.push(s):i.push(s)),":"==_[r+3]&&(s.type=_[r+4],r+=2),r+=2},t.addInclude=function(e,_){if(!_||0===_.length)throw new Error("add shader include file err:"+e);if(t.includes[e])throw new Error("add shader include file err, has add:"+e);t.includes[e]=new i(_)},t.preGetParams=function(e,i){var _=[e,i],r={},a=[],n=[],s={},o=[];r.attributes=a,r.uniforms=n,r.defines=s;for(var h=0,u=0,l=0;l<2;l++){_[l]=_[l].replace(t._removeAnnotation,"");var c,f=_[l].match(t._reg);for(h=0,u=f.length;h<u;h++){var d=f[h];if("attribute"==d||"uniform"==d)h=t._parseOne(a,n,f,h,d,!0);else{if("#define"==d){o[d=f[++h]]=1;continue}if("#ifdef"==d){s[c=f[++h]]=s[c]||[];for(h++;h<u;h++)if("attribute"==(d=f[h])||"uniform"==d)h=t._parseOne(a,n,f,h,d,o[c]);else if("#else"==d)for(h++;h<u;h++)if("attribute"==(d=f[h])||"uniform"==d)h=t._parseOne(a,n,f,h,d,!o[c]);else if("#endif"==d)break}}}}return r},t.splitToWords=function(t,e){for(var i,_,r=[],a=-1,n=0,s=t.length;n<s;n++)if(i=t.charAt(n)," \t=+-*/&%!<>()'\",;".indexOf(i)>=0){if(a>=0&&n-a>1&&(_=t.substr(a,n-a),r.push(_)),'"'==i||"'"==i){var o=t.indexOf(i,n+1);if(o<0)throw"Sharder err:"+t;r.push(t.substr(n+1,o-n-1)),n=o,a=-1;continue}"("==i&&e&&r.length>0&&(_=r[r.length-1]+";","vec4;main;".indexOf(_)<0&&(e.useFuns+=_)),a=-1}else a<0&&(a=n);return a<s&&s-a>1&&(_=t.substr(a,s-a),r.push(_)),r},t.IFDEF_NO=0,t.IFDEF_YES=1,t.IFDEF_ELSE=2,t.IFDEF_PARENT=3,t._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),t._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),t._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),t.includes={},_(t,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),t.__init$=function(){e=function(){function t(t){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=t}r(t,"");var e=t.prototype;return e.setParent=function(t){t.childs.push(this),this.z=t.z+1,this.parent=t},e.setCondition=function(t,e){t&&(this.conditionType=e,t=t.replace(/(\s*$)/g,""),this.condition=function(){return this[t]},this.condition.__condition=t)},e.toscript=function(e,i){return this._toscript(e,i,++t.__id)},e._toscript=function(t,e,i){if(this.childs.length<1&&!this.text)return e;e.length;if(this.condition){var _=!!this.condition.call(t);if(2===this.conditionType&&(_=!_),!_)return e}if(this.text&&e.push(this.text),this.childs.length>0&&this.childs.forEach(function(_,r,a){_._toscript(t,e,i)}),this.includefiles.length>0&&this.useFuns.length>0)for(var r,a=0,n=this.includefiles.length;a<n;a++)this.includefiles[a].curUseID!=i&&(r=this.includefiles[a].file.getFunsScript(this.useFuns)).length>0&&(this.includefiles[a].curUseID=i,e[0]=r+e[0]);return e},t.__id=1,t}(),i=function(){function e(e){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=e;for(var i=0,_=0,r=0;;){if((i=e.indexOf("#begin",i))<0)break;for(r=i+5;;){if((r=e.indexOf("#end",r))<0)break;if("i"!==e.charAt(r+4))break;r+=5}if(r<0)throw"add include err,no #end:"+e;_=e.indexOf("\n",i);var a=t.splitToWords(e.substr(i,_-i),null);"code"==a[1]?this.codes[a[2]]=e.substr(_+1,r-_-1):"function"==a[1]&&(_=e.indexOf("function",i),_+="function".length,this.funs[a[3]]=e.substr(_+1,r-_-1),this.funnames+=a[3]+";"),i=r+1}}r(e,"");var i=e.prototype;return i.getWith=function(t){var e=t?this.codes[t]:this.script;if(!e)throw"get with error:"+t;return e},i.getFunsScript=function(t){var e="";for(var i in this.funs)t.indexOf(i+";")>=0&&(e+=this.funs[i]);return e},e}()},t}(),bt=function(){function e(){}return r(e,"laya.webgl.WebGL"),e._uint8ArraySlice=function(){for(var t=this.length,e=new Uint8Array(this.length),i=0;i<t;i++)e[i]=this[i];return e},e._float32ArraySlice=function(){for(var t=this.length,e=new Float32Array(this.length),i=0;i<t;i++)e[i]=this[i];return e},e._uint16ArraySlice=function(t){var e,i=arguments,_=0,r=0;if(0===i.length)for(_=this.length,e=new Uint16Array(_),r=0;r<_;r++)e[r]=this[r];else if(2===i.length){var a=i[0],n=i[1];if(n>a)for(_=n-a,e=new Uint16Array(_),r=a;r<n;r++)e[r-a]=this[r];else e=new Uint16Array(0)}return e},e._nativeRender_enable=function(){v.create=function(t,e){return new _e(t,e,1,!1,!1)},Jt.prototype._getGLFormat=Jt.prototype._getGLFormatForNative,Bt.__init_native(),yt.width=h.window.innerWidth,yt.height=h.window.innerHeight,I.enableNative=function(){tt.uploadShaderUniforms=tt.uploadShaderUniformsForNative;var e=w;if(e.prototype.repaint=e.prototype.repaintForNative,t.conch){K=t.GLCommandEncoder,$=t.LayaGLContext;var i=t.CanvasRenderingContext.prototype,_=J.prototype;J=t.CanvasRenderingContext,i.drawImage=_.drawImage,i.drawTexture=_.drawTexture,i.fillText=_.fillText,i.save=_.save,i.restore=_.restore,i.translate=_.translate,i.scale=_.scale,i.rotate=_.rotate,i.transform=_.transform,i.beginRT=_.beginRT,i.endRT=_.endRT,i.drawCanvas=_.drawCanvas,i.drawTarget=_.drawTarget,i._$get_asBitmap=_._$get_asBitmap,i._$set_asBitmap=_._$set_asBitmap,a(0,i,"asBitmap",i._$get_asBitmap,i._$set_asBitmap)}Zt.init(),it.__init__()}},e._webglRender_enable=function(){g.isWebGL||(g.isWebGL=!0,I.initRender=function(t,i,_){var r=$.instance=laya.webgl.WebGL.mainContext=function(t){var e,i=["webgl2","webgl","experimental-webgl","webkit-3d","moz-webgl"];c.useWebGL2||i.shift();for(var _=0;_<i.length;_++){try{e=t.getContext(i[_],{stencil:c.isStencil,alpha:c.isAlpha,antialias:c.isAntialias,premultipliedAlpha:c.premultipliedAlpha,preserveDrawingBuffer:c.preserveDrawingBuffer})}catch(t){}if(e)return"webgl2"===i[_]&&(laya.webgl.WebGL._isWebGL2=!0),new $,e}return null}(g._mainCanvas);if(!r)return!1;t.size(i,_),Bt.__init__(r),It.__init__(),pt.__init__();var a=new It;g._context=a,t._setContext(a),laya.webgl.WebGL.shaderHighPrecision=!1;try{var n=r.getShaderPrecisionFormat(35632,36338);e.shaderHighPrecision=!!n.precision}catch(t){}return $.instance=r,W.__init__(),Gt.__init__(),Z.__init__(),Dt.__init__(),ee.__int__(r),rt._init_(r),!0},v.create=function(t,e){return new _e(t,e,1,!1,!1)},I.createRenderSprite=function(t,e){return new xt(t,e)},I.changeWebGLSize=function(t,e){laya.webgl.WebGL.onStageResize(t,e)},I.clear=function(t){yt.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var e=g.context,_=0==e._submits._length||c.preserveDrawingBuffer?l.create(t).arrColor:i.stage._wgColor;_&&e.clearBG(_[0],_[1],_[2],_[3]),yt.clear()},I.drawToCanvas=function(t,e,i,_,r,a){r-=t.x,a-=t.y,r|=0,a|=0,i|=0,_|=0;var n=new It;n.size(i,_),n.asBitmap=!0,n._targets.start(),y.renders[e]._fun(t,n,r,a),n.flush(),n._targets.end(),n._targets.restore();var s=n._targets.getData(0,0,i,_);n.destroy();for(var o=new ImageData(i,_),h=4*i,u=(new Uint8Array(h),o.data),l=_-1,c=l*h,f=0;l>=0;l--)u.set(s.subarray(f,f+h),c),c-=h,f+=h;var d=new P;d.size(i,_);return d.getContext("2d").putImageData(o,0,0),d},I.getTexturePixels=function(t,e,i,_,r){return alert("由于编不过，注掉了"),null},D._filter=function(t,e,i,_){var r=e,a=this._next;if(a){var n=t.filters,s=n.length;if(1==s&&32==n[0].type)return e.save(),e.setColorFilter(n[0]),a._fun.call(a,t,e,i,_),void e.restore();var h,u=Z.create(1,0),l=M.TEMP,c=r._curMat,f=p.create();c.copyTo(f);var d=0,E=0,A=t._cacheStyle.filterCache||null;if(A&&0==t.getRepaint()){if((t._cacheStyle.hasGlowFilter||!1)&&(d=50,E=25),(h=t.getBounds()).width<=0||h.height<=0)return;h.width+=d,h.height+=d,l.x=h.x*f.a+h.y*f.c,l.y=h.y*f.d+h.x*f.b,h.x=l.x,h.y=l.y,l.x=h.width*f.a+h.height*f.c,l.y=h.height*f.d+h.width*f.b,h.width=l.x,h.height=l.y}else{t._isHaveGlowFilter()&&(d=50,E=25),(h=new S).copyFrom(t.getSelfBounds()),h.x+=t.x,h.y+=t.y,h.x-=t.pivotX+4,h.y-=t.pivotY+4;var D=h.x,R=h.y;if(h.width+=d+8,h.height+=d+8,l.x=h.x*f.a+h.y*f.c,l.y=h.y*f.d+h.x*f.b,h.x=l.x,h.y=l.y,l.x=h.width*f.a+h.height*f.c,l.y=h.height*f.d+h.width*f.b,h.width=l.x,h.height=l.y,h.width<=0||h.height<=0)return;A&&At.releaseRT(A);var T=At.getRT(h.width,h.height),P=At.getRT(h.width,h.height);t._getCacheStyle().filterCache=A,r.pushRT(),r.useRT(T);var v=t.x-D+E,C=t.y-R+E;a._fun.call(a,t,e,v,C),r.useRT(P);for(var O=0;O<s;O++){0!=O&&(r.useRT(T),r.drawTarget(P,0,0,h.width,h.height,p.TEMP.identity(),u,null,rt.TOINT.overlay),r.useRT(P));var g=n[O];switch(g.type){case 16:o.render(T,e,h.width,h.height,g);break;case 8:m.render(T,e,h.width,h.height,g);break;case 32:r.setColorFilter(g),r.drawTarget(T,0,0,h.width,h.height,p.EMPTY.identity(),Z.create(1,0)),r.setColorFilter(null)}}r.popRT()}i=i-E-t.x,_=_-E-t.y,l.setTo(i,_),f.transformPoint(l),i=l.x+h.x,_=l.y+h.y,r._drawRenderTexture(P,i,_,h.width,h.height,p.TEMP.identity(),1,ie.defuv),f.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=e._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=e._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=e._uint8ArraySlice))},e.enable=function(){return g.isConchApp?e._nativeRender_enable():e._webglRender_enable(),!0},e.onStageResize=function(t,i){null!=e.mainContext&&(e.mainContext.viewport(0,0,t,i),yt.width=t,yt.height=i)},e.mainContext=null,e.shaderHighPrecision=!1,e._isWebGL2=!1,e}(),Bt=function(){function t(){}r(t,"laya.webgl.WebGLContext");var e=t.prototype;return e.getContextAttributes=function(){return null},e.isContextLost=function(){},e.getSupportedExtensions=function(){return null},e.getExtension=function(t){return null},e.activeTexture=function(t){},e.attachShader=function(t,e){},e.bindAttribLocation=function(t,e,i){},e.bindBuffer=function(t,e){},e.bindFramebuffer=function(t,e){},e.bindRenderbuffer=function(t,e){},e.bindTexture=function(t,e){},e.useTexture=function(t){},e.blendColor=function(t,e,i,_){},e.blendEquation=function(t){},e.blendEquationSeparate=function(t,e){},e.blendFunc=function(t,e){},e.blendFuncSeparate=function(t,e,i,_){},e.bufferData=function(t,e,i){},e.bufferSubData=function(t,e,i){},e.checkFramebufferStatus=function(t){return null},e.clear=function(t){},e.clearColor=function(t,e,i,_){},e.clearDepth=function(t){},e.clearStencil=function(t){},e.colorMask=function(t,e,i,_){},e.compileShader=function(t){},e.copyTexImage2D=function(t,e,i,_,r,a,n,s){},e.copyTexSubImage2D=function(t,e,i,_,r,a,n,s){},e.createBuffer=function(){},e.createFramebuffer=function(){},e.createProgram=function(){},e.createRenderbuffer=function(){},e.createShader=function(t){},e.createTexture=function(){return null},e.cullFace=function(t){},e.deleteBuffer=function(t){},e.deleteFramebuffer=function(t){},e.deleteProgram=function(t){},e.deleteRenderbuffer=function(t){},e.deleteShader=function(t){},e.deleteTexture=function(t){},e.depthFunc=function(t){},e.depthMask=function(t){},e.depthRange=function(t,e){},e.detachShader=function(t,e){},e.disable=function(t){},e.disableVertexAttribArray=function(t){},e.drawArrays=function(t,e,i){},e.drawElements=function(t,e,i,_){},e.enable=function(t){},e.enableVertexAttribArray=function(t){},e.finish=function(){},e.flush=function(){},e.framebufferRenderbuffer=function(t,e,i,_){},e.framebufferTexture2D=function(t,e,i,_,r){},e.frontFace=function(t){return null},e.generateMipmap=function(t){return null},e.getActiveAttrib=function(t,e){return null},e.getActiveUniform=function(t,e){return null},e.getAttribLocation=function(t,e){return 0},e.getParameter=function(t){return null},e.getBufferParameter=function(t,e){return null},e.getError=function(){return null},e.getFramebufferAttachmentParameter=function(t,e,i){},e.getProgramParameter=function(t,e){return 0},e.getProgramInfoLog=function(t){return null},e.getRenderbufferParameter=function(t,e){return null},e.getShaderPrecisionFormat=function(t){return null},e.getShaderParameter=function(t,e){},e.getShaderInfoLog=function(t){return null},e.getShaderSource=function(t){return null},e.getTexParameter=function(t,e){},e.getUniform=function(t,e){},e.getUniformLocation=function(t,e){return null},e.getVertexAttrib=function(t,e){return null},e.getVertexAttribOffset=function(t,e){return null},e.hint=function(t,e){},e.isBuffer=function(t){},e.isEnabled=function(t){},e.isFramebuffer=function(t){},e.isProgram=function(t){},e.isRenderbuffer=function(t){},e.isShader=function(t){},e.isTexture=function(t){},e.lineWidth=function(t){},e.linkProgram=function(t){},e.pixelStorei=function(t,e){},e.polygonOffset=function(t,e){},e.readPixels=function(t,e,i,_,r,a,n){},e.renderbufferStorage=function(t,e,i,_){},e.sampleCoverage=function(t,e){},e.scissor=function(t,e,i,_){},e.shaderSource=function(t,e){},e.stencilFunc=function(t,e,i){},e.stencilFuncSeparate=function(t,e,i,_){},e.stencilMask=function(t){},e.stencilMaskSeparate=function(t,e){},e.stencilOp=function(t,e,i){},e.stencilOpSeparate=function(t,e,i,_){},e.texImage2D=function(t){},e.texParameterf=function(t,e,i){},e.texParameteri=function(t,e,i){},e.texSubImage2D=function(t){},e.uniform1f=function(t,e){},e.uniform1fv=function(t,e){},e.uniform1i=function(t,e){},e.uniform1iv=function(t,e){},e.uniform2f=function(t,e,i){},e.uniform2fv=function(t,e){},e.uniform2i=function(t,e,i){},e.uniform2iv=function(t,e){},e.uniform3f=function(t,e,i,_){},e.uniform3fv=function(t,e){},e.uniform3i=function(t,e,i,_){},e.uniform3iv=function(t,e){},e.uniform4f=function(t,e,i,_,r){},e.uniform4fv=function(t,e){},e.uniform4i=function(t,e,i,_,r){},e.uniform4iv=function(t,e){},e.uniformMatrix2fv=function(t,e,i){},e.uniformMatrix3fv=function(t,e,i){},e.uniformMatrix4fv=function(t,e,i){},e.useProgram=function(t){},e.validateProgram=function(t){},e.vertexAttrib1f=function(t,e){},e.vertexAttrib1fv=function(t,e){},e.vertexAttrib2f=function(t,e,i){},e.vertexAttrib2fv=function(t,e){},e.vertexAttrib3f=function(t,e,i,_){},e.vertexAttrib3fv=function(t,e){},e.vertexAttrib4f=function(t,e,i,_,r){},e.vertexAttrib4fv=function(t,e){},e.vertexAttribPointer=function(t,e,i,_,r,a){},e.viewport=function(t,e,i,_){},e.configureBackBuffer=function(t,e,i,_,r){void 0===_&&(_=!0),void 0===r&&(r=!1)},e.compressedTexImage2D=function(t){},e.createVertexArray=function(){throw"not implemented"},e.bindVertexArray=function(t){throw"not implemented"},e.deleteVertexArray=function(t){throw"not implemented"},e.isVertexArray=function(t){throw"not implemented"},t.__init__=function(e){if(t.__init_native(),t._extTextureFilterAnisotropic=t._getExtension(e,"EXT_texture_filter_anisotropic"),t._compressedTextureS3tc=t._getExtension(e,"WEBGL_compressed_texture_s3tc"),t._compressedTexturePvrtc=t._getExtension(e,"WEBGL_compressed_texture_pvrtc"),t._compressedTextureEtc1=t._getExtension(e,"WEBGL_compressed_texture_etc1"),!bt._isWebGL2){var i=(e.rawgl||e).getExtension("OES_vertex_array_object");if(i){console.log("EXT:webgl support OES_vertex_array_object！");var _=e;_.createVertexArray=function(){return i.createVertexArrayOES()},_.bindVertexArray=function(t){i.bindVertexArrayOES(t)},_.deleteVertexArray=function(t){i.deleteVertexArrayOES(t)},_.isVertexArray=function(t){i.isVertexArrayOES(t)}}}},t._getExtension=function(e,i){var _=t._extentionVendorPrefixes;for(var r in _){var a=e.getExtension(_[r]+i);if(a)return a}return null},t.__init_native=function(){if(g.isConchApp){var e=t;e.useProgram=e.useProgramForNative,e.activeTexture=e.activeTextureForNative,e.bindTexture=e.bindTextureForNative,e.bindVertexArray=e.bindVertexArrayForNative,e.setDepthTest=e.setDepthTestForNative,e.setDepthMask=e.setDepthMaskForNative,e.setDepthFunc=e.setDepthFuncForNative,e.setBlend=e.setBlendForNative,e.setBlendFunc=e.setBlendFuncForNative,e.setCullFace=e.setCullFaceForNative,e.setFrontFace=e.setFrontFaceForNative}},t.useProgram=function(e,i){return t._useProgram!==i&&(e.useProgram(i),t._useProgram=i,!0)},t.setDepthTest=function(e,i){i!==t._depthTest&&(t._depthTest=i,i?e.enable(2929):e.disable(2929))},t.setDepthMask=function(e,i){i!==t._depthMask&&(t._depthMask=i,e.depthMask(i))},t.setDepthFunc=function(e,i){i!==t._depthFunc&&(t._depthFunc=i,e.depthFunc(i))},t.setBlend=function(e,i){i!==t._blend&&(t._blend=i,i?e.enable(3042):e.disable(3042))},t.setBlendFunc=function(e,i,_){(i!==t._sFactor||_!==t._dFactor)&&(t._sFactor=i,t._dFactor=_,e.blendFunc(i,_))},t.setCullFace=function(e,i){i!==t._cullFace&&(t._cullFace=i,i?e.enable(2884):e.disable(2884))},t.setFrontFace=function(e,i){i!==t._frontFace&&(t._frontFace=i,e.frontFace(i))},t.activeTexture=function(e,i){t._activedTextureID!==i&&(e.activeTexture(i),t._activedTextureID=i)},t.bindTexture=function(e,i,_){t._activeTextures[t._activedTextureID-33984]!==_&&(e.bindTexture(i,_),t._activeTextures[t._activedTextureID-33984]=_)},t.bindVertexArray=function(e,i){t._bindedVAO!==i&&(e.bindVertexArray(i),t._bindedVAO=i)},t.useProgramForNative=function(t,e){return t.useProgram(e),!0},t.setDepthTestForNative=function(t,e){e?t.enable(2929):t.disable(2929)},t.setDepthMaskForNative=function(t,e){t.depthMask(e)},t.setDepthFuncForNative=function(t,e){t.depthFunc(e)},t.setBlendForNative=function(t,e){e?t.enable(3042):t.disable(3042)},t.setBlendFuncForNative=function(t,e,i){t.blendFunc(e,i)},t.setCullFaceForNative=function(t,e){e?t.enable(2884):t.disable(2884)},t.setFrontFaceForNative=function(t,e){t.frontFace(e)},t.activeTextureForNative=function(t,e){t.activeTexture(e)},t.bindTextureForNative=function(t,e,i){t.bindTexture(e,i)},t.bindVertexArrayForNative=function(t,e){t.bindVertexArray(e)},t.DEPTH_BUFFER_BIT=256,t.STENCIL_BUFFER_BIT=1024,t.COLOR_BUFFER_BIT=16384,t.POINTS=0,t.LINES=1,t.LINE_LOOP=2,t.LINE_STRIP=3,t.TRIANGLES=4,t.TRIANGLE_STRIP=5,t.TRIANGLE_FAN=6,t.ZERO=0,t.ONE=1,t.SRC_COLOR=768,t.ONE_MINUS_SRC_COLOR=769,t.SRC_ALPHA=770,t.ONE_MINUS_SRC_ALPHA=771,t.DST_ALPHA=772,t.ONE_MINUS_DST_ALPHA=773,t.DST_COLOR=774,t.ONE_MINUS_DST_COLOR=775,t.SRC_ALPHA_SATURATE=776,t.FUNC_ADD=32774,t.BLEND_EQUATION=32777,t.BLEND_EQUATION_RGB=32777,t.BLEND_EQUATION_ALPHA=34877,t.FUNC_SUBTRACT=32778,t.FUNC_REVERSE_SUBTRACT=32779,t.BLEND_DST_RGB=32968,t.BLEND_SRC_RGB=32969,t.BLEND_DST_ALPHA=32970,t.BLEND_SRC_ALPHA=32971,t.CONSTANT_COLOR=32769,t.ONE_MINUS_CONSTANT_COLOR=32770,t.CONSTANT_ALPHA=32771,t.ONE_MINUS_CONSTANT_ALPHA=32772,t.BLEND_COLOR=32773,t.ARRAY_BUFFER=34962,t.ELEMENT_ARRAY_BUFFER=34963,t.ARRAY_BUFFER_BINDING=34964,t.ELEMENT_ARRAY_BUFFER_BINDING=34965,t.STREAM_DRAW=35040,t.STATIC_DRAW=35044,t.DYNAMIC_DRAW=35048,t.BUFFER_SIZE=34660,t.BUFFER_USAGE=34661,t.CURRENT_VERTEX_ATTRIB=34342,t.FRONT=1028,t.BACK=1029,t.CULL_FACE=2884,t.FRONT_AND_BACK=1032,t.BLEND=3042,t.DITHER=3024,t.STENCIL_TEST=2960,t.DEPTH_TEST=2929,t.SCISSOR_TEST=3089,t.POLYGON_OFFSET_FILL=32823,t.SAMPLE_ALPHA_TO_COVERAGE=32926,t.SAMPLE_COVERAGE=32928,t.NO_ERROR=0,t.INVALID_ENUM=1280,t.INVALID_VALUE=1281,t.INVALID_OPERATION=1282,t.OUT_OF_MEMORY=1285,t.CW=2304,t.CCW=2305,t.LINE_WIDTH=2849,t.ALIASED_POINT_SIZE_RANGE=33901,t.ALIASED_LINE_WIDTH_RANGE=33902,t.CULL_FACE_MODE=2885,t.FRONT_FACE=2886,t.DEPTH_RANGE=2928,t.DEPTH_WRITEMASK=2930,t.DEPTH_CLEAR_VALUE=2931,t.DEPTH_FUNC=2932,t.STENCIL_CLEAR_VALUE=2961,t.STENCIL_FUNC=2962,t.STENCIL_FAIL=2964,t.STENCIL_PASS_DEPTH_FAIL=2965,t.STENCIL_PASS_DEPTH_PASS=2966,t.STENCIL_REF=2967,t.STENCIL_VALUE_MASK=2963,t.STENCIL_WRITEMASK=2968,t.STENCIL_BACK_FUNC=34816,t.STENCIL_BACK_FAIL=34817,t.STENCIL_BACK_PASS_DEPTH_FAIL=34818,t.STENCIL_BACK_PASS_DEPTH_PASS=34819,t.STENCIL_BACK_REF=36003,t.STENCIL_BACK_VALUE_MASK=36004,t.STENCIL_BACK_WRITEMASK=36005,t.VIEWPORT=2978,t.SCISSOR_BOX=3088,t.COLOR_CLEAR_VALUE=3106,t.COLOR_WRITEMASK=3107,t.UNPACK_ALIGNMENT=3317,t.PACK_ALIGNMENT=3333,t.MAX_TEXTURE_SIZE=3379,t.MAX_VIEWPORT_DIMS=3386,t.SUBPIXEL_BITS=3408,t.RED_BITS=3410,t.GREEN_BITS=3411,t.BLUE_BITS=3412,t.ALPHA_BITS=3413,t.DEPTH_BITS=3414,t.STENCIL_BITS=3415,t.POLYGON_OFFSET_UNITS=10752,t.POLYGON_OFFSET_FACTOR=32824,t.TEXTURE_BINDING_2D=32873,t.SAMPLE_BUFFERS=32936,t.SAMPLES=32937,t.SAMPLE_COVERAGE_VALUE=32938,t.SAMPLE_COVERAGE_INVERT=32939,t.NUM_COMPRESSED_TEXTURE_FORMATS=34466,t.COMPRESSED_TEXTURE_FORMATS=34467,t.DONT_CARE=4352,t.FASTEST=4353,t.NICEST=4354,t.GENERATE_MIPMAP_HINT=33170,t.BYTE=5120,t.UNSIGNED_BYTE=5121,t.SHORT=5122,t.UNSIGNED_SHORT=5123,t.INT=5124,t.UNSIGNED_INT=5125,t.FLOAT=5126,t.DEPTH_COMPONENT=6402,t.ALPHA=6406,t.RGB=6407,t.RGBA=6408,t.LUMINANCE=6409,t.LUMINANCE_ALPHA=6410,t.UNSIGNED_SHORT_4_4_4_4=32819,t.UNSIGNED_SHORT_5_5_5_1=32820,t.UNSIGNED_SHORT_5_6_5=33635,t.FRAGMENT_SHADER=35632,t.VERTEX_SHADER=35633,t.MAX_VERTEX_ATTRIBS=34921,t.MAX_VERTEX_UNIFORM_VECTORS=36347,t.MAX_VARYING_VECTORS=36348,t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,t.MAX_TEXTURE_IMAGE_UNITS=34930,t.MAX_FRAGMENT_UNIFORM_VECTORS=36349,t.SHADER_TYPE=35663,t.DELETE_STATUS=35712,t.LINK_STATUS=35714,t.VALIDATE_STATUS=35715,t.ATTACHED_SHADERS=35717,t.ACTIVE_UNIFORMS=35718,t.ACTIVE_ATTRIBUTES=35721,t.SHADING_LANGUAGE_VERSION=35724,t.CURRENT_PROGRAM=35725,t.NEVER=512,t.LESS=513,t.EQUAL=514,t.LEQUAL=515,t.GREATER=516,t.NOTEQUAL=517,t.GEQUAL=518,t.ALWAYS=519,t.KEEP=7680,t.REPLACE=7681,t.INCR=7682,t.DECR=7683,t.INVERT=5386,t.INCR_WRAP=34055,t.DECR_WRAP=34056,t.VENDOR=7936,t.RENDERER=7937,t.VERSION=7938,t.NEAREST=9728,t.LINEAR=9729,t.NEAREST_MIPMAP_NEAREST=9984,t.LINEAR_MIPMAP_NEAREST=9985,t.NEAREST_MIPMAP_LINEAR=9986,t.LINEAR_MIPMAP_LINEAR=9987,t.TEXTURE_MAG_FILTER=10240,t.TEXTURE_MIN_FILTER=10241,t.TEXTURE_WRAP_S=10242,t.TEXTURE_WRAP_T=10243,t.TEXTURE_2D=3553,t.TEXTURE_3D=32879,t.TEXTURE=5890,t.TEXTURE_CUBE_MAP=34067,t.TEXTURE_BINDING_CUBE_MAP=34068,t.TEXTURE_CUBE_MAP_POSITIVE_X=34069,t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,t.MAX_CUBE_MAP_TEXTURE_SIZE=34076,t.TEXTURE0=33984,t.TEXTURE1=33985,t.TEXTURE2=33986,t.TEXTURE3=33987,t.TEXTURE4=33988,t.TEXTURE5=33989,t.TEXTURE6=33990,t.TEXTURE7=33991,t.TEXTURE8=33992,t.TEXTURE9=33993,t.TEXTURE10=33994,t.TEXTURE11=33995,t.TEXTURE12=33996,t.TEXTURE13=33997,t.TEXTURE14=33998,t.TEXTURE15=33999,t.TEXTURE16=34e3,t.TEXTURE17=34001,t.TEXTURE18=34002,t.TEXTURE19=34003,t.TEXTURE20=34004,t.TEXTURE21=34005,t.TEXTURE22=34006,t.TEXTURE23=34007,t.TEXTURE24=34008,t.TEXTURE25=34009,t.TEXTURE26=34010,t.TEXTURE27=34011,t.TEXTURE28=34012,t.TEXTURE29=34013,t.TEXTURE30=34014,t.TEXTURE31=34015,t.ACTIVE_TEXTURE=34016,t.REPEAT=10497,t.CLAMP_TO_EDGE=33071,t.MIRRORED_REPEAT=33648,t.FLOAT_VEC2=35664,t.FLOAT_VEC3=35665,t.FLOAT_VEC4=35666,t.INT_VEC2=35667,t.INT_VEC3=35668,t.INT_VEC4=35669,t.BOOL=35670,t.BOOL_VEC2=35671,t.BOOL_VEC3=35672,t.BOOL_VEC4=35673,t.FLOAT_MAT2=35674,t.FLOAT_MAT3=35675,t.FLOAT_MAT4=35676,t.SAMPLER_2D=35678,t.SAMPLER_CUBE=35680,t.VERTEX_ATTRIB_ARRAY_ENABLED=34338,t.VERTEX_ATTRIB_ARRAY_SIZE=34339,t.VERTEX_ATTRIB_ARRAY_STRIDE=34340,t.VERTEX_ATTRIB_ARRAY_TYPE=34341,t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,t.VERTEX_ATTRIB_ARRAY_POINTER=34373,t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,t.COMPILE_STATUS=35713,t.LOW_FLOAT=36336,t.MEDIUM_FLOAT=36337,t.HIGH_FLOAT=36338,t.LOW_INT=36339,t.MEDIUM_INT=36340,t.HIGH_INT=36341,t.FRAMEBUFFER=36160,t.RENDERBUFFER=36161,t.RGBA4=32854,t.RGB5_A1=32855,t.RGB565=36194,t.DEPTH_COMPONENT16=33189,t.STENCIL_INDEX=6401,t.STENCIL_INDEX8=36168,t.DEPTH_STENCIL=34041,t.RENDERBUFFER_WIDTH=36162,t.RENDERBUFFER_HEIGHT=36163,t.RENDERBUFFER_INTERNAL_FORMAT=36164,t.RENDERBUFFER_RED_SIZE=36176,t.RENDERBUFFER_GREEN_SIZE=36177,t.RENDERBUFFER_BLUE_SIZE=36178,t.RENDERBUFFER_ALPHA_SIZE=36179,t.RENDERBUFFER_DEPTH_SIZE=36180,t.RENDERBUFFER_STENCIL_SIZE=36181,t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,t.COLOR_ATTACHMENT0=36064,t.DEPTH_ATTACHMENT=36096,t.STENCIL_ATTACHMENT=36128,t.DEPTH_STENCIL_ATTACHMENT=33306,t.NONE=0,t.FRAMEBUFFER_COMPLETE=36053,t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,t.FRAMEBUFFER_UNSUPPORTED=36061,t.FRAMEBUFFER_BINDING=36006,t.RENDERBUFFER_BINDING=36007,t.MAX_RENDERBUFFER_SIZE=34024,t.INVALID_FRAMEBUFFER_OPERATION=1286,t.UNPACK_FLIP_Y_WEBGL=37440,t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,t.CONTEXT_LOST_WEBGL=37442,t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,t.BROWSER_DEFAULT_WEBGL=37444,t._extTextureFilterAnisotropic=null,t._compressedTextureS3tc=null,t._compressedTexturePvrtc=null,t._compressedTextureEtc1=null,t._glTextureIDs=[33984,33985,33986,33987,33988,33989,33990,33991],t._useProgram=null,t._depthTest=!0,t._depthMask=!0,t._blend=!1,t._cullFace=!1,t._activedTextureID=33984,t._bindedVAO=null,_(t,["_extentionVendorPrefixes",function(){return this._extentionVendorPrefixes=["","WEBKIT_","MOZ_"]},"_activeTextures",function(){return this._activeTextures=new Array(8)},"_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),t}(),It=function(t){function e(){if(this._id=++e._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._renderCount=0,this._isConvexCmd=!0,this._submits=null,this._curSubmit=null,this.meshlist=[],this._clipInfoID=0,this._lastMatScaleX=1,this._lastMatScaleY=1,this._lastMat_a=1,this._lastMat_b=0,this._lastMat_c=0,this._lastMat_d=1,this._nBlendType=0,this._saveMark=null,this._drawTextureUseColor=!1,this._italicDeg=0,this._lastTex=null,this._fillColor=0,this._flushCnt=0,this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,e.__super.call(this),this._width=99999999,this._height=99999999,this._submitKey=new Mt,this._transedPoints=new Array(8),this._temp4Points=new Array(8),this._clipRect=e.MAXCLIPRECT,this._globalClipMatrix=new p(99999999,0,0,99999999,0,0),this._shader2D=new Dt,this.mOutPoint,e._contextcount++,!e.defTexture){var t=new _e(2,2);t.setPixels(new Uint8Array(16)),e.defTexture=new X(t)}this._lastTex=e.defTexture,this.clear()}var s;r(e,"laya.webgl.canvas.WebGLContext2D",f);var o=e.prototype;return o.clearBG=function(t,e,i,_){var r=bt.mainContext;r.clearColor(t,e,i,_),r.clear(16384)},o._getSubmits=function(){return this._submits},o._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var t=0,e=this._submits._length;t<e;t++)this._submits[t].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path=null,this._save=null;var i=0;for(t=0,i=this.meshlist.length;t<i;t++){this.meshlist[t].destroy()}this.meshlist.length=0,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}},o.destroy=function(){--e._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._mesh.destroy()},o.clear=function(){this._submits||(this._other=s.DEFAULT,this._curMat=p.create(),this._mesh=zt.getAMesh(),this.meshlist.push(this._mesh),this._pathMesh=Ht.getAMesh(),this.meshlist.push(this._pathMesh),this._triangleMesh=Yt.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits=[],this._save=[ot.Create(this)],this._save.length=10,this._shader2D=new Dt),this._submitKey.clear(),this._mesh.clearVB(),c.smartCache&&this._renderCount++,this._drawCount=1,this._other=s.DEFAULT,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=e.MAXCLIPRECT,this._curSubmit=pt.RENDERBASE,pt.RENDERBASE._ref=16777215,pt.RENDERBASE._numEle=0,this._shader2D.fillStyle=this._shader2D.strokeStyle=at.DEFAULT;for(var t=0,i=this._submits._length;t<i;t++)this._submits[t].releaseRender();this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},o.size=function(t,e){this._width==t&&this._height==e||(this._width=t,this._height=e,this._targets&&(this._targets.destroy(),this._targets=new ie(t,e,1,-1)),g._context==this&&(bt.mainContext.viewport(0,0,t,e),yt.width=t,yt.height=e)),0===t&&0===e&&this._releaseMem()},o.getMatScaleX=function(){return this._lastMat_a==this._curMat.a&&this._lastMat_b==this._curMat.b?this._lastMatScaleX:(this._lastMatScaleX=this._curMat.getScaleX(),this._lastMat_a=this._curMat.a,this._lastMat_b=this._curMat.b,this._lastMatScaleX)},o.getMatScaleY=function(){return this._lastMat_c==this._curMat.c&&this._lastMat_d==this._curMat.d?this._lastMatScaleY:(this._lastMatScaleY=this._curMat.getScaleY(),this._lastMat_c=this._curMat.c,this._lastMat_d=this._curMat.d,this._lastMatScaleY)},o.setFillColor=function(t){this._fillColor=t},o.getFillColor=function(){return this._fillColor},o.translate=function(t,e){0===t&&0===e||(ut.save(this),this._curMat._bTransform?(ht.save(this),this._curMat.tx+=t*this._curMat.a+e*this._curMat.c,this._curMat.ty+=t*this._curMat.b+e*this._curMat.d):(this._curMat.tx=t,this._curMat.ty=e))},o.save=function(){this._save[this._save._length++]=ot.Create(this)},o.restore=function(){var t=this._save._length,e=this._nBlendType;if(!(t<1)){for(var i=t-1;i>=0;i--){var _=this._save[i];if(_.restore(this),_.isSaveMark())return void(this._save._length=i)}e!=this._nBlendType&&(this._curSubmit=pt.RENDERBASE)}},o.fillText=function(t,e,i,_,r,a){this._fillText(t,null,e,i,_,r,null,0,null)},o._fillText=function(t,i,_,r,a,n,s,o,h,u){void 0===u&&(u=0),t?e._charBook.filltext(this,t,_,r,a,n,s,o,h,u):i&&e._charBook.fillWords(this,i,_,r,a,n,s,o)},o._fast_filltext=function(t,i,_,r,a,n,s,o,h){void 0===h&&(h=0),e._charBook._fast_filltext(this,t,null,i,_,r,a,n,s,o,h)},o.fillWords=function(t,e,i,_,r){this._fillText(null,t,e,i,_,r,null,-1,null,0)},o.fillBorderWords=function(t,e,i,_,r,a,n){this._fillBorderText(null,t,e,i,_,r,a,n,null)},o.drawText=function(t,e,i,_,r,a){this._fillText(t,null,e,i,_,l.create(r).strColor,null,-1,a)},o.strokeWord=function(t,e,i,_,r,a,n){this._fillText(t,null,e,i,_,null,l.create(r).strColor,a||1,n)},o.fillBorderText=function(t,e,i,_,r,a,n,s){this._fillBorderText(t,null,e,i,_,l.create(r).strColor,l.create(a).strColor,n,s)},o._fillBorderText=function(t,e,i,_,r,a,n,s,o){this._fillText(t,e,i,_,r,a,n,s||1,o)},o._fillRect=function(t,e,i,_,r){var a=this._curSubmit,n=a&&2===a._key.submitType&&a._key.blendShader===this._submitKey.blendShader;this._mesh.vertNum+4>65535&&(this._mesh=zt.getAMesh(),this.meshlist.push(this._mesh),n=!1),n&&(n=n&&this.isSameClipInfo(a)),this.transformQuad(t,e,i,_,0,this._curMat,this._transedPoints),this.clipedOff(this._transedPoints)||(this._mesh.addQuad(this._transedPoints,X.NO_UV,r,!1),n||(a=this._curSubmit=kt.create(this,this._mesh,Z.create(1,0)),this._submits[this._submits._length++]=a,this.copyClipInfo(a,this._globalClipMatrix),a.shaderValue.textureHost=this._lastTex,a._key.copyFrom2(this._submitKey,2,this._lastTex&&this._lastTex.bitmap?this._lastTex.bitmap.id:-1),a._renderType=10016),this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4)},o.fillRect=function(t,e,i,_,r){var a=r?at.create(r):this._shader2D.fillStyle,n=this.mixRGBandAlpha(a.toInt());this._fillRect(t,e,i,_,n)},o.fillTexture=function(t,e,i,_,r,a,n,s){},o.setShader=function(t){H.save(this,1048576,this._shader2D,!0),this._shader2D.shader=t},o.setColorFilter=function(t){H.save(this,8388608,this,!0),this._colorFiler=t,this._curSubmit=pt.RENDERBASE},o.drawTexture=function(t,e,i,_,r){this._drawTextureM(t,e,i,_,r,null,1,null)},o.drawTextures=function(t,e,_,r){if(t.loaded&&t._getSource())for(var a=e.length/2,n=0,s=0;s<a;s++)this._inner_drawTexture(t,t.bitmap.id,e[n++]+_,e[n++]+r,0,0,null,null,1);else this.sprite&&i.timer.callLater(this,this._repaintSprite)},o._drawTextureAddSubmit=function(t,e){var i=null;i=kt.create(this,this._mesh,Z.create(1,0)),this._submits[this._submits._length++]=i,i.shaderValue.textureHost=e,i._key.copyFrom2(this._submitKey,2,t),i._renderType=10016,this._curSubmit=i},o._drawTextureM=function(t,e,_,r,a,n,s,o){return t._loaded&&t._getSource()?this._inner_drawTexture(t,t.bitmap.id,e,_,r,a,n,o,s):(this.sprite&&i.timer.callLater(this,this._repaintSprite),!1)},o._drawRenderTexture=function(t,e,i,_,r,a,n,s){return this._inner_drawTexture(t,-1,e,i,_,r,a,s,1)},o.submitDebugger=function(){this._submits[this._submits._length++]=Ct.create([],function(){},this)},o.copyClipInfo=function(t,e){var i=t.shaderValue.clipMatDir;i[0]=e.a,i[1]=e.b,i[2]=e.c,i[3]=e.d;var _=t.shaderValue.clipMatPos;_[0]=e.tx,_[1]=e.ty,t.clipInfoID=this._clipInfoID},o.isSameClipInfo=function(t){return t.clipInfoID===this._clipInfoID},o._useNewTex2DSubmit=function(t,e){this._mesh.vertNum+e>65535&&(this._mesh=zt.getAMesh(),this.meshlist.push(this._mesh));var i=kt.create(this,this._mesh,Z.create(1,0));this._submits[this._submits._length++]=this._curSubmit=i,i.shaderValue.textureHost=t,this.copyClipInfo(i,this._globalClipMatrix)},o._drawTexRect=function(t,e,i,_,r){this.transformQuad(t,e,i,_,this._italicDeg,this._curMat,this._transedPoints);var a=this._transedPoints;a[0]=a[0]+.5|0,a[1]=a[1]+.5|0,a[2]=a[2]+.5|0,a[3]=a[3]+.5|0,a[4]=a[4]+.5|0,a[5]=a[5]+.5|0,a[6]=a[6]+.5|0,a[7]=a[7]+.5|0,this.clipedOff(this._transedPoints)||(this._mesh.addQuad(this._transedPoints,r,this._fillColor,!0),this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4)},o._inner_drawTexture=function(t,e,i,_,r,a,n,s,o){this._drawCount++;var h=this._curSubmit._key,u=e>=0&&2===h.submitType&&h.other===e;u&&(u=u&&this.isSameClipInfo(this._curSubmit)),this._lastTex=t;var l=this.mixRGBandAlpha(4294967295);if(l=this._mixRGBandAlpha(l,o),this._mesh.vertNum+4>65535&&(this._mesh=zt.getAMesh(),this.meshlist.push(this._mesh),u=!1),this.transformQuad(i,_,r||t.width,a||t.height,this._italicDeg,n||this._curMat,this._transedPoints),!this.clipedOff(this._transedPoints)){if(this._mesh.addQuad(this._transedPoints,s||t._uv,l,!0),!u){var c=kt.create(this,this._mesh,Z.create(1,0));this._submits[this._submits._length++]=this._curSubmit=c,c.shaderValue.textureHost=t,c._key.other=e,this.copyClipInfo(c,this._globalClipMatrix)}return this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4,!0}return!1},o.transform4Points=function(t,e,i){var _=e.tx,r=e.ty;e._bTransform?(i[0]=t[0]*e.a+t[1]*e.c+_,i[1]=t[0]*e.b+t[1]*e.d+r,i[2]=t[2]*e.a+t[3]*e.c+_,i[3]=t[2]*e.b+t[3]*e.d+r,i[4]=t[4]*e.a+t[5]*e.c+_,i[5]=t[4]*e.b+t[5]*e.d+r,i[6]=t[6]*e.a+t[7]*e.c+_,i[7]=t[6]*e.b+t[7]*e.d+r):(i[0]=t[0]+_,i[1]=t[1]+r,i[2]=t[2]+_,i[3]=t[3]+r,i[4]=t[4]+_,i[5]=t[5]+r,i[6]=t[6]+_,i[7]=t[7]+r)},o.clipedOff=function(t){return this._clipRect.width<=0||this._clipRect.height<=0},o.transformQuad=function(t,e,i,_,r,a,n){var s=0;0!=r&&(s=Math.tan(r*Math.PI/180)*_);var o=t+i,h=e+_;this._temp4Points[0]=t+s,this._temp4Points[1]=e,this._temp4Points[2]=o+s,this._temp4Points[3]=e,this._temp4Points[4]=o,this._temp4Points[5]=h,this._temp4Points[6]=t,this._temp4Points[7]=h,this.transform4Points(this._temp4Points,a,n)},o.pushRT=function(){this.addRenderObject(Ct.create(null,ie.pushRT,this))},o.popRT=function(){this.addRenderObject(Ct.create(null,ie.popRT,this)),this.breakNextMerge()},o.useRT=function(t){this.addRenderObject(Ct.create([t],function(t){if(!t)throw"error useRT";t.start(),t.clear(0,0,0,0)},this)),this.breakNextMerge()},o.RTRestore=function(t){this.addRenderObject(Ct.create([t],function(t){t.restore()},this)),this.breakNextMerge()},o.breakNextMerge=function(){this._curSubmit=pt.RENDERBASE},o._repaintSprite=function(){this.sprite&&this.sprite.repaint()},o.drawTextureWithTransform=function(t,i,_,r,a,n,s,o,h,u){if(n){var l=this._curMat;e._tmpMatrix.a=n.a,e._tmpMatrix.b=n.b,e._tmpMatrix.c=n.c,e._tmpMatrix.d=n.d,e._tmpMatrix.tx=n.tx+s,e._tmpMatrix.ty=n.ty+o,e._tmpMatrix._bTransform=n._bTransform,n&&l._bTransform?(p.mul(e._tmpMatrix,l,e._tmpMatrix),(n=e._tmpMatrix)._bTransform=!0):n=e._tmpMatrix,this._drawTextureM(t,i,_,r,a,n,h,null)}else this._drawTextureM(t,i+s,_+o,r,a,null,h,null)},o._flushToTarget=function(t,e){yt.worldScissorTest=!1,bt.mainContext.disable(3089);var i=yt.worldAlpha,_=yt.worldMatrix4,r=yt.worldMatrix;yt.worldShaderDefines;yt.worldMatrix=p.EMPTY,yt.restoreTempArray(),yt.worldMatrix4=yt.TEMPMAT4_ARRAY,yt.worldAlpha=1,jt.activeShader=null,e.start(),c.showCanvasMark?e.clear(0,1,0,.3):e.clear(0,0,0,0),t._curSubmit=pt.RENDERBASE,t.flush(),t.clear(),e.restore(),t._curSubmit=pt.RENDERBASE,jt.activeShader=null,yt.worldAlpha=i,yt.worldMatrix4=_,yt.worldMatrix=r},o.drawCanvas=function(t,e,i,_,r){var a,n=t.context;if(n._targets)n._submits._length>0&&(a=Ct.create([n,n._targets],this._flushToTarget,this),this._submits[this._submits._length++]=a),this._drawRenderTexture(n._targets,e,i,_,r,null,1,ie.flipyuv),this._curSubmit=pt.RENDERBASE;else{n.touches&&n.touches.forEach(function(t){t.touch()}),a=Xt.create(n,this._shader2D.ALPHA,this._shader2D.filters),this._submits[this._submits._length++]=a,a._key.clear();var s=_/t.width,o=r/t.height,h=a._matrix;this._curMat.copyTo(h),1!=s&&1!=o&&h.scale(s,o);var u=h.tx,l=h.ty;h.tx=h.ty=0,h.transformPoint(M.TEMP.setTo(e,i)),h.translate(M.TEMP.x+u,M.TEMP.y+l),this._curSubmit=pt.RENDERBASE}c.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=n._targets?"yellow":"green",this.strokeRect(e-1,i-1,_+2,r+2,1),this.strokeRect(e,i,_,r,1),this.restore())},o.drawTarget=function(t,e,i,_,r,a,n,s,o){void 0===o&&(o=-1),this._drawCount++;this.mixRGBandAlpha(this._drawTextureUseColor?this.fillStyle?this.fillStyle.toInt():0:4294967295);if(this._mesh.vertNum+4>65535&&(this._mesh=zt.getAMesh(),this.meshlist.push(this._mesh)),this.transformQuad(e,i,_,r,0,a||this._curMat,this._transedPoints),!this.clipedOff(this._transedPoints)){this._mesh.addQuad(this._transedPoints,s||X.DEF_UV,4294967295,!0);var h=this._curSubmit=Ot.create(this,this._mesh,n,t);return h.blendType=-1==o?this._nBlendType:o,this.copyClipInfo(h,this._globalClipMatrix),h._numEle=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4,this._maxNumEle=Math.max(this._maxNumEle,h._numEle),this._submits[this._submits._length++]=h,this._curSubmit=pt.RENDERBASE,!0}return this._curSubmit=pt.RENDERBASE,!1},o.drawTriangles=function(t,_,r,a,n,s,o,h,u,l){if(t._loaded&&t._getSource()){this._drawCount++;var c=null,f=!1;u&&(c=this._colorFiler,this._colorFiler=u,this._curSubmit=pt.RENDERBASE,f=c!=u);var d=t.bitmap,E=this._curSubmit._key,A=4===E.submitType&&E.other===d.id,D=this.mixRGBandAlpha(4294967295);D=this._mixRGBandAlpha(D,h);var R=a.length/2,m=s.length;if(this._triangleMesh.vertNum+R>65535&&(this._triangleMesh=Yt.getAMesh(),this.meshlist.push(this._triangleMesh),A=!1),!A){var T=this._curSubmit=kt.create(this,this._triangleMesh,Z.create(1,0));T.shaderValue.textureHost=t,T._key.copyFrom2(this._submitKey,4,d.id),T._renderType=10016,this._submits[this._submits._length++]=T}o?(e._tmpMatrix.a=o.a,e._tmpMatrix.b=o.b,e._tmpMatrix.c=o.c,e._tmpMatrix.d=o.d,e._tmpMatrix.tx=o.tx+_,e._tmpMatrix.ty=o.ty+r):(e._tmpMatrix.a=1,e._tmpMatrix.b=0,e._tmpMatrix.c=0,e._tmpMatrix.d=1,e._tmpMatrix.tx=_,e._tmpMatrix.ty=r),p.mul(e._tmpMatrix,this._curMat,e._tmpMatrix),this._triangleMesh.addData(a,n,s,e._tmpMatrix,D,this),this._curSubmit._numEle+=m,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),f&&(this._colorFiler=c,this._curSubmit=pt.RENDERBASE)}else this.sprite&&i.timer.callLater(this,this._repaintSprite)},o.transform=function(t,e,i,_,r,a){ht.save(this),p.mul(p.TEMP.setTo(t,e,i,_,r,a),this._curMat,this._curMat),this._curMat._checkTransform()},o._transformByMatrix=function(t,e,i){t.setTranslate(e,i),p.mul(t,this._curMat,this._curMat),t.setTranslate(0,0),this._curMat._bTransform=!0},o.setTransformByMatrix=function(t){t.copyTo(this._curMat)},o.rotate=function(t){ht.save(this),this._curMat.rotateEx(t)},o.scale=function(t,e){ht.save(this),this._curMat.scaleEx(t,e)},o.clipRect=function(t,i,_,r){st.save(this),this._clipRect==e.MAXCLIPRECT?this._clipRect=new S(t,i,_,r):(this._clipRect.width=_,this._clipRect.height=r,this._clipRect.x=t,this._clipRect.y=i),this._clipInfoID=++this._clipInfoID%1e4;var a=this._globalClipMatrix;this._clipRect.width>=99999999?(a.a=a.d=99999999,a.b=a.c=a.tx=a.ty=0):this._curMat._bTransform?(a.tx=this._clipRect.x*this._curMat.a+this._clipRect.y*this._curMat.c+this._curMat.tx,a.ty=this._clipRect.x*this._curMat.b+this._clipRect.y*this._curMat.d+this._curMat.ty,a.a=this._clipRect.width*this._curMat.a,a.b=this._clipRect.width*this._curMat.b,a.c=this._clipRect.height*this._curMat.c,a.d=this._clipRect.height*this._curMat.d):(a.tx=this._clipRect.x+this._curMat.tx,a.ty=this._clipRect.y+this._curMat.ty,a.a=this._clipRect.width,a.b=a.c=0,a.d=this._clipRect.height)},o.drawMesh=function(t,e,i,_,r,a,n,s,o){void 0===o&&(o=0)},o.addRenderObject=function(t){this._submits[this._submits._length++]=t},o.submitElement=function(t,e){g._context;var i=this._submits,_=i._length;e<0&&(e=i._length);for(var r=pt.RENDERBASE;t<e;)this._renderNextSubmitIndex=t+1,i[t]!==pt.RENDERBASE?(pt.preRender=r,t+=(r=i[t]).renderSubmit()):t++;return _},o.flush=function(){var t=this.submitElement(0,this._submits._length);this._path&&this._path.reset(),mt.instance&&mt.getInstance().reset(),this._curSubmit=pt.RENDERBASE;for(var e=0,i=this.meshlist.length;e<i;e++){var _=this.meshlist[e];_.canReuse?_.releaseMesh():_.destroy()}return this.meshlist.length=0,this._mesh=zt.getAMesh(),this._pathMesh=Ht.getAMesh(),this._triangleMesh=Yt.getAMesh(),this.meshlist.push(this._mesh,this._pathMesh,this._triangleMesh),this._flushCnt++,this._flushCnt%600==0&&g._context==this&&lt.charbookInst&&lt.charbookInst.GC(),t},o.setPathId=function(t){if(this.mId=t,-1!=this.mId){this.mHaveKey=!1;var e=Y.getInstance();e.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,e.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},o.beginPath=function(t){void 0===t&&(t=!1);this._getPath().beginPath(t)},o.closePath=function(){this._path.closePath()},o.addPath=function(t,e,i,_,r){var a=0,n=this._curMat;if(this._curMat._bTransform)for(var s=0,o=t.length/2;s<o;s++){var h=t[a]+_,u=t[a+1]+r;t[a]=h*n.a+u*n.c+n.tx,t[a+1]=h*n.b+u*n.d+n.ty,a+=2}else if(0!=n.tx||0!=n.ty||_||r)for(s=0,o=t.length/2;s<o;s++){var l=t[a]+_,c=t[a+1]+r;t[a]=l+n.tx,t[a+1]=c+n.ty,a+=2}else;this._getPath().push(t,i)},o.fill=function(){var t=this._getPath(),e=this._curSubmit,i=3===e._key.submitType&&e._key.blendShader===this._submitKey.blendShader;i&&(i=i&&this.isSameClipInfo(e)),i||(this._curSubmit=this.addVGSubmit(this._pathMesh));for(var _,r=this.mixRGBandAlpha(this.fillStyle.toInt()),a=0,n=0,s=t.paths.length;n<s;n++){var o=t.paths[n],h=o.path.length/2;if(!(h<3||3==h&&!o.convex)){this._pathMesh.vertNum+h>65535&&(this._curSubmit._numEle+=a,a=0,this._pathMesh=Ht.getAMesh(),this._curSubmit=this.addVGSubmit(this._pathMesh));var u=this._pathMesh.vertNum;if(o.convex){var l=h-2;_=new Array(3*l);for(var c=0,f=0;f<l;f++)_[c++]=u,_[c++]=f+1+u,_[c++]=f+2+u}else if(_=Pt.earcut(o.path,null,2),u>0)for(var d=0;d<_.length;d++)_[d]+=u;this._pathMesh.addVertAndIBToMesh(this,o.path,r,_),a+=_.length}}this._curSubmit._numEle+=a},o.addVGSubmit=function(t){var e=pt.createShape(this,t,0,Z.create(4,0));return e._key.blendShader=this._submitKey.blendShader,e._key.submitType=3,this._submits[this._submits._length++]=e,this.copyClipInfo(e,this._globalClipMatrix),e},o.stroke=function(){if(this.lineWidth>0){var t=this.mixRGBandAlpha(this.strokeStyle._color.numColor),e=this._getPath(),i=this._curSubmit,_=3===i._key.submitType&&i._key.blendShader===this._submitKey.blendShader;_&&(_=_&&this.isSameClipInfo(i)),_||(this._curSubmit=this.addVGSubmit(this._pathMesh));for(var r=0,a=0,n=e.paths.length;a<n;a++){var s=e.paths[a];if(!(s.path.length<=0)){var o=[],h=[],u=2*s.path.length;u<2||(this._pathMesh.vertNum+u>65535&&(this._curSubmit._numEle+=r,r=0,this._pathMesh=Ht.getAMesh(),this.meshlist.push(this._pathMesh),this._curSubmit=this.addVGSubmit(this._pathMesh)),Tt.createLine2(s.path,o,this.lineWidth,this._pathMesh.vertNum,h,s.loop),this._pathMesh.addVertAndIBToMesh(this,h,t,o),r+=o.length)}}this._curSubmit._numEle+=r}},o.moveTo=function(t,e,i){void 0===i&&(i=!0);var _=this._getPath();if(_.newPath(),_._lastOriX=t,_._lastOriY=e,i){var r=t,a=e;t=this._curMat.a*r+this._curMat.c*a+this._curMat.tx,e=this._curMat.b*r+this._curMat.d*a+this._curMat.ty}_.addPoint(t,e)},o.lineTo=function(t,e,i){void 0===i&&(i=!0);var _=this._getPath();if(!(Math.abs(t-_._lastOriX)<.001&&Math.abs(e-_._lastOriY)<.001)){if(_._lastOriX=t,_._lastOriY=e,i){var r=t,a=e;t=this._curMat.a*r+this._curMat.c*a+this._curMat.tx,e=this._curMat.b*r+this._curMat.d*a+this._curMat.ty}_.addPoint(t,e)}},o.arcTo=function(t,i,_,r,a){var n=0,s=0,o=0,h=this._path._lastOriX-t,u=this._path._lastOriY-i,l=Math.sqrt(h*h+u*u);if(!(l<=1e-6)){var c=h/l,f=u/l,d=_-t,E=r-i,A=d*d+E*E,D=Math.sqrt(A);if(!(D<=1e-6)){var R=d/D,m=E/D,T=c+R,P=f+m,v=Math.sqrt(T*T+P*P);if(!(v<=1e-6)){var p=T/v,C=P/v,M=Math.acos(p*c+C*f),O=Math.PI/2-M,S=(l=a/Math.tan(O))*c+t,g=l*f+i,y=Math.sqrt(l*l+a*a),L=t+p*y,b=i+C*y,B=0,I=0,x=0;if(c*m-f*R>=0){var N=(B=2*O)/e.SEGNUM;I=Math.sin(N),x=Math.cos(N)}else N=(B=2*-O)/e.SEGNUM,I=Math.sin(N),x=Math.cos(N);var F=this._path._lastOriX,w=this._path._lastOriY,V=S,U=g;(Math.abs(V-this._path._lastOriX)>.1||Math.abs(U-this._path._lastOriY)>.1)&&(s=this._curMat.a*V+this._curMat.c*U+this._curMat.tx,o=this._curMat.b*V+this._curMat.d*U+this._curMat.ty,F=V,w=U,this._path.addPoint(s,o));var W=S-L,G=g-b;for(n=0;n<e.SEGNUM;n++){var X=W*x+G*I,k=-W*I+G*x;if(s=X+L,o=k+b,Math.abs(F-s)>.1||Math.abs(w-o)>.1){var z=s,Y=o;s=this._curMat.a*z+this._curMat.c*Y+this._curMat.tx,o=this._curMat.b*z+this._curMat.d*Y+this._curMat.ty,this._path.addPoint(s,o),F=s,w=o}W=X,G=k}}}}},o.arc=function(t,e,i,_,r,a,n){void 0===a&&(a=!1),void 0===n&&(n=!0);var s=0,o=0,h=0,u=0,l=0,c=0,f=0,d=0,E=0,A=0;if(o=r-_,a)if(Math.abs(o)>=2*Math.PI)o=2*-Math.PI;else for(;o>0;)o-=2*Math.PI;else if(Math.abs(o)>=2*Math.PI)o=2*Math.PI;else for(;o<0;)o+=2*Math.PI;h=o/(A=i<101?Math.max(10,o*i/5):i<201?Math.max(10,o*i/20):Math.max(10,o*i/40))/2,u=Math.abs(4/3*(1-Math.cos(h))/Math.sin(h)),a&&(u=-u);var D=this._getPath();for(E=0;E<=A;E++)if(s=_+o*(E/A),l=Math.cos(s),c=Math.sin(s),f=t+l*i,d=e+c*i,f!=this._path._lastOriX||d!=this._path._lastOriY){var R=f,m=d;f=this._curMat.a*R+this._curMat.c*m+this._curMat.tx,d=this._curMat.b*R+this._curMat.d*m+this._curMat.ty,D.addPoint(f,d)}if(l=Math.cos(r),c=Math.sin(r),f=t+l*i,d=e+c*i,f!=this._path._lastOriX||d!=this._path._lastOriY){var T=f,P=d;f=this._curMat.a*T+this._curMat.c*P+this._curMat.tx,d=this._curMat.b*T+this._curMat.d*P+this._curMat.ty,D.addPoint(f,d)}},o.quadraticCurveTo=function(t,e,i,_){for(var r=n.I.getBezierPoints([this._path._lastOriX,this._path._lastOriY,t,e,i,_],30,2),a=0,s=r.length/2;a<s;a++)this.lineTo(r[2*a],r[2*a+1]);this.lineTo(i,_)},o.rect=function(t,e,i,_){this._other=this._other.make(),this._other.path||(this._other.path=new nt),this._other.path.rect(t,e,i,_)},o.mixRGBandAlpha=function(t){return this._mixRGBandAlpha(t,this._shader2D.ALPHA)},o._mixRGBandAlpha=function(t,e){var i=(4278190080&t)>>>24;return 0!=i?i*=e:i=255*e,16777215&t|i<<24},o.strokeRect=function(t,e,i,_,r){if(this.lineWidth>0){var a=this.mixRGBandAlpha(this.strokeStyle._color.numColor),n=this.lineWidth/2;this._fillRect(t-n,e-n,i+this.lineWidth,this.lineWidth,a),this._fillRect(t-n,e-n+_,i+this.lineWidth,this.lineWidth,a),this._fillRect(t-n,e+n,this.lineWidth,_-this.lineWidth,a),this._fillRect(t-n+i,e+n,this.lineWidth,_-this.lineWidth,a)}},o.clip=function(){},o.drawParticle=function(t,e,i){i.x=t,i.y=e,this._submits[this._submits._length++]=i},o._getPath=function(){return this._path||(this._path=new nt)},a(0,o,"globalCompositeOperation",function(){return rt.NAMES[this._nBlendType]},function(t){var e=rt.TOINT[t];null==e||this._nBlendType===e||(H.save(this,65536,this,!0),this._curSubmit=pt.RENDERBASE,this._nBlendType=e)}),a(0,o,"strokeStyle",function(){return this._shader2D.strokeStyle},function(t){this._shader2D.strokeStyle.equal(t)||(H.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=at.create(t),this._submitKey.other=-this._shader2D.strokeStyle.toInt())}),a(0,o,"globalAlpha",function(){return this._shader2D.ALPHA},function(t){(t=Math.floor(1e3*t)/1e3)!=this._shader2D.ALPHA&&(H.save(this,1,this._shader2D,!1),this._shader2D.ALPHA=this._submitKey.alpha=t)}),a(0,o,"asBitmap",null,function(t){if(t){if(this._targets||(this._targets=new ie(this._width,this._height,1,-1)),!this._width||!this._height)throw Error("asBitmap no size!")}else this._targets&&this._targets.destroy(),this._targets=null}),a(0,o,"fillStyle",function(){return this._shader2D.fillStyle},function(t){this._shader2D.fillStyle.equal(t)||(H.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=at.create(t),this._submitKey.other=-this._shader2D.fillStyle.toInt())}),a(0,o,"textAlign",function(){return this._other.textAlign},function(t){this._other.textAlign===t||(this._other=this._other.make(),H.save(this,32768,this._other,!1),this._other.textAlign=t)}),a(0,o,"lineWidth",function(){return this._other.lineWidth},function(t){this._other.lineWidth===t||(this._other=this._other.make(),H.save(this,256,this._other,!1),this._other.lineWidth=t)}),a(0,o,"textBaseline",function(){return this._other.textBaseline},function(t){this._other.textBaseline===t||(this._other=this._other.make(),H.save(this,16384,this._other,!1),this._other.textBaseline=t)}),a(0,o,"font",null,function(t){this._other=this._other.make(),H.save(this,8,this._other,!1)}),e.__init__=function(){s.DEFAULT=new s},e._tempPoint=new M,e._SUBMITVBSIZE=32e3,e._MAXSIZE=99999999,e._MAXVERTNUM=65535,e.MAXCLIPRECT=new S(0,0,99999999,99999999),e._COUNT=0,e._tmpMatrix=new p,e.SEGNUM=32,e._contextcount=0,e.defTexture=null,_(e,["_drawStyleTemp",function(){return this._drawStyleTemp=new at(null)},"_keyMap",function(){return this._keyMap=new U},"_charBook",function(){return this._charBook=new lt}]),e.__init$=function(){s=function(){function t(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null}r(t,"");var e=t.prototype;return e.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null},e.make=function(){return this===t.DEFAULT?new t:this},t.DEFAULT=null,t}()},e}(),xt=function(t){function e(t,i){e.__super.call(this,t,i)}r(e,"laya.webgl.utils.RenderSprite3D",y);var i=e.prototype;return i.onCreate=function(t){switch(t){case 4:return void(this._fun=this._blend)}},i._mask=function(t,e,i,_){var r=this._next,a=t.mask,n=e;if(a){n.save();var s=n.globalCompositeOperation,o=new S;if(o.copyFrom(a.getBounds()),o.width=Math.round(o.width),o.height=Math.round(o.height),o.x=Math.round(o.x),o.y=Math.round(o.y),o.width>0&&o.height>0){var h=o.width,u=o.height,l=At.getRT(h,u);n.breakNextMerge(),n.pushRT(),n.addRenderObject(Ct.create([n,l,h,u],laya.webgl.utils.RenderSprite3D.tmpTarget,this)),a.render(n,-o.x,-o.y),n.breakNextMerge(),n.popRT(),n.save(),n.clipRect(i+o.x,_+o.y,h,u),r._fun.call(r,t,n,i,_),n.restore(),s=n.globalCompositeOperation,n.addRenderObject(Ct.create(["mask"],laya.webgl.utils.RenderSprite3D.setBlendMode,this));var c=Z.create(1,0),f=X.INV_UV;n.drawTarget(l,i+o.x,_+o.y,h,u,p.TEMP.identity(),c,f,6),n.addRenderObject(Ct.create([l],laya.webgl.utils.RenderSprite3D.recycleTarget,this)),n.addRenderObject(Ct.create([s],laya.webgl.utils.RenderSprite3D.setBlendMode,this))}n.restore()}else r._fun.call(r,t,e,i,_)},i._blend=function(t,e,i,_){var r=t._style,a=this._next;r.blendMode?(e.save(),e.globalCompositeOperation=r.blendMode,a._fun.call(a,t,e,i,_),e.restore()):a._fun.call(a,t,e,i,_)},e.tmpTarget=function(t,e,i,_){e.start(),e.clear(0,0,0,0)},e.recycleTarget=function(t){At.releaseRT(t)},e.setBlendMode=function(t){var e=bt.mainContext;rt.targetFns[rt.TOINT[t]](e)},_(e,["tempUV",function(){return this.tempUV=new Array(8)}]),e}(),Nt=function(t){function e(t){this.texcoord=null,this.position=null,this.offsetX=300,this.offsetY=0,e.__super.call(this,512,0);var i=8*St.BYTES_PE;this.position=[2,5126,!1,i,0],this.texcoord=[2,5126,!1,i,2*St.BYTES_PE],this.color=[4,5126,!1,i,4*St.BYTES_PE]}return r(e,"laya.webgl.shader.d2.skinAnishader.SkinSV",Z),e}(),Ft=function(t){function e(t){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],e.__super.call(this,256,0)}r(e,"laya.webgl.shader.d2.value.FillTextureSV",Z);return e.prototype.clear=function(){this.texture=null,this.shader=null,this.defines.setValue(0)},e}(),wt=function(t){function e(t){e.__super.call(this,4,0),this._attribLocation=["position",0,"attribColor",1]}return r(e,"laya.webgl.shader.d2.value.PrimitiveSV",Z),e}(),Vt=function(t){function e(t){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,void 0===t&&(t=0),e.__super.call(this,1,t),this._attribLocation=["posuv",0,"attribColor",1,"attribFlags",2]}r(e,"laya.webgl.shader.d2.value.TextureSV",Z);return e.prototype.clear=function(){this.texture=null,this.shader=null,this.defines._value=this.subID+(bt.shaderHighPrecision?1024:0)},e}(),Ut=function(i){function _(){this.lastScaleX=1,this.lastScaleY=1,this.needResetScale=!1,_.__super.call(this),_.canvas||((_.canvas=t.document.createElement("canvas")).width=512,_.canvas.height=512,_.canvas.style.left="-1000px",_.canvas.style.position="absolute",e.body.appendChild(_.canvas),_.ctx=_.canvas.getContext("2d"))}r(_,"laya.webgl.resource.CharRender_Canvas",Et);var a=_.prototype;return a.getWidth=function(t){return _.ctx?(_.ctx._lastFont!=lt._curFont&&(_.ctx.font=lt._curFont,_.ctx._lastFont=lt._curFont),_.ctx.measureText(t).width):0},a.scale=function(t,e){this.lastScaleX==t&&this.lastScaleY==e||(this.needResetScale&&(_.ctx.restore(),this.lastScaleX=this.lastScaleY=1),_.ctx.save(),this.needResetScale=!0,_.ctx.scale(t,e),this.lastScaleX=t,this.lastScaleY=e)},a.getCharBmp=function(t,e,i,r,a,n,s,o,h,u){_.ctx.font!=e&&(_.ctx.font=e,_.ctx._lastFont=e),n.width=_.ctx.measureText(t).width;var l=n.width*this.lastScaleX,c=n.height*this.lastScaleY;return l+=(s+h)*this.lastScaleX,c+=(o+u)*this.lastScaleY,_.ctx.clearRect(0,0,l+1,c+1),_.ctx.textBaseline="top",i>0?(_.ctx.strokeStyle=r,_.ctx.lineWidth=i,_.ctx.strokeText(t,s,o)):(_.ctx.fillStyle=r,_.ctx.fillText(t,s,o)),lt.debug&&(_.ctx.strokeStyle="#ff0000",_.ctx.strokeRect(0,0,l,c),_.ctx.strokeStyle="#00ff00",_.ctx.strokeRect(s,o,n.width,n.height)),_.ctx.getImageData(0,0,l,c)},_.canvas=null,_.ctx=null,_}(),Wt=function(e){function i(){this.lastFont="",i.__super.call(this)}r(i,"laya.webgl.resource.CharRender_Native",Et);var _=i.prototype;return _.getWidth=function(e){return t.conchTextCanvas?(this.lastFont!=lt._curFont&&(t.conchTextCanvas.font=lt._curFont,this.lastFont=lt._curFont),t.conchTextCanvas.measureText(e).width):0},_.scale=function(t,e){},_.getCharBmp=function(e,i,_,r,a,n,s,o,h,u){if(!t.conchTextCanvas)return null;this.lastFont!=i&&(t.conchTextCanvas.font=lt._curFont,this.lastFont=lt._curFont);n.width=t.conchTextCanvas.measureText(e).width,n.height;var c=l.create(a).numColor,f=l.create(r).numColor;return t.conchTextCanvas.getTextBitmapData(e,f,_,c)},i}(),Gt=function(t){function e(){e.__super.call(this,e.__name2int,e.__int2name,e.__int2nameMap)}return r(e,"laya.webgl.shader.d2.ShaderDefines2D",Rt),e.__init__=function(){e.reg("TEXTURE2D",1),e.reg("PRIMITIVE",4),e.reg("GLOW_FILTER",8),e.reg("BLUR_FILTER",16),e.reg("COLOR_FILTER",32),e.reg("COLOR_ADD",64),e.reg("WORLDMAT",128),e.reg("FILLTEXTURE",256),e.reg("FSHIGHPRECISION",1024)},e.reg=function(t,i){Rt._reg(t,i,e.__name2int,e.__int2name)},e.toText=function(t,e,i){return Rt._toText(t,e,i)},e.toInt=function(t){return Rt._toInt(t,e.__name2int)},e.TEXTURE2D=1,e.PRIMITIVE=4,e.FILTERGLOW=8,e.FILTERBLUR=16,e.FILTERCOLOR=32,e.COLORADD=64,e.WORLDMAT=128,e.FILLTEXTURE=256,e.SKINMESH=512,e.SHADERDEFINE_FSHIGHPRECISION=1024,e.__name2int={},e.__int2name=[],e.__int2nameMap=[],e}(),Xt=function(t){function e(){this._matrix=new p,this._matrix4=St.defaultMatrix4.concat(),e.__super.call(this,1e4),this.shaderValue=new Z(0,0)}r(e,"laya.webgl.submit.SubmitCanvas",pt);var i=e.prototype;return i.renderSubmit=function(){if(this._ctx_src._targets)return alert("nimei"),1;var t=yt.worldAlpha,e=yt.worldMatrix4,i=yt.worldMatrix,_=yt.worldFilters,r=yt.worldShaderDefines,a=this.shaderValue,n=this._matrix,s=this._matrix4,o=p.TEMP;return p.mul(n,i,o),s[0]=o.a,s[1]=o.b,s[4]=o.c,s[5]=o.d,s[12]=o.tx,s[13]=o.ty,yt.worldMatrix=o.clone(),yt.worldMatrix4=s,yt.worldAlpha=yt.worldAlpha*a.alpha,a.filters&&a.filters.length&&(yt.worldFilters=a.filters,yt.worldShaderDefines=a.defines),this._ctx_src.flush(),yt.worldAlpha=t,yt.worldMatrix4=e,yt.worldMatrix.destroy(),yt.worldMatrix=i,yt.worldFilters=_,yt.worldShaderDefines=r,1},i.releaseRender=function(){if(--this._ref<1){var t=e.POOL;this._ctx_src=null,this._mesh=null,t[t._length++]=this}},i.clone=function(t,e,i){return null},i.getRenderType=function(){return 10003},e.create=function(t,i,_){var r=e.POOL._length?e.POOL[--e.POOL._length]:new e;r._ctx_src=t,r._ref=1,r._numEle=0;var a=r.shaderValue;return a.alpha=i,a.defines.setValue(0),_&&_.length&&a.setFilters(_),r},e.POOL=(e.POOL=[],e.POOL._length=0,e.POOL),e}(),kt=function(t){function e(t){void 0===t&&(t=1e4),e.__super.call(this,t)}r(e,"laya.webgl.submit.SubmitTexture",pt);var i=e.prototype;return i.clone=function(t,i,_){var r=e._poolSize?e.POOL[--e._poolSize]:new e;return this._cloneInit(r,t,i,_),r},i.releaseRender=function(){--this._ref<1&&(e.POOL[e._poolSize++]=this,this.shaderValue.release(),this._mesh=null,this._parent&&(this._parent.releaseRender(),this._parent=null))},i.renderSubmit=function(){if(0===this._numEle)return 1;var t=this.shaderValue.textureHost;if(t){var e=t?t._getSource():null;if(!e)return 1}var i=bt.mainContext;this._mesh.useMesh(i);var _=pt.preRender,r=pt.preRender._key;return 0===this._key.blendShader&&this._key.submitType===r.submitType&&this._key.blendShader===r.blendShader&&jt.activeShader&&pt.preRender.clipInfoID==this.clipInfoID&&_.shaderValue.defines._value===this.shaderValue.defines._value&&!1&this.shaderValue.defines._value&&!1&this.shaderValue.defines._value&&!1&this.shaderValue.defines._value?jt.activeShader.uploadTexture2D(e):(rt.activeBlendFunction!==this._blendFn&&(Bt.setBlend(i,!0),this._blendFn(i),rt.activeBlendFunction=this._blendFn),this.shaderValue.texture=e,this.shaderValue.upload()),i.drawElements(4,this._numEle,5123,this._startIdx),V.drawCall++,V.trianglesFaces+=this._numEle/3,1},e.create=function(t,i,_){var r=e._poolSize?e.POOL[--e._poolSize]:new e(10016);r._mesh=i,r._key.clear(),r._key.submitType=2,r._ref=1,r._startIdx=i.indexNum*St.BYTES_PIDX,r._numEle=0;var a=t._nBlendType;if(r._key.blendShader=a,r._blendFn=t._targets?rt.targetFns[a]:rt.fns[a],r.shaderValue=_,t._colorFiler){var n=t._colorFiler;_.defines.add(n.type),_.colorMat=n._mat,_.colorAlpha=n._alpha}return r},e._poolSize=0,e.POOL=[],e}(),zt=(function(t){function e(t){e.__super.call(this,laya.webgl.utils.MeshParticle2D.const_stride,4*t*e.const_stride,4),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshParticle2D._fixattriInfo),this.createQuadIB(t),this._quadNum=t}r(e,"laya.webgl.utils.MeshParticle2D",gt);var i=e.prototype;i.setMaxParticleNum=function(t){this._vb._resizeBuffer(4*t*e.const_stride,!1),this.createQuadIB(t)},i.releaseMesh=function(){this._vb.setByteLength(0),this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshParticle2D._POOL.push(this)},i.destroy=function(){this._ib.destroy(),this._vb.destroy(),this._vb.deleteBuffer()},e.getAMesh=function(t){if(laya.webgl.utils.MeshParticle2D._POOL.length){var i=laya.webgl.utils.MeshParticle2D._POOL.pop();return i.setMaxParticleNum(t),i}return new e(t)},e.const_stride=116,e._POOL=[],_(e,["_fixattriInfo",function(){return this._fixattriInfo=[5126,4,0,5126,3,16,5126,3,28,5126,4,40,5126,4,56,5126,3,72,5126,2,84,5126,4,92,5126,1,108,5126,1,112]}])}(),function(t){function e(){e.__super.call(this,laya.webgl.utils.MeshQuadTexture.const_stride,4,4),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshQuadTexture._fixattriInfo),laya.webgl.utils.MeshQuadTexture._fixib?(this._ib=laya.webgl.utils.MeshQuadTexture._fixib,this._quadNum=e._maxIB):(this.createQuadIB(e._maxIB),laya.webgl.utils.MeshQuadTexture._fixib=this._ib)}r(e,"laya.webgl.utils.MeshQuadTexture",gt);var i=e.prototype;return i.releaseMesh=function(){this._vb.setByteLength(0),this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshQuadTexture._POOL.push(this)},i.destroy=function(){this._vb.destroy(),this._vb.deleteBuffer()},i.addQuad=function(t,e,i,_){var r=this._vb,a=r._byteLength>>2;r.setByteLength(a+laya.webgl.utils.MeshQuadTexture.const_stride<<2);var n=r._floatArray32||r.getFloat32Array(),s=r._uint32Array,o=a,h=_?255:0;n[o++]=t[0],n[o++]=t[1],n[o++]=e[0],n[o++]=e[1],s[o++]=i,s[o++]=h,n[o++]=t[2],n[o++]=t[3],n[o++]=e[2],n[o++]=e[3],s[o++]=i,s[o++]=h,n[o++]=t[4],n[o++]=t[5],n[o++]=e[4],n[o++]=e[5],s[o++]=i,s[o++]=h,n[o++]=t[6],n[o++]=t[7],n[o++]=e[6],n[o++]=e[7],s[o++]=i,s[o++]=h,r._upload=!0},e.getAMesh=function(){return laya.webgl.utils.MeshQuadTexture._POOL.length?laya.webgl.utils.MeshQuadTexture._POOL.pop():new e},e.const_stride=24,e._fixib=null,e._maxIB=16384,e._POOL=[],_(e,["_fixattriInfo",function(){return this._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20]}]),e}()),Yt=function(t){function e(){e.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,4,4),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}r(e,"laya.webgl.utils.MeshTexture",gt);var i=e.prototype;return i.addData=function(t,i,_,r,a,n){for(var s=t.length/2,o=this._vb.needSize(s*e.const_stride)>>2,h=this._vb._floatArray32||this._vb.getFloat32Array(),u=this._vb._uint32Array,l=0,c=0;c<s;c++){var f=t[l],d=t[l+1],E=f*r.a+d*r.c+r.tx,A=f*r.b+d*r.d+r.ty;h[o++]=E,h[o++]=A,h[o++]=i[l],h[o++]=i[l+1],l+=2,u[o++]=a,u[o++]=255}this._vb.setNeedUpload();var D=this.vertNum;if(D>0){var R=_.length;R>e.tmpIdx.length&&(e.tmpIdx=new Uint16Array(R));for(var m=0;m<R;m++)e.tmpIdx[m]=_[m]+D;this._ib.appendU16Array(e.tmpIdx,_.length)}else this._ib.append(_);this._ib.setNeedUpload(),this.vertNum+=s,this.indexNum+=_.length},i.releaseMesh=function(){this._vb.setByteLength(0),this._ib.setByteLength(0),this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},i.destroy=function(){this._ib.destroy(),this._vb.destroy(),this._ib.disposeResource(),this._vb.deleteBuffer()},e.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new e},e.const_stride=24,e._POOL=[],_(e,["_fixattriInfo",function(){return this._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),e}(),Ht=function(t){function e(){e.__super.call(this,laya.webgl.utils.MeshVG.const_stride,4,4),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshVG._fixattriInfo)}r(e,"laya.webgl.utils.MeshVG",gt);var i=e.prototype;return i.addVertAndIBToMesh=function(t,i,_,r){for(var a=this._vb.needSize(i.length/2*e.const_stride)>>2,n=this._vb._floatArray32||this._vb.getFloat32Array(),s=this._vb._uint32Array,o=0,h=i.length/2,u=0;u<h;u++)n[a++]=i[o],n[a++]=i[o+1],o+=2,s[a++]=_;this._vb.setNeedUpload(),this._ib.append(new Uint16Array(r)),this._ib.setNeedUpload(),this.vertNum+=h,this.indexNum+=r.length},i.releaseMesh=function(){this._vb.setByteLength(0),this._ib.setByteLength(0),this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshVG._POOL.push(this)},i.destroy=function(){this._ib.destroy(),this._vb.destroy(),this._ib.disposeResource(),this._vb.deleteBuffer()},e.getAMesh=function(){return laya.webgl.utils.MeshVG._POOL.length?laya.webgl.utils.MeshVG._POOL.pop():new e},e.const_stride=12,e._POOL=[],_(e,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5121,4,8]}]),e}(),Zt=function(e){function i(){this._customRenderCmd=null,this._customCmds=null,this._x=0,this._y=0,this._renderType=0,this._bRepaintCanvas=!1,this._lastContext=null,i.__super.call(this)}r(i,"laya.layagl.ConchSpriteAdpt",C);var a=i.prototype;return a.createData=function(){this._conchData=new ParamData(308,!1),this._datai32=this._conchData._int32Data,this._dataf32=this._conchData._float32Data,this._dataf32[4]=1,this._datai32[3]=-1,this._datai32[1]=0,this._datai32[2]=0,this._datai32[22]=4294967295,this._datai32[5]=1,this._dataf32[8]=0,this._dataf32[9]=0,this._dataf32[10]=1,this._dataf32[11]=1,this._dataf32[16]=1,this._dataf32[17]=0,this._dataf32[18]=0,this._dataf32[19]=1,this._dataf32[20]=0,this._dataf32[21]=0,this._datai32[24]=-1,this._datai32[25]=-1,this._datai32[27]=-1,this._datai32[28]=0,this._datai32[29]=0,this._datai32[30]=1e6,this._datai32[31]=1e6,this._datai32[63]=0,this._datai32[71]=1,this._datai32[72]=771,this._datai32[68]=-1},a._createTransform=function(){return _t.create(new Float32Array(6))},a._setTransform=function(t){var e=this._conchData._float32Data;e[15]=0,e[16]=t.a,e[17]=t.b,e[18]=t.c,e[19]=t.d,e[20]=t.tx,e[21]=t.ty},a._setGraphics=function(t){this._datai32[23]=t._commandEncoder.getPtrID()},a._setGraphicsCallBack=function(){this._callbackFuncObj||(this._callbackFuncObj=new CallbackFuncObj),this._datai32[54]=this._callbackFuncObj.id,this._callbackFuncObj.addCallbackFunc(5,this.updateParticleFromNative.bind(this)),this._datai32[68]=5},a._setCacheAs=function(t){j.createCommandEncoder(),this._drawCanvasParamData||(this._drawCanvasParamData=new ParamData(132,!0)),this._callbackFuncObj||(this._callbackFuncObj=new CallbackFuncObj),this._canvasBeginCmd||(this._canvasBeginCmd=$.instance.createCommandEncoder(128,64,!1)),this._canvasEndCmd||(this._canvasEndCmd=$.instance.createCommandEncoder(128,64,!1)),this._datai32[54]=this._callbackFuncObj.id,this._callbackFuncObj.addCallbackFunc(1,this.canvasBeginRenderFromNative.bind(this)),this._callbackFuncObj.addCallbackFunc(2,this.canvasEndRenderFromNative.bind(this)),this._datai32[56]=1,this._datai32[57]=2,this._datai32[58]=this._canvasBeginCmd.getPtrID(),this._datai32[59]=this._canvasEndCmd.getPtrID(),this._datai32[60]=j._DRAW_CANVAS_CMD_ENCODER_.getPtrID(),this._datai32[61]=this._drawCanvasParamData.getPtrID()},a._setX=function(t){this._x=this._dataf32[6]=t,this._renderType|=2,this._setRenderType(this._renderType),this._dataf32[15]=1},a._setY=function(t){this._y=this._dataf32[7]=t,this._renderType|=2,this._setRenderType(this._renderType),this._dataf32[15]=1},a._setPivotX=function(t){this._renderType|=2,this._dataf32[8]=t,this._dataf32[15]=1},a._getPivotX=function(){return this._dataf32[8]},a._setPivotY=function(t){this._renderType|=2,this._dataf32[9]=t,this._dataf32[15]=1},a._getPivotY=function(){return this._dataf32[9]},a._setAlpha=function(t){this.getStyle().alpha=t,t=(t=t>1?1:t)<0?0:t;var e=this._datai32[22];e=16777215&e|255*t<<24,this._datai32[22]=e,1!==t?this._renderType|=1:this._renderType&=-2,this._setRenderType(this._renderType),this.parentRepaint()},a._setRenderType=function(t){this._datai32[0]=t,et.GLS[t]||et.createByRenderType(t),et.GLSE[t]||et.createByRenderTypeEnd(t)},a.parentRepaint=function(){},a._getAlpha=function(){return(this._datai32[22]>>>24)/255},a._setScaleX=function(t){this._style.scaleX=this._dataf32[10]=t,this._dataf32[15]=1},a._setScaleY=function(t){this._style.scaleY=this._dataf32[11]=t,this._dataf32[15]=1},a._setSkewX=function(t){this._style.skewX=this._dataf32[12]=t,this._dataf32[15]=1},a._setSkewY=function(t){this._style.skewY=this._dataf32[13]=t,this._dataf32[15]=1},a._setRotation=function(t){this._style.rotation=this._dataf32[14]=t,this._dataf32[15]=1},a._setBgStyleColor=function(t,e,i,_,r){var a=null,n=null;this._drawSimpleRectParamData||(this._drawSimpleRectParamData=new ParamData(104,!0)),a=this._drawSimpleRectParamData._float32Data,n=this._drawSimpleRectParamData._int32Data;var s=l.create(r).numColor;n[0]=1,n[1]=96;var o=2;a[o++]=t,a[o++]=e,a[o++]=0,a[o++]=0,n[o++]=s,a[o++]=4294967295,a[o++]=t+i,a[o++]=e,a[o++]=0,a[o++]=0,n[o++]=s,a[o++]=4294967295,a[o++]=t+i,a[o++]=e+_,a[o++]=0,a[o++]=0,n[o++]=s,a[o++]=4294967295,a[o++]=t,a[o++]=e+_,a[o++]=0,a[o++]=0,n[o++]=s,a[o++]=4294967295,this._datai32[74]=this._drawSimpleRectParamData.getPtrID(),$.syncBufferToRenderThread(this._drawSimpleRectParamData),this._datai32[73]=it._SIMPLE_RECT_CMDENCODER_.getPtrID()},a._setBorderStyleColor=function(t,e,i,_,r,a){var n=null,s=null;this._drawRectBorderParamData||(this._drawRectBorderParamData=new ParamData(236,!0)),n=this._drawRectBorderParamData._float32Data,s=this._drawRectBorderParamData._int32Data;var o=[],h=[],u=[];o.push(t),o.push(e),o.push(t+i),o.push(e),o.push(t+i),o.push(e+_),o.push(t),o.push(e+_),o.push(t),o.push(e-a/2),Tt.createLine2(o,h,a,0,u,!1);var c=o.length;n=this._drawRectBorderParamData._float32Data,s=this._drawRectBorderParamData._int32Data;var f=this._drawRectBorderParamData._int16Data,d=l.create(r).numColor;s[0]=0,s[1]=120,s[2]=0,s[3]=2*h.length,s[4]=0;for(var E=5,A=0;A<c;A++)n[E++]=u[2*A],n[E++]=u[2*A+1],s[E++]=d;E=70;for(var D=0;D<h.length;D++)f[E++]=h[D];this._datai32[76]=this._drawRectBorderParamData.getPtrID(),$.syncBufferToRenderThread(this._drawRectBorderParamData),this._datai32[75]=it._RECT_BORDER_CMD_ENCODER_.getPtrID()},a._setTextureEx=function(t,e){var i=null,_=null;if(!this._drawSimpleImageData){this._drawSimpleImageData=new ParamData(116,!0),i=this._drawSimpleImageData._float32Data,(_=this._drawSimpleImageData._int32Data)[0]=3,_[1]=33984,_[2]=e?t.bitmap._glTexture.id:0,_[3]=1,_[4]=96;var r=t.uv;i[5]=0,i[6]=0,i[7]=r[0],i[8]=r[1],_[9]=4294967295,_[10]=4294967295,i[11]=0,i[12]=0,i[13]=r[2],i[14]=r[3],_[15]=4294967295,_[16]=4294967295,i[17]=0,i[18]=0,i[19]=r[4],i[20]=r[5],_[21]=4294967295,_[22]=4294967295,i[23]=0,i[24]=0,i[25]=r[6],i[26]=r[7],_[27]=4294967295,_[28]=4294967295}i=this._drawSimpleImageData._float32Data,(_=this._drawSimpleImageData._int32Data)[2]=e?t.bitmap._glTexture.id:0;var a=e?t.width:0,n=e?t.height:0;i[11]=i[17]=a,i[18]=i[24]=n;var s=this._drawSimpleImageData.getPtrID();this._datai32[25]=s,$.syncBufferToRenderThread(this._drawSimpleImageData),this._datai32[24]=it._SIMPLE_TEXTURE_CMDENCODER_.getPtrID()},a._setTexture=function(t){t&&(t.loaded?this._setTextureEx(t,!0):(this._setTextureEx(t,!1),t.on("loaded",this,this._setTextureEx,[t,!0])))},a._setCustomRender=function(){this._callbackFuncObj||(this._callbackFuncObj=new CallbackFuncObj),this._callbackFuncObj.addCallbackFunc(0,this.customRenderFromNative.bind(this)),this._customRenderCmd=$.instance.createCommandEncoder(128,64,!0),this._datai32[54]=this._callbackFuncObj.id,this._datai32[55]=0,this._datai32[27]=this._customRenderCmd.getPtrID()},a._setScrollRect=function(t){this._dataf32[28]=0,this._dataf32[29]=0,this._dataf32[30]=t.width,this._dataf32[31]=t.height,this._dataf32[32]=-t.x,this._dataf32[33]=-t.y},a._setColorFilter=function(t){this._callbackFuncObj||(this._callbackFuncObj=new CallbackFuncObj),this._filterBeginCmd||(this._filterBeginCmd=$.instance.createCommandEncoder(128,64,!1)),this._filterEndCmd||(this._filterEndCmd=$.instance.createCommandEncoder(128,64,!0)),this._datai32[54]=this._callbackFuncObj.id,this._callbackFuncObj.addCallbackFunc(3,this.filterBeginRenderFromNative.bind(this)),this._callbackFuncObj.addCallbackFunc(4,this.filterEndRenderFromNative.bind(this)),this._datai32[65]=3,this._datai32[64]=this._filterBeginCmd.getPtrID(),this._datai32[67]=4,this._datai32[66]=this._filterEndCmd.getPtrID()},a._setMask=function(t){t.cacheAs="bitmap",this._callbackFuncObj||(this._callbackFuncObj=new CallbackFuncObj),this._maskCmd||(this._maskCmd=$.instance.createCommandEncoder(128,64,!1)),this._datai32[54]=this._callbackFuncObj.id,this._callbackFuncObj.addCallbackFunc(6,this.maskRenderFromNative.bind(this)),this._datai32[69]=6,this._datai32[70]=this._maskCmd.getPtrID()},a._adjustTransform=function(){var e=this._transform||(this._transform=this._createTransform());e._bTransform=!0,t.conch.calcMatrixFromScaleSkewRotation(this._conchData._data._ptrID,60,64,24,28,32,36,40,44,48,52,56);var i=this._conchData._float32Data;return e.a=i[16],e.b=i[17],e.c=i[18],e.d=i[19],e.tx=0,e.ty=0,e},a._setBlendMode=function(t){switch(t){case"normal":this._datai32[71]=1,this._datai32[72]=771;break;case"add":this._datai32[71]=1,this._datai32[72]=772;break;case"multiply":this._datai32[71]=774,this._datai32[72]=771;break;case"screen":case"lighter":this._datai32[71]=1,this._datai32[72]=1;break;case"overlay":this._datai32[71]=1,this._datai32[72]=769;break;case"destination-out":this._datai32[71]=0,this._datai32[72]=0;break;case"mask":this._datai32[71]=0,this._datai32[72]=770;break;default:alert("_setBlendMode Unknown type")}},a.customRenderFromNative=function(){var t=$.instance.getCurrentContext();this._customRenderCmd.beginEncoding(),this._customRenderCmd.clearEncoding(),t._commandEncoder=this._customRenderCmd,t._customCmds=this._customCmds;for(var e=0,i=this._customCmds.length;e<i;e++)this._customCmds[e].recover();this._customCmds.length=0,this.customRender(t,0,0),this._customRenderCmd.endEncoding()},a.canvasBeginRenderFromNative=function(){var t=$.instance,e=null,_=null,r=this._cacheStyle;if(r.canvas&&0==this._datai32[4])e=r.canvas,0!=this._bRepaintCanvas&&(this.setChildrenNativeVisible(!1),this._bRepaintCanvas=!1),this._datai32[63]=1;else{if(this._canvasBeginCmd.beginEncoding(),this._canvasBeginCmd.clearEncoding(),e=laya.layagl.ConchSpriteAdpt.buildCanvas(this,0,0)){this._datai32[63]=0,this._lastContext=t.getCurrentContext();var a=(_=e.context)._targets;j.setParamData(this._drawCanvasParamData,a,-16,-16,a.width,a.height),t.setCurrentContext(_),_.beginRT(),i._tempFloatArrayMatrix[0]=1,i._tempFloatArrayMatrix[1]=0,i._tempFloatArrayMatrix[2]=0,i._tempFloatArrayMatrix[3]=1,i._tempFloatArrayMatrix[4]=16,i._tempFloatArrayMatrix[5]=16,t.setGlobalValue(it.GLOBALVALUE_MATRIX32,8,i._tempFloatArrayMatrix),1!=this._bRepaintCanvas&&(this.setChildrenNativeVisible(!0),this._bRepaintCanvas=!0)}this._canvasBeginCmd.endEncoding()}},a.setChildrenNativeVisible=function(t){for(var e,i=this._children,_=i.length,r=0;r<_;++r)(e=i[r])._datai32[5]=t?1:0,e.setChildrenNativeVisible(t)},a.canvasEndRenderFromNative=function(){var t=$.instance;if(this._canvasEndCmd.beginEncoding(),this._canvasEndCmd.clearEncoding(),this._bRepaintCanvas){var e=$.instance.getCurrentContext();t.setCurrentContext(this._lastContext),t.commitContextToGPU(e),e.endRT(),t.blendFunc(1,771)}this._canvasEndCmd.endEncoding()},a.filterBeginRenderFromNative=function(){var t=$.instance;this._filterBeginCmd.beginEncoding(),this._filterBeginCmd.clearEncoding();var e=this._getCacheStyle().filters;e.length;if(e[0]instanceof laya.filters.ColorFilter){t.addShaderMacro(it.SHADER_MACRO_COLOR_FILTER);var _=e[0];t.setGlobalValue(it.GLOBALVALUE_COLORFILTER_COLOR,8,_._mat),t.setGlobalValue(it.GLOBALVALUE_COLORFILTER_ALPHA,8,_._alpha)}else{var r=M.TEMP,a=p.create(),n=0,s=0;this._isHaveGlowFilter()&&(n=50,s=25);var o=new S;o.copyFrom(this.getSelfBounds()),o.x+=this.x,o.y+=this.y,o.x-=this.pivotX+4,o.y-=this.pivotY+4;var h=o.x,u=o.y;if(o.width+=n+8,o.height+=n+8,r.x=o.x*a.a+o.y*a.c,r.y=o.y*a.d+o.x*a.b,o.x=r.x,o.y=r.y,r.x=o.width*a.a+o.height*a.c,r.y=o.height*a.d+o.width*a.b,o.width=r.x,o.height=r.y,o.width<=0||o.height<=0)return;var l=this._getCacheStyle().filterCache;l&&At.releaseRT(l),l=At.getRT(o.width,o.height),this._getCacheStyle().filterCache=l,i.useRenderTarget(l),i._tempFloatArrayMatrix[0]=1,i._tempFloatArrayMatrix[1]=0,i._tempFloatArrayMatrix[2]=0,i._tempFloatArrayMatrix[3]=1,i._tempFloatArrayMatrix[4]=this.x-h+s,i._tempFloatArrayMatrix[5]=this.y-u+s,t.setGlobalValue(it.GLOBALVALUE_MATRIX32,8,i._tempFloatArrayMatrix)}this._filterBeginCmd.endEncoding()},a.filterEndRenderFromNative=function(){this._filterEndCmd.beginEncoding(),this._filterEndCmd.clearEncoding();var t=$.instance,e=this._getCacheStyle().filters;if(e[0]instanceof laya.filters.ColorFilter);else{t.restore();var _=$.instance.getCurrentContext(),r=ie.currentActive;if(ie.popRT(),e[0]instanceof laya.filters.BlurFilter){t.addShaderMacro(it.SHADER_MACRO_BLUR_FILTER);var a=e[0];i._tempFloatArrayBuffer2[0]=r.width,i._tempFloatArrayBuffer2[1]=r.height,t.setGlobalValue(it.GLOBALVALUE_BLURFILTER_BLURINFO,8,i._tempFloatArrayBuffer2),t.setGlobalValue(it.GLOBALVALUE_BLURFILTER_STRENGTH,8,a.getStrenth_sig2_2sig2_native()),_.drawTarget(this._filterEndCmd,r,-4,-4,0,0)}else if(e[0]instanceof laya.filters.GlowFilter){var n=r.width,s=r.height,o=At.getRT(n,s);i.useRenderTarget(o),t.addShaderMacro(it.SHADER_MACRO_GLOW_FILTER);var h=e[0],u=h.getBlurInfo2Native();u[0]=n,u[1]=s,t.setGlobalValue(it.GLOBALVALUE_GLOWFILTER_COLOR,8,h.getColorNative()),t.setGlobalValue(it.GLOBALVALUE_GLOWFILTER_BLURINFO1,8,h.getBlurInfo1Native()),t.setGlobalValue(it.GLOBALVALUE_GLOWFILTER_BLURINFO2,8,u),_.drawTarget(this._filterEndCmd,r,-16,-16,0,0),t.restore(),ie.popRT(),_.drawTarget(this._filterEndCmd,o,-29,-29,0,0),_.drawTarget(this._filterEndCmd,r,-29,-29,0,0)}}this._filterEndCmd.endEncoding(),$.syncBufferToRenderThread(this._filterEndCmd)},a.maskRenderFromNative=function(){this._maskCmd.beginEncoding(),this._maskCmd.clearEncoding();var t=$.instance,e=t.getCurrentContext(),_=this.mask;_&&(_._children.length>0?(t.blockStart(_._conchData),_._renderChilds(e),t.blockEnd(_._conchData)):t.block(_._conchData)),i._tempInt1[0]=772,t.setGlobalValue(it.GLOBALVALUE_BLENDFUNC_SRC,8,i._tempInt1),i._tempInt1[0]=0,t.setGlobalValue(it.GLOBALVALUE_BLENDFUNC_DEST,8,i._tempInt1),this._maskCmd.endEncoding()},a.updateParticleFromNative=function(){this.tempCmd.updateParticle()},i.createMatrix=function(t,e,i,_,r,a,n){return void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===_&&(_=1),void 0===r&&(r=0),void 0===a&&(a=0),new _t(t,e,i,_,r,a,n)},i.init=function(){Q.__init__(),q.__init__();var t=F.prototype,e=i.prototype,_=["_createTransform","_setTransform","_setGraphics","_setGraphicsCallBack","_setCacheAs","_setX","_setY","_setPivotX","_getPivotX","_setPivotY","_getPivotY","_setAlpha","_getAlpha","_setScaleX","_setScaleY","_setSkewX","_setSkewY","_setRotation","_adjustTransform","_setRenderType","_setTexture","_setTextureEx","_setCustomRender","_setScrollRect","_setColorFilter","customRenderFromNative","canvasBeginRenderFromNative","canvasEndRenderFromNative","setChildrenNativeVisible","filterBeginRenderFromNative","filterEndRenderFromNative","updateParticleFromNative","_setMask","maskRenderFromNative","_setBlendMode","_setBgStyleColor","_setBorderStyleColor"],r=0,a=0;a=_.length;var n;for(r=0;r<a;r++)t[n=_[r]]=e[n];t.createGLBuffer=e.createData,p._createFun=i.createMatrix;t.render=t.renderToNative=$t.prototype.renderToNative,t.repaint=t.repaintForNative=$t.prototype.repaintForNative,t.parentRepaint=t.parentRepaintForNative=$t.prototype.parentRepaintForNative,t._renderChilds=$t.prototype._renderChilds},i.useRenderTarget=function(t){var e=$.instance;ie.pushRT(),t.start(),e.clearColor(0,0,0,0),e.clear(17664),e.save(),i._tempFloatArrayBuffer2[0]=t.width,i._tempFloatArrayBuffer2[1]=t.height,e.setGlobalValue(it.GLOBALVALUE_VIEWS,8,i._tempFloatArrayBuffer2)},i.buildCanvas=function(t,e,i){var _,r,a,n,s,o,h,u=t._cacheStyle,l=u.canvas,c=u.cacheAs;return h=u._calculateCacheRect(t,c,e,i),s=h.x,o=h.y,r=u.cacheRect,a=r.width*s,n=r.height*o,r.x,r.y,"bitmap"===c&&(a>2048||n>2048)?(console.warn("cache bitmap size larger than 2048,cache ignored"),u.releaseContext(),null):(l||(u.createContext(),l=u.canvas),_=l.context,l.context.sprite=t,l.width==a&&l.height==n||(l.size(a,n),_._targets&&(_._targets.destroy(),_._targets=null)),"bitmap"===c?l.context.asBitmap=!0:"normal"===c&&(l.context.asBitmap=!1),"normal"===c&&(_.touches=[]),l)},_(i,["_tempFloatArrayBuffer2",function(){return this._tempFloatArrayBuffer2=new Float32Array(2)},"_tempFloatArrayMatrix",function(){return this._tempFloatArrayMatrix=new Float32Array(6)},"_tempInt1",function(){return this._tempInt1=new Int32Array(1)}]),i}(),jt=function(t){function e(){e.__super.call(this)}return r(e,"laya.webgl.shader.BaseShader",L),e.activeShader=null,e.bindShader=null,e}(),Kt=function(t){function e(t,i,_){this.texture=null,this._source=null,this._used=null,this._startFindPos=0,this._texW=0,this._texH=0,this._gridNum=0,this.charMaps=[],this._score=0,this._scoreTick=0,this.__destroyed=!1,this._discardTm=0,e.__super.call(this),this._texW=t,this._texH=i,this._gridNum=_,this.texture=new ct(this),this.setGridNum(_),this.lock=!0}r(e,"laya.webgl.resource.CharPageTexture",L);var _=e.prototype;return _.findAGrid=function(){for(var t=this._startFindPos;t<this._gridNum;t++)if(0==this._used[t])return this._startFindPos=t+1,this._used[t]=1,t;return-1},_.removeGrid=function(t){this._used[t]=0,t<this._startFindPos&&(this._startFindPos=t)},_.removeOld=function(t){for(var e=0,i=null,_=0,r=this.charMaps.length;_<r;_++)if(i=this.charMaps[_]){var a=this;i.forEach(function(i,_,r){i&&i.touchTick<t&&(console.log("remove char "+_),a.removeGrid(i.pos),r.delete(_),e++)})}return e},_.reset=function(){this._discardTm=i.stage.getFrameTm(),this._startFindPos=0,this.charMaps=[],this._score=0,this._scoreTick=0,this.__destroyed=!0},_.setGridNum=function(t){if(this._used&&this._used.length==this._gridNum)if(this._used.fill)this._used.fill(0);else for(var e=0;e<this._used.length;e++)this._used[e]=0;else this._used=new Uint8Array(t)},_.recreateResource=function(){if(!this._source){var t=g.isConchApp?$.instance.getDefaultCommandEncoder():bt.mainContext,e=this._source=t.createTexture();this.texture.bitmap._glTexture=this._source,Bt.bindTexture(t,3553,e),t.texImage2D(3553,0,6408,this._texW,this._texH,0,6408,5121,null),t.texParameteri(3553,10241,9729),t.texParameteri(3553,10240,9729),t.texParameteri(3553,10242,33071),t.texParameteri(3553,10243,33071)}},_.addChar=function(t,e,i){!this._source&&this.recreateResource();var _=g.isConchApp?$.instance.getDefaultCommandEncoder():bt.mainContext;Bt.bindTexture(_,3553,this._source),!g.isConchApp&&_.pixelStorei(37441,!0);var r=t.data;t.data instanceof Uint8ClampedArray&&(r=new Uint8Array(r.buffer)),_.texSubImage2D(3553,0,e,i,t.width,t.height,6408,5121,r),!g.isConchApp&&_.pixelStorei(37441,!1)},_.destroy=function(){console.log("destroy CharPageTexture"),this.__destroyed=!0;var t=g.isConchApp?$.instance.getDefaultCommandEncoder():bt.mainContext;this._source&&t.deleteTexture(this._source),this._source=null},e}(),Qt=function(t){function e(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,e.__super.call(this),this._glBuffer=$.instance.createBuffer()}r(e,"laya.webgl.utils.Buffer",L);var i=e.prototype;return i._bindForVAO=function(){},i.bind=function(){return!1},i._disposeResource=function(){this._glBuffer&&($.instance.deleteBuffer(this._glBuffer),this._glBuffer=null),this._setGPUMemory(0)},a(0,i,"bufferUsage",function(){return this._bufferUsage}),e._bindedVertexBuffer=null,e._bindedIndexBuffer=null,e}(),qt=function(t){function e(t){e.__super.call(this,64),this.defines.add(64)}r(e,"laya.webgl.shader.d2.value.TextSV",t);var i=e.prototype;return i.release=function(){e.pool[e._length++]=this,this.clear()},i.clear=function(){t.prototype.clear.call(this)},e.create=function(){return e._length?e.pool[--e._length]:new e(null)},e.pool=[],e._length=0,e}(Vt),$t=function(t){function e(){e.__super.call(this)}r(e,"laya.layagl.ConchSprite",F);var i=e.prototype;return i.parentRepaintForNative=function(t){void 0===t&&(t=2);var e=this._parent;e&&(e._conchData._int32Data[4]&t)!=t&&(e._conchData._int32Data[4]|=t,e.parentRepaintForNative(t))},i.renderToNative=function(t,e,i){var _=t.gl,r=$.getFrameCount()-1,a=this._conchData._int32Data,n=a[4];this._children.length>0?r!=a[3]||n>0&&1==(1&n)?(_.blockStart(this._conchData),this._renderChilds(t),_.blockEnd(this._conchData)):_.copyCmdBuffer(this._conchData._int32Data[1],this._conchData._int32Data[2]):_.block(this._conchData)},i._renderChilds=function(t){var e,i=this._children,_=0,r=i.length,a=this._style;if(a.viewport)for(var n=a.viewport,s=n.x,o=n.y,h=n.right,u=n.bottom,l=NaN,c=NaN;_<r;++_)(e=i[_])._visible&&(l=e._x)<h&&l+e.width>s&&(c=e._y)<u&&c+e.height>o&&e.renderToNative(t);else for(;_<r;++_)(e=i[_])._visible&&e.renderToNative(t)},i.repaintForNative=function(t){void 0===t&&(t=2),(this._conchData._int32Data[4]&t)!=t&&(this._conchData._int32Data[4]|=t,this.parentRepaintForNative(t))},e}(),Jt=function(t){function e(t,i){e.__super.call(this),this._wrapModeU=0,this._wrapModeV=0,this._filterMode=1,this._readyed=!1,this._width=-1,this._height=-1,this._format=t,this._mipmap=i,this._anisoLevel=1,this._glTexture=$.instance.createTexture()}r(e,"laya.webgl.resource.BaseTexture",s);var i=e.prototype;return i._isPot=function(t){return 0==(t&t-1)},i._getGLFormat=function(){var t=0;switch(this._format){case 0:t=6407;break;case 1:t=6408;break;case 2:t=6406;break;case 3:if(!Bt._compressedTextureS3tc)throw"BaseTexture: not support DXT1 format.";t=Bt._compressedTextureS3tc.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case 4:if(!Bt._compressedTextureS3tc)throw"BaseTexture: not support DXT5 format.";t=Bt._compressedTextureS3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;case 5:if(!Bt._compressedTextureEtc1)throw"BaseTexture: not support ETC1RGB format.";t=Bt._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL;break;case 9:if(!Bt._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGB_2BPPV format.";t=Bt._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 10:if(!Bt._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGBA_2BPPV format.";t=Bt._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;break;case 11:if(!Bt._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGB_4BPPV format.";t=Bt._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case 12:if(!Bt._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGBA_4BPPV format.";t=Bt._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;default:throw"BaseTexture: unknown texture format."}return t},i._setFilterMode=function(t){var e=$.instance;switch(Bt.bindTexture(e,this._glTextureType,this._glTexture),t){case 0:this._mipmap&&this._isPot(this._width)&&this._isPot(this._height)?e.texParameteri(this._glTextureType,10241,9984):e.texParameteri(this._glTextureType,10241,9728),e.texParameteri(this._glTextureType,10240,9728);break;case 1:this._mipmap&&this._isPot(this._width)&&this._isPot(this._height)?e.texParameteri(this._glTextureType,10241,9985):e.texParameteri(this._glTextureType,10241,9729),e.texParameteri(this._glTextureType,10240,9729);break;case 2:this._mipmap&&this._isPot(this._width)&&this._isPot(this._height)?e.texParameteri(this._glTextureType,10241,9987):e.texParameteri(this._glTextureType,10241,9729),e.texParameteri(this._glTextureType,10240,9729);break;default:throw new Error("BaseTexture:unknown filterMode value.")}},i._setWarpMode=function(t,e){var i=$.instance;if(Bt.bindTexture(i,this._glTextureType,this._glTexture),this._isPot(this._width)&&this._isPot(this._height))switch(e){case 0:i.texParameteri(this._glTextureType,t,10497);break;case 1:i.texParameteri(this._glTextureType,t,33071)}else i.texParameteri(this._glTextureType,t,33071)},i._setAnisotropy=function(t){t=Math.max(t,1);var e=$.instance;Bt.bindTexture(e,this._glTextureType,this._glTexture);var i=Bt._extTextureFilterAnisotropic;i&&(t=Math.min(e.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT),t),e.texParameterf(this._glTextureType,i.TEXTURE_MAX_ANISOTROPY_EXT,t))},i._disposeResource=function(){this._glTexture&&($.instance.deleteTexture(this._glTexture),this._glTexture=null,this._setGPUMemory(0))},i._getSource=function(){return this._readyed?this._glTexture:null},i._getGLFormatForNative=function(){return 6408},a(0,i,"wrapModeU",function(){return this._wrapModeU},function(t){this._wrapModeU!==t&&(this._wrapModeU=t,-1!==this._width&&this._setWarpMode(10242,t))}),a(0,i,"mipmap",function(){return this._mipmap}),a(0,i,"format",function(){return this._format}),a(0,i,"wrapModeV",function(){return this._wrapModeV},function(t){this._wrapModeV!==t&&(this._wrapModeV=t,-1!==this._height&&this._setWarpMode(10243,t))}),a(0,i,"defaulteTexture",function(){throw"BaseTexture:must override it."}),a(0,i,"filterMode",function(){return this._filterMode},function(t){t!==this._filterMode&&(this._filterMode=t,-1!==this._width&&-1!==this._height&&this._setFilterMode(t))}),a(0,i,"anisoLevel",function(){return this._anisoLevel},function(t){t!==this._anisoLevel&&(this._anisoLevel=Math.max(1,Math.min(16,t)),-1!==this._width&&-1!==this._height&&this._setAnisotropy(t))}),e.WARPMODE_REPEAT=0,e.WARPMODE_CLAMP=1,e.FILTERMODE_POINT=0,e.FILTERMODE_BILINEAR=1,e.FILTERMODE_TRILINEAR=2,e.FORMAT_R8G8B8=0,e.FORMAT_R8G8B8A8=1,e.FORMAT_ALPHA8=2,e.FORMAT_DXT1=3,e.FORMAT_DXT5=4,e.FORMAT_ETC1RGB=5,e.FORMAT_PVRTCRGB_2BPPV=9,e.FORMAT_PVRTCRGBA_2BPPV=10,e.FORMAT_PVRTCRGB_4BPPV=11,e.FORMAT_PVRTCRGBA_4BPPV=12,e.FORMAT_DEPTH_16=0,e.FORMAT_STENCIL_8=1,e.FORMAT_DEPTHSTENCIL_16_8=2,e.FORMAT_DEPTHSTENCIL_NONE=3,e}(),te=function(t){function e(t,i,_,r,a){if(this._attribInfo=null,this.customCompile=!1,this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},e.__super.call(this),!t||!i)throw"Shader Error";this._attribInfo=a,g.isConchApp&&(this.customCompile=!0),this._id=++e._count,this._vs=t,this._ps=i,this._nameMap=r||{},null!=_&&(e.sharders[_]=this),this.recreateResource(),this.lock=!0}r(e,"laya.webgl.shader.Shader",jt);var i=e.prototype;return i.recreateResource=function(){this._compile(),this._setGPUMemory(0)},i._disposeResource=function(){bt.mainContext.deleteShader(this._vshader),bt.mainContext.deleteShader(this._pshader),bt.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this._setGPUMemory(0),this._curActTexIndex=0},i._compile=function(){if(this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var t;this.customCompile&&(t=Lt.preGetParams(this._vs,this._ps));var i=bt.mainContext;this._program=i.createProgram(),this._vshader=e._createShader(i,this._vs,35633),this._pshader=e._createShader(i,this._ps,35632),i.attachShader(this._program,this._vshader),i.attachShader(this._program,this._pshader);var _,r=0,a=0,n=this._attribInfo?this._attribInfo.length:0;for(r=0;r<n;r+=2)i.bindAttribLocation(this._program,this._attribInfo[r+1],this._attribInfo[r]);if(i.linkProgram(this._program),!this.customCompile&&!i.getProgramParameter(this._program,35714))throw i.getProgramInfoLog(this._program);var s=this.customCompile?t.uniforms.length:i.getProgramParameter(this._program,35718);for(r=0;r<s;r++){var o=this.customCompile?t.uniforms[r]:i.getActiveUniform(this._program,r);(_={vartype:"uniform",glfun:null,ivartype:1,location:i.getUniformLocation(this._program,o.name),name:o.name,type:o.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")>0&&(_.name=_.name.substr(0,_.name.length-3),_.isArray=!0,_.location=i.getUniformLocation(this._program,_.name)),this._params.push(_)}for(r=0,a=this._params.length;r<a;r++)switch(_=this._params[r],_.indexOfParams=r,_.index=1,_.value=[_.location,null],_.codename=_.name,_.name=this._nameMap[_.codename]?this._nameMap[_.codename]:_.codename,this._paramsMap[_.name]=_,_._this=this,_.uploadedValue=[],_.type){case 5124:_.fun=_.isArray?this._uniform1iv:this._uniform1i;break;case 5126:_.fun=_.isArray?this._uniform1fv:this._uniform1f;break;case 35664:_.fun=_.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:_.fun=_.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:_.fun=_.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:_.fun=this._uniform_sampler2D;break;case 35680:_.fun=this._uniform_samplerCube;break;case 35676:_.glfun=i.uniformMatrix4fv,_.fun=this._uniformMatrix4fv;break;case 35670:_.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}}},i.getUniform=function(t){return this._paramsMap[t]},i._uniform1f=function(t,e){var i=t.uploadedValue;return i[0]!==e?(bt.mainContext.uniform1f(t.location,i[0]=e),1):0},i._uniform1fv=function(t,e){if(e.length<4){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(bt.mainContext.uniform1fv(t.location,e),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],1):0}return bt.mainContext.uniform1fv(t.location,e),1},i._uniform_vec2=function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]?(bt.mainContext.uniform2f(t.location,i[0]=e[0],i[1]=e[1]),1):0},i._uniform_vec2v=function(t,e){if(e.length<2){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(bt.mainContext.uniform2fv(t.location,e),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],1):0}return bt.mainContext.uniform2fv(t.location,e),1},i._uniform_vec3=function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]?(bt.mainContext.uniform3f(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2]),1):0},i._uniform_vec3v=function(t,e){return bt.mainContext.uniform3fv(t.location,e),1},i._uniform_vec4=function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(bt.mainContext.uniform4f(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]),1):0},i._uniform_vec4v=function(t,e){return bt.mainContext.uniform4fv(t.location,e),1},i._uniformMatrix2fv=function(t,e){return bt.mainContext.uniformMatrix2fv(t.location,!1,e),1},i._uniformMatrix3fv=function(t,e){return bt.mainContext.uniformMatrix3fv(t.location,!1,e),1},i._uniformMatrix4fv=function(t,e){return bt.mainContext.uniformMatrix4fv(t.location,!1,e),1},i._uniform1i=function(t,e){var i=t.uploadedValue;return i[0]!==e?(bt.mainContext.uniform1i(t.location,i[0]=e),1):0},i._uniform1iv=function(t,e){return bt.mainContext.uniform1iv(t.location,e),1},i._uniform_ivec2=function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]?(bt.mainContext.uniform2i(t.location,i[0]=e[0],i[1]=e[1]),1):0},i._uniform_ivec2v=function(t,e){return bt.mainContext.uniform2iv(t.location,e),1},i._uniform_vec3i=function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]?(bt.mainContext.uniform3i(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2]),1):0},i._uniform_vec3vi=function(t,e){return bt.mainContext.uniform3iv(t.location,e),1},i._uniform_vec4i=function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(bt.mainContext.uniform4i(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]),1):0},i._uniform_vec4vi=function(t,e){return bt.mainContext.uniform4iv(t.location,e),1},i._uniform_sampler2D=function(t,e){var i=bt.mainContext,_=t.uploadedValue;return null==_[0]?(_[0]=this._curActTexIndex,i.uniform1i(t.location,this._curActTexIndex),Bt.activeTexture(i,33984+this._curActTexIndex),Bt.bindTexture(i,3553,e),this._curActTexIndex++,1):(Bt.activeTexture(i,33984+_[0]),Bt.bindTexture(i,3553,e),0)},i._uniform_samplerCube=function(t,e){var i=bt.mainContext,_=t.uploadedValue;return null==_[0]?(_[0]=this._curActTexIndex,i.uniform1i(t.location,this._curActTexIndex),Bt.activeTexture(i,33984+this._curActTexIndex),Bt.bindTexture(i,34067,e),this._curActTexIndex++,1):(Bt.activeTexture(i,33984+_[0]),Bt.bindTexture(i,34067,e),0)},i._noSetValue=function(t){console.log("no....:"+t.name)},i.uploadOne=function(t,e){Bt.useProgram(bt.mainContext,this._program);var i=this._paramsMap[t];i.fun.call(this,i,e)},i.uploadTexture2D=function(t){var e=Bt;e._activeTextures[0]!==t&&(e.bindTexture(bt.mainContext,e.TEXTURE_2D,t),e._activeTextures[0]=t)},i.upload=function(t,e){jt.activeShader=jt.bindShader=this;var i=bt.mainContext;Bt.useProgram(i,this._program),this._reCompile?(e=this._params,this._reCompile=!1):e=e||this._params;for(var _,r,a=e.length,n=0,s=0;s<a;s++)null!==(r=t[(_=e[s]).name])&&(n+=_.fun.call(this,_,r));V.shaderCall+=n},i.uploadArray=function(t,e,i){jt.activeShader=this,jt.bindShader=this,Bt.useProgram(bt.mainContext,this._program);this._params;for(var _,r,a=0,n=e-2;n>=0;n-=2)(r=this._paramsMap[t[n]])&&null!=(_=t[n+1])&&(i&&i[r.name]&&i[r.name].bind(),a+=r.fun.call(this,r,_));V.shaderCall+=a},i.getParams=function(){return this._params},i.setAttributesLocation=function(t){this._attribInfo=t},e.getShader=function(t){return e.sharders[t]},e.create=function(t,i,_,r,a){return new e(t,i,_,r,a)},e.withCompile=function(t,i,_,r){if(_&&e.sharders[_])return e.sharders[_];var a=e._preCompileShader[2e-4*t];if(!a)throw new Error("withCompile shader err!"+t);return a.createShader(i,_,r,null)},e.withCompile2D=function(t,i,_,r,a,n){if(r&&e.sharders[r])return e.sharders[r];var s=e._preCompileShader[2e-4*t+i];if(!s)throw new Error("withCompile shader err!"+t+" "+i);return s.createShader(_,r,a,n)},e.addInclude=function(t,e){Lt.addInclude(t,e)},e.preCompile=function(t,i,_,r){e._preCompileShader[2e-4*t]=new Lt(i,_,r)},e.preCompile2D=function(t,i,_,r,a){e._preCompileShader[2e-4*t+i]=new Lt(_,r,a)},e._createShader=function(t,e,i){var _=t.createShader(i);return t.shaderSource(_,e),t.compileShader(_),t.getShaderParameter(_,35713)?_:(console.log(t.getShaderInfoLog(_)),null)},e._count=0,e._preCompileShader={},e.SHADERNAME2ID=2e-4,e.sharders=new Array(32),_(e,["nameKey",function(){return this.nameKey=new U}]),e}(),ee=function(t){function e(){this._maxsize=0,this._upload=!0,this._uploadSize=0,this._bufferSize=0,this._u8Array=null,e.__super.call(this),this.lock=!0}r(e,"laya.webgl.utils.Buffer2D",t);var i=e.prototype;return i.setByteLength=function(t){this._byteLength!==t&&(t<=this._bufferSize||this._resizeBuffer(2*t+256,!0),this._byteLength=t)},i.needSize=function(t){var e=this._byteLength;if(t){var i=this._byteLength+t;i<=this._bufferSize||this._resizeBuffer(i<<1,!0),this._byteLength=i}return e},i._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),V.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this._setGPUMemory(this._buffer.byteLength),this._buffer=this._buffer.slice(0,this._maxsize+64),this._bufferSize=this._buffer.byteLength,this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this._setGPUMemory(this._uploadSize)),$.instance.bufferSubData(this._bufferType,0,this._buffer)},i._bufferSubData=function(t,e,i){if(void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this._maxsize=Math.max(this._maxsize,this._byteLength),V.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this._setGPUMemory(this._buffer.byteLength),this._buffer=this._buffer.slice(0,this._maxsize+64),this._bufferSize=this._buffer.byteLength,this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this._setGPUMemory(this._uploadSize)),e||i){var _=this._buffer.slice(e,i);$.instance.bufferSubData(this._bufferType,t,_)}else $.instance.bufferSubData(this._bufferType,t,this._buffer)},i._checkArrayUse=function(){},i._bind_uploadForVAO=function(){return!!this._upload&&(this._upload=!1,this._bindForVAO(),this._bufferData(),!0)},i._bind_upload=function(){return!!this._upload&&(this._upload=!1,this.bind(),this._bufferData(),!0)},i._bind_subUpload=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),!!this._upload&&(this._upload=!1,this.bind(),this._bufferSubData(t,e,i),!0)},i._resizeBuffer=function(t,e){if(t<this._buffer.byteLength)return this;if(this._setGPUMemory(t),e&&this._buffer&&this._buffer.byteLength>0){var i=new ArrayBuffer(t),_=this._u8Array&&this._u8Array.buffer==this._buffer?this._u8Array:new Uint8Array(this._buffer);this._u8Array=new Uint8Array(i),this._u8Array.set(_,0),this._buffer=i}else this._buffer=new ArrayBuffer(t);return this._checkArrayUse(),this._upload=!0,this._bufferSize=this._buffer.byteLength,this},i.append=function(t){this._upload=!0;var e,i=0;i=t.byteLength,t instanceof Uint8Array?(this._resizeBuffer(this._byteLength+i,!0),e=new Uint8Array(this._buffer,this._byteLength)):t instanceof Uint16Array?(this._resizeBuffer(this._byteLength+i,!0),e=new Uint16Array(this._buffer,this._byteLength)):t instanceof Float32Array&&(this._resizeBuffer(this._byteLength+i,!0),e=new Float32Array(this._buffer,this._byteLength)),e.set(t,0),this._byteLength+=i,this._checkArrayUse()},i.appendU16Array=function(t,e){this._resizeBuffer(this._byteLength+2*e,!0);for(var i=new Uint16Array(this._buffer,this._byteLength,e),_=0;_<e;_++)i[_]=t[_];this._byteLength+=2*e,this._checkArrayUse()},i.appendEx=function(t,e){this._upload=!0;var i=0;i=t.byteLength,this._resizeBuffer(this._byteLength+i,!0),new e(this._buffer,this._byteLength).set(t,0),this._byteLength+=i,this._checkArrayUse()},i.appendEx2=function(t,e,i,_){void 0===_&&(_=1),this._upload=!0;var r,a=0;a=i*_,this._resizeBuffer(this._byteLength+a,!0),r=new e(this._buffer,this._byteLength);var n=0;for(n=0;n<i;n++)r[n]=t[n];this._byteLength+=a,this._checkArrayUse()},i.getBuffer=function(){return this._buffer},i.setNeedUpload=function(){this._upload=!0},i.getNeedUpload=function(){return this._upload},i.upload=function(){var t=this._bind_upload();return $.instance.bindBuffer(this._bufferType,null),34962==this._bufferType&&(Qt._bindedVertexBuffer=null),34963==this._bufferType&&(Qt._bindedIndexBuffer=null),jt.activeShader=null,t},i.subUpload=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0);var _=this._bind_subUpload();return $.instance.bindBuffer(this._bufferType,null),34962==this._bufferType&&(Qt._bindedVertexBuffer=null),34963==this._bufferType&&(Qt._bindedIndexBuffer=null),jt.activeShader=null,_},i._disposeResource=function(){t.prototype._disposeResource.call(this),this._upload=!0,this._uploadSize=0},i.clear=function(){this._byteLength=0,this._upload=!0},a(0,i,"bufferLength",function(){return this._buffer.byteLength}),a(0,i,"byteLength",null,function(t){this.setByteLength(t)}),e.__int__=function(t){},e.FLOAT32=4,e.SHORT=2,e}(Qt),ie=function(t){function e(t,i,_,r){this._mgrKey=0,void 0===_&&(_=0),void 0===r&&(r=0),e.__super.call(this,_,!1),this._glTextureType=3553,this._width=t,this._height=i,this._depthStencilFormat=r,this._create(t,i)}r(e,"laya.webgl.resource.RenderTexture2D",Jt);var i=e.prototype;return i._create=function(t,e){var i=$.instance;this._frameBuffer=i.createFramebuffer(),Bt.bindTexture(i,this._glTextureType,this._glTexture);var _=this._getGLFormat();if(i.texImage2D(this._glTextureType,0,_,t,e,0,_,5121,null),this._setGPUMemory(t*e*4),i.bindFramebuffer(36160,this._frameBuffer),i.framebufferTexture2D(36160,36064,3553,this._glTexture,0),3!==this._depthStencilFormat)switch(this._depthStencilBuffer=i.createRenderbuffer(),i.bindRenderbuffer(36161,this._depthStencilBuffer),this._depthStencilFormat){case 0:i.renderbufferStorage(36161,33189,t,e),i.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 1:i.renderbufferStorage(36161,36168,t,e),i.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 2:i.renderbufferStorage(36161,34041,t,e),i.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer);break;default:console.log("RenderTexture: unkonw depth format.")}i.bindFramebuffer(36160,null),i.bindRenderbuffer(36161,null),this._setWarpMode(10242,this._wrapModeU),this._setWarpMode(10243,this._wrapModeV),this._setFilterMode(this._filterMode),this._setAnisotropy(this._anisoLevel),this._readyed=!0,this._activeResource()},i.generateMipmap=function(){this._isPot(this.width)&&this._isPot(this.height)?(this._mipmap=!0,$.instance.generateMipmap(this._glTextureType),this._setFilterMode(this._filterMode),this._setGPUMemory(this.width*this.height*4*(1+1/3))):(this._mipmap=!1,this._setGPUMemory(this.width*this.height*4))},i.start=function(){var t=$.instance;$.instance.bindFramebuffer(36160,this._frameBuffer),e._currentActive=this,this._readyed=!0,t.viewport(0,0,this._width,this._height),this._lastWidth=yt.width,this._lastHeight=yt.height,yt.width=this._width,yt.height=this._height,jt.activeShader=null},i.end=function(){$.instance.bindFramebuffer(36160,null),e._currentActive=null,this._readyed=!0},i.restore=function(){var t=$.instance;this._lastRT!=e._currentActive&&($.instance.bindFramebuffer(36160,this._lastRT?this._lastRT._frameBuffer:null),e._currentActive=this._lastRT),this._readyed=!0,t.viewport(0,0,this._lastWidth,this._lastHeight),yt.width=this._lastWidth,yt.height=this._lastHeight,jt.activeShader=null},i.clear=function(t,e,i,_){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===_&&(_=1);var r=$.instance;r.clearColor(t,e,i,_);var a=16384;switch(this._depthStencilFormat){case 33189:a|=256;break;case 36168:a|=1024;break;case 34041:a|=256,a|=1024}r.clear(a)},i.getData=function(t,e,i,_){var r=$.instance;r.bindFramebuffer(36160,this._frameBuffer);if(!(36053===r.checkFramebufferStatus(36160)))return r.bindFramebuffer(36160,null),null;var a=new Uint8Array(this._width*this._height*4),n=this._getGLFormat();return r.readPixels(t,e,i,_,n,5121,a),r.bindFramebuffer(36160,null),a},i._disposeResource=function(){if(this._frameBuffer){var t=$.instance;t.deleteTexture(this._glTexture),t.deleteFramebuffer(this._frameBuffer),t.deleteRenderbuffer(this._depthStencilBuffer),this._glTexture=null,this._frameBuffer=null,this._depthStencilBuffer=null,this._setGPUMemory(0)}},a(0,i,"depthStencilFormat",function(){return this._depthStencilFormat}),a(0,i,"defaulteTexture",function(){return _e.grayTexture}),a(1,e,"currentActive",function(){return e._currentActive},laya.webgl.resource.BaseTexture._$SET_currentActive),e.pushRT=function(){e.rtStack.push({rt:e._currentActive,w:yt.width,h:yt.height})},e.popRT=function(){var t=$.instance,i=e.rtStack.pop();i&&(e._currentActive!=i.rt&&($.instance.bindFramebuffer(36160,i.rt?i.rt._frameBuffer:null),e._currentActive=i.rt),t.viewport(0,0,i.w,i.h),yt.width=i.w,yt.height=i.h)},e._currentActive=null,e.rtStack=[],_(e,["defuv",function(){return this.defuv=[0,0,1,0,1,1,0,1]},"flipyuv",function(){return this.flipyuv=[0,1,1,1,1,0,0,0]}]),e}(),_e=function(t){function e(t,i,_,r,a){void 0===t&&(t=0),void 0===i&&(i=0),void 0===_&&(_=1),void 0===r&&(r=!0),void 0===a&&(a=!1),e.__super.call(this,_,r),this._glTextureType=3553,this._width=t,this._height=i,this._canRead=a,this._setWarpMode(10242,this._wrapModeU),this._setWarpMode(10243,this._wrapModeV),this._setFilterMode(this._filterMode),this._setAnisotropy(this._anisoLevel)}r(e,"laya.webgl.resource.Texture2D",Jt);var _=e.prototype;return _._calcualatesCompressedDataSize=function(t,e,i){switch(t){case 3:case 5:return(e+3>>2)*(i+3>>2)*8;case 4:return(e+3>>2)*(i+3>>2)*16;case 11:case 12:return Math.floor((Math.max(e,8)*Math.max(i,8)*4+7)/8);case 9:case 10:return Math.floor((Math.max(e,16)*Math.max(i,8)*2+7)/8);default:return 0}},_._pharseDDS=function(t){var e=new Int32Array(t,0,31);if(542327876!=e[0])throw"Invalid magic number in DDS header";if(!(4&e[20]))throw"Unsupported format, must contain a FourCC code";var i=e[21];switch(this._format){case 3:if(827611204!==i)throw"the FourCC code is not same with texture format.";break;case 4:if(894720068!==i)throw"the FourCC code is not same with texture format.";break;default:throw"unknown texture format."}var _=1;if(131072&e[2]){if(_=Math.max(1,e[7]),!this._mipmap)throw"the mipmap is not same with Texture2D."}else if(this._mipmap)throw"the mipmap is not same with Texture2D.";var r=e[4],a=e[3];if(this._width!==r||this._height!==a)throw"the width or height is not same with Texture2D.";var n=e[1]+4;this._upLoadCompressedTexImage2D(t,r,a,_,n,0)},_._pharseKTX=function(t){var e=new Uint8Array(t,0,12);if(171!=e[0]||75!=e[1]||84!=e[2]||88!=e[3]||32!=e[4]||49!=e[5]||49!=e[6]||187!=e[7]||13!=e[8]||10!=e[9]||26!=e[10]||10!=e[11])throw"Invalid fileIdentifier in KTX header";var i=new Int32Array(e.buffer,e.length,13),_=i[4],r=this._getGLFormat();switch(this._format){case 5:if(_!==r)throw"the format  is not same with texture format FORMAT_ETC1RGB.";break;default:throw"unknown texture format."}var a=i[11],n=i[6],s=i[7];if(this._width!==n||this._height!==s)throw"the width or height is not same with Texture2D.";var o=64+i[12];this._upLoadCompressedTexImage2D(t,n,s,a,o,4)},_._pharsePVR=function(t){var e=new Int32Array(t,0,13);if(55727696!=e[0])throw"Invalid magic number in PVR header";var i=e[2];switch(this._format){case 5:if(6!==i)throw"the format  is not same with texture format FORMAT_ETC1RGB.";break;case 9:if(0!==i)throw"the format  is not same with texture format FORMAT_PVRTCRGB_2BPPV.";break;case 11:if(2!==i)throw"the format  is not same with texture format FORMAT_PVRTCRGB_4BPPV.";break;case 10:if(1!==i)throw"the format  is not same with texture format FORMAT_PVRTCRGBA_2BPPV.";break;case 12:if(3!==i)throw"the format  is not same with texture format FORMAT_PVRTCRGBA_4BPPV.";break;default:throw"unknown texture format."}var _=e[11],r=e[7],a=e[6];if(this._width!==r||this._height!==a)throw"the width or height is not same with Texture2D.";var n=e[12]+52;this._upLoadCompressedTexImage2D(t,r,a,_,n,0)},_._upLoadCompressedTexImage2D=function(t,e,i,_,r,a){var n=$.instance,s=this._glTextureType;Bt.bindTexture(n,s,this._glTexture);for(var o=this._getGLFormat(),h=r,u=0;u<_;u++){h+=a;var l=this._calcualatesCompressedDataSize(this._format,e,i),c=new Uint8Array(t,h,l);n.compressedTexImage2D(s,u,o,e,i,0,c),e>>=1,i>>=1,h+=l}var f=h;this._setGPUMemory(f),this._readyed=!0,this._activeResource()},_.loadImageSource=function(t,e){void 0===e&&(e=!1);var i=t.width,_=t.height;this._width=i,this._height=_,this._setWarpMode(10242,this._wrapModeU),this._setWarpMode(10243,this._wrapModeV),this._setFilterMode(this._filterMode);var r=$.instance;Bt.bindTexture(r,this._glTextureType,this._glTexture);var a=this._getGLFormat();g.isConchApp?(t.setPremultiplyAlpha(e),r.texImage2D(this._glTextureType,0,6408,6408,5121,t)):(e&&r.pixelStorei(37441,!0),r.texImage2D(this._glTextureType,0,a,a,5121,t),e&&r.pixelStorei(37441,!1)),this._mipmap&&this._isPot(i)&&this._isPot(_)?(r.generateMipmap(this._glTextureType),this._setGPUMemory(i*_*4*(1+1/3))):this._setGPUMemory(i*_*4),this._canRead&&(g.isConchApp?this._pixels=t._nativeObj.getImageData(0,0,i,_):(h.canvas.size(i,_),h.canvas.clear(),h.context.drawImage(t,0,0,i,_),this._pixels=new Uint8Array(h.context.getImageData(0,0,i,_).data.buffer))),this._readyed=!0,this._activeResource()},_.setPixels=function(t,e){if(void 0===e&&(e=0),!t)throw"Texture2D:pixels can't be null.";var i=this._width,_=this._height,r=$.instance,a=this._glTextureType;Bt.bindTexture(r,a,this._glTexture);var n=this._getGLFormat();r.texImage2D(a,e,n,i,_,0,n,5121,t),this._mipmap&&this._isPot(i)&&this._isPot(_)?(r.generateMipmap(a),this._setGPUMemory(i*_*4*(1+1/3))):this._setGPUMemory(i*_*4),this._canRead&&(this._pixels=t),this._readyed=!0,this._activeResource()},_.setCompressData=function(t){switch(this._format){case 3:case 4:this._pharseDDS(t);break;case 5:this._pharseKTX(t);break;case 9:case 10:case 11:case 12:this._pharsePVR(t);break;default:throw"Texture2D:unkonwn format."}},_._recoverResource=function(){},_.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},a(0,_,"defaulteTexture",function(){return laya.webgl.resource.Texture2D.grayTexture}),e.__init__=function(){var t=new Uint8Array(3);t[0]=128,t[1]=128,t[2]=128,(e.grayTexture=new e(1,1,0,!1,!1)).setPixels(t),e.grayTexture.lock=!0},e._parse=function(t,i,_){var r=_?new e(_[0],_[1],_[2],_[3],_[4]):new e(0,0);switch(i&&(r.wrapModeU=i.wrapModeU,r.wrapModeV=i.wrapModeV,r.filterMode=i.filterMode,r.anisoLevel=i.anisoLevel),r._format){case 0:case 1:r.loadImageSource(t);break;case 3:case 4:case 5:case 9:case 10:case 11:case 12:r.setCompressData(t);break;default:throw"Texture2D:unkonwn format."}return r},e.load=function(t,e){i.loader.create(t,e,null,"TEXTURE2D")},e.grayTexture=null,e}(),re=function(t){function e(t,i,_,r,a){this._params2dQuick2=null,this._shaderValueWidth=0,this._shaderValueHeight=0,e.__super.call(this,t,i,_,r,a)}r(e,"laya.webgl.shader.d2.Shader2X",t);var i=e.prototype;return i._disposeResource=function(){t.prototype._disposeResource.call(this),this._params2dQuick2=null},i.upload2dQuick2=function(t){this.upload(t,this._params2dQuick2||this._make2dQuick2())},i._make2dQuick2=function(){if(!this._params2dQuick2){this._params2dQuick2=[];for(var t,e=this._params,i=0,_=e.length;i<_;i++)"size"!==(t=e[i]).name&&this._params2dQuick2.push(t)}return this._params2dQuick2},e.create=function(t,i,_,r,a){return new e(t,i,_,r,a)},e}(te),ae=function(t){function e(t){this._uint16Array=null,void 0===t&&(t=35044),e.__super.call(this),this._bufferUsage=t,this._bufferType=34963,this._buffer=new ArrayBuffer(8)}r(e,"laya.webgl.utils.IndexBuffer2D",ee);var i=e.prototype;return i._checkArrayUse=function(){this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},i.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},i._bindForVAO=function(){$.instance.bindBuffer(34963,this._glBuffer)},i.bind=function(){return Qt._bindedIndexBuffer!==this._glBuffer&&($.instance.bindBuffer(34963,this._glBuffer),Qt._bindedIndexBuffer=this._glBuffer,!0)},i.destory=function(){this._uint16Array=null,this._buffer=null},i.disposeResource=function(){this._disposeResource()},e.create=function(t){return void 0===t&&(t=35044),new e(t)},e}(),ne=function(t){function e(t,i){this._floatArray32=null,this._uint32Array=null,this._vertexStride=0,e.__super.call(this),this._vertexStride=t,this._bufferUsage=i,this._bufferType=34962,this._buffer=new ArrayBuffer(8),this._floatArray32=new Float32Array(this._buffer),this._uint32Array=new Uint32Array(this._buffer)}r(e,"laya.webgl.utils.VertexBuffer2D",ee);var i=e.prototype;return i.getFloat32Array=function(){return this._floatArray32},i.appendArray=function(t){var e=this._byteLength>>2;this.setByteLength(this._byteLength+4*t.length);this.getFloat32Array().set(t,e),this._upload=!0},i._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer)),this._uint32Array&&(this._uint32Array=new Uint32Array(this._buffer))},i.deleteBuffer=function(){this._disposeResource()},i._bindForVAO=function(){$.instance.bindBuffer(34962,this._glBuffer)},i.bind=function(){return Qt._bindedVertexBuffer!==this._glBuffer&&($.instance.bindBuffer(34962,this._glBuffer),Qt._bindedVertexBuffer=this._glBuffer,!0)},i.destroy=function(){laya.resource.Resource.prototype.destroy.call(this),this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},a(0,i,"vertexStride",function(){return this._vertexStride}),e.create=function(t,i){return void 0===i&&(i=35048),new e(t,i)},e}();i.__init([lt,nt,It,Lt])}(window,document,Laya);