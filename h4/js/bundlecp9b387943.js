var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,a){t.__proto__=a}||function(t,a){for(var e in a)a.hasOwnProperty(e)&&(t[e]=a[e])};return function(a,e){function r(){this.constructor=a}t(a,e),a.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();!function(){function t(a,e,r){function o(i,s){if(!e[i]){if(!a[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(n)return n(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var h=e[i]={exports:{}};a[i][0].call(h.exports,function(t){return o(a[i][1][t]||t)},h,h.exports,t,a,e,r)}return e[i].exports}for(var n="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}return t}()({1:[function(t,a,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.init=function(){},t.width=1136,t.height=640,t.scaleMode="exactfit",t.screenMode="showall",t.alignV="center",t.alignH="middle",t.startScene="",t.sceneRoot="",t.debug=!1,t.stat=!1,t.physicsDebug=!1,t.exportSceneToJson=!0,t}();e.default=r,r.init()},{}],2:[function(t,a,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t("./GameConfig"),o=t("./wmyUtilsH5/Wmy_Load_Mag");new(function(){function t(){window.Laya3D?Laya3D.init(r.default.width,r.default.height):Laya.init(r.default.width,r.default.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=r.default.scaleMode,Laya.stage.screenMode=r.default.screenMode,Laya.stage.screenMode=Laya.Stage.SCREEN_HORIZONTAL,Laya.URL.exportSceneToJson=r.default.exportSceneToJson,(r.default.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),r.default.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),r.default.stat&&Laya.Stat.show(),Laya.alertGlobalError=!0,Laya.ResourceVersion.enable("version.json?"+Date.now(),Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}return t.prototype.onVersionLoaded=function(){Laya.stage.addChild(fairygui.GRoot.inst.displayObject),o.Wmy_Load_Mag.getThis.onLoadWetData("res/loadInfo.json",Laya.Handler.create(this,this.onLoadLoad))},t.prototype.onLoadLoad=function(){var t=o.Wmy_Load_Mag.getThis.getResObj("load");null!=t&&o.Wmy_Load_Mag.getThis.onload(t,new Laya.Handler(this,this.onLoadMain))},t.prototype.onLoadMain=function(){this._loadView=fairygui.UIPackage.createObject("load","Load").asCom,fairygui.GRoot.inst.addChild(this._loadView),this._bar=this._loadView.getChild("bar").asProgress,o.Wmy_Load_Mag.getThis.onAutoLoadAll(new Laya.Handler(this,this.onLoadOk),new Laya.Handler(this,this.onLoading))},t.prototype.onLoading=function(t){this._bar.value=t},t.prototype.onLoadOk=function(t,a){var e=this;this._u3dArr=a,Laya.timer.once(400,this,function(){e.onMain(),fairygui.GRoot.inst.removeChild(e._loadView),e._loadView=null,e._bar=null});var r=a[0].urlList[0];this.scene3D=Laya.loader.getRes(r)},t.prototype.onMain=function(){this._mainView=fairygui.UIPackage.createObject("main","Main").asCom,fairygui.GRoot.inst.addChild(this._mainView),Laya.stage.addChildAt(this.scene3D,0)},t}())},{"./GameConfig":1,"./wmyUtilsH5/Wmy_Load_Mag":4}],3:[function(t,a,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){function a(){var a=t.call(this)||this;return a._eventList=new Array,Laya.stage.on(laya.events.Event.MOUSE_DOWN,a,a.__onTouchDown),Laya.stage.on(laya.events.Event.MOUSE_UP,a,a.__onTouchUp),Laya.stage.on(laya.events.Event.MOUSE_MOVE,a,a.__OnMouseMOVE),Laya.stage.on(Laya.Event.RESIZE,a,a.__onResize),a}return __extends(a,t),Object.defineProperty(a,"getThis",{get:function(){return null==a._this&&(a._this=new a),a._this},enumerable:!0,configurable:!0}),a.prototype.convertColorToColorFiltersMatrix=function(t,e,r,o){return a.COLOR_FILTERS_MATRIX[0]=t,a.COLOR_FILTERS_MATRIX[6]=e,a.COLOR_FILTERS_MATRIX[12]=r,a.COLOR_FILTERS_MATRIX[18]=o||1,a.COLOR_FILTERS_MATRIX},a.prototype.applyColorFilters=function(t,a){t.filters=null,16777215!=a&&(t.filters=[new Laya.ColorFilter(this.convertColorToColorFiltersMatrix((a>>16&255)/255,(a>>8&255)/255,(255&a)/255))])},a.prototype.applyColorFilters1=function(t,a,e,r,o){t.filters=null,(a<1||e<1||r<1||o<1)&&(t.filters=[new Laya.ColorFilter(this.convertColorToColorFiltersMatrix(a,e,r,o))])},a.prototype.isPc=function(){return!(this.versions().android||this.versions().iPhone||this.versions().ios)&&(this.versions().iPad,!0)},a.prototype.versions=function(){var t=navigator.userAgent;navigator.appVersion;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&-1==t.indexOf("KHTML"),mobile:!!t.match(/AppleWebKit.*Mobile.*/)||!!t.match(/AppleWebKit/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:-1==t.indexOf("Safari")}},a.getUrlV=function(t){var a=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),e=window.location.search.substr(1).match(a);return e?decodeURIComponent(e[2]):null},a.prototype.onNavigate=function(t,a){void 0===a&&(a=!1),a?window.location.replace(t):window.location.href=t},a.prototype.__onTouchDown=function(t){this._eventList.indexOf(t)<0&&this._eventList.push(t)},a.prototype.__onTouchUp=function(t){this._eventList.indexOf(t)>=0&&this._eventList.splice(this._eventList.indexOf(t),1)},a.prototype.__onResize=function(){this._eventList.forEach(function(t){t.type=Laya.Event.MOUSE_UP,Laya.stage.event(Laya.Event.MOUSE_UP,t)}),this._eventList=new Array},a.prototype.__OnMouseMOVE=function(t){(t.stageX<=10||t.stageX>=Laya.stage.width-10||t.stageY<=10||t.stageY>=Laya.stage.height-10)&&(t.type=Laya.Event.MOUSE_UP,Laya.stage.event(Laya.Event.MOUSE_UP,t))},a.onNumTo=function(t,a){return void 0===a&&(a=2),(t+"").indexOf(".")>=0&&(t=parseFloat(t.toFixed(a))),t},a.getR_XY=function(t,a){var e=a*Math.PI/180,r=t*Math.cos(e),o=t*Math.sin(e);return new Laya.Point(r,o)},a.string2buffer=function(t){for(var a="",e=0;e<t.length;e++)""===a?a=t.charCodeAt(e).toString(16):a+=","+t.charCodeAt(e).toString(16);return new Uint8Array(a.match(/[\da-f]{2}/gi).map(function(t){return parseInt(t,16)})).buffer},a.replaceAll=function(t,a,e){var r="";return(r=t.replace(a,e)).indexOf(a)>=0&&(r=this.replaceAll(r,a,e)),r},a.toCase=function(t,a){void 0===a&&(a=!1);return a?t.toUpperCase():t.toLowerCase()},a.getDistance=function(t,a){var e=Math.abs(t.x-a.x),r=Math.abs(t.y-a.y),o=Math.sqrt(Math.pow(e,2)+Math.pow(r,2));return o=parseFloat(o.toFixed(2))},a.getXyToR=function(t,a){var e=Math.atan2(t,a),r=180/Math.PI*e;return r=this.onNumTo(r)},a.storage=function(t,a,e){void 0===a&&(a="?"),void 0===e&&(e=!0);var r=e?localStorage:sessionStorage;if("?"==a){return r.getItem(t)}return null!=a?(r.setItem(t,a),a):(r.removeItem(t),null)},a.playFuiSound=function(t,a,e,r,o){if(void 0===a&&(a=.2),void 0===r&&(r=0),void 0===o&&(o=1),!(a<=0)){var n=fairygui.UIPackage.getItemByURL(t).file;Laya.SoundManager.playSound(n,o,e,null,r),Laya.SoundManager.setSoundVolume(a,n)}},a.COLOR_FILTERS_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],a}(laya.events.EventDispatcher);e.WmyUtils=r},{}],4:[function(t,a,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t("./WmyUtils"),o=t("./d3/WmyLoad3d"),n=function(){function t(){this._wetData={},this.resUrl="",this._resDataArr=[],this._callbackOk=[],this._callbackProgress=[]}return Object.defineProperty(t,"getThis",{get:function(){return null==t._this&&(t._this=new t),t._this},enumerable:!0,configurable:!0}),t.prototype.getWetData=function(t){return this._wetData[t]},t.prototype.setWetData=function(a,e){if(""==this.resUrl){this.resUrl=e;var r=null;try{r=JSON.parse(a)}catch(t){}try{var o=r[0].assetUrl;!t.isDebug&&document.URL.indexOf("file:///")>=0&&(o=""),t.assetUrl=o}catch(t){}}null==e&&(e=this.resUrl),this._wetData[e]=a},t.prototype.getResObj=function(t,a){var e;if(null==a&&(a=this.resUrl),null==(e=this.getWetData(a)))return console.log("空数据"),null;var r=null;if(e instanceof Array&&(r=e),null==r)try{r=JSON.parse(e)}catch(t){return console.log("加载材料数据错误",e),null}for(var o=null,n=0;n<r.length;n++){var i=r[n];if(i.resName==t){o=i;break}}return o},t.prototype.onLoadWetData=function(t,a){if(""!=t){if(null==this.getWetData(t)){return Laya.loader.load(t,new Laya.Handler(this,function(e){this.setWetData(e,t),a.runWith([this._wetData[t]])}))}a.runWith([this.getWetData(t)])}},t.prototype.onload=function(a,e,o){var n=a.resName;if(null!=this._resDataArr[n])this._resDataArr[n].runWith([this._resDataArr[n]]);else{if(null!=this._callbackOk[n])return this._callbackOk[n].push(e),void(null!=o&&this._callbackProgress[n].push(o));this._callbackOk[n]=[],this._callbackOk[n].push(e),this._callbackProgress[n]=[],null!=o&&this._callbackProgress[n].push(o);var i=a.Resres,s={},l=a.resData;if(null!=l&&""!=l)try{s=JSON.parse(l)}catch(t){console.log("加载材料数据错误",l)}for(var u,h=[],c=0;c<i.length;c++){var d=i[c].resUrl;d=r.WmyUtils.toCase(d);var f=t.assetUrl+d;f.indexOf(".txt")>=0?(h.push({url:f,type:Laya.Loader.BUFFER}),u=d):f.indexOf(".jpg")>=0||f.indexOf(".png")>=0?h.push({url:f,type:Laya.Loader.IMAGE}):f.indexOf(".mp3")>=0||f.indexOf(".wav")>=0?h.push({url:f,type:Laya.Loader.SOUND}):h.push({url:f})}Laya.loader.load(h,Laya.Handler.create(this,this.onAssetConmplete,[n,u,s]),Laya.Handler.create(this,this.onAssetProgress,[n],!1))}},t.prototype.onload3d=function(a,e,r){var n=a.resName;if(null!=this._resDataArr[n])this._resDataArr[n].runWith([this._resDataArr[n]]);else{if(null!=this._callbackOk[n])return this._callbackOk[n].push(e),void(null!=r&&this._callbackProgress[n].push(r));this._callbackOk[n]=[],this._callbackOk[n].push(e),this._callbackProgress[n]=[],null!=r&&this._callbackProgress[n].push(r);var i=a.Resres,s={},l=a.resData;if(null!=l&&""!=l)try{s=JSON.parse(l)}catch(t){console.log("加载材料数据错误",l)}for(var u=[],h=[],c=0;c<i.length;c++){var d=i[c].resUrl,f=t.assetUrl+d;d.indexOf(".ls")>=0&&(u.push({url:f}),h.push(f))}s.urlList=h,o.WmyLoad3d.getThis.onload3d(u,Laya.Handler.create(this,this.onAssetConmplete,[n,void 0,s]),Laya.Handler.create(this,this.onAssetProgress,[n],!1))}},t.prototype.onAssetProgress=function(t,a){for(var e=this._callbackProgress[t],r=0;r<e.length;r++){e[r].runWith([a])}},t.prototype.onAssetConmplete=function(t,a,e){var r=this._callbackOk[t];if(null!=a){var o=Laya.loader.getRes(a),n=a.replace(".txt","");fairygui.UIPackage.addPackage(n,o);var i=n.split("/");e.bName=i[i.length-1],this._resDataArr[t]=e}for(var s=0;s<r.length;s++){r[s].runWith([e])}this._callbackOk[t]=null,this._callbackProgress[t]=null},t.prototype.onAutoLoadAll=function(t,a){var e=this.getWetData(this.resUrl);if(null==e)return console.log("空数据"),null;var r=null;if(e instanceof Array&&(r=e),null==r)try{r=JSON.parse(e)}catch(t){return console.log("加载材料数据错误",e),null}this._autoLoadrCallbackOk=t,this._autoLoadrCallbackProgress=a,this._autoLoadInfoArr={},this._autoLoadInfoArr.num=0,this._autoLoadInfoArr.cNum=0,this._autoLoadInfoArr.uiArr=[],this._autoLoadInfoArr.u3dArr=[];for(var o=0;o<r.length;o++){var n=r[o],i=n.resName,s=n.type;null!=i&&""!=i&&null!=s&&""!=s&&this.onAutoLoadObj(s,i)}},t.prototype.onAutoLoadObj=function(a,e){var r=this.getResObj(e);if(null!=r){var o=this._autoLoadInfoArr.num;if(this._autoLoadInfoArr[o]={},this._autoLoadInfoArr[o].n=e,this._autoLoadInfoArr[o].t=a,"ui"==a)this.onload(r,new Laya.Handler(this,this.onLoadOk,[o]),new Laya.Handler(this,this.onLoading,[o])),this._autoLoadInfoArr.num+=1;else if("mats"==a){for(var n=r.Resres,i=[],s=0;s<n.length;s++){var l=(h=n[s]).resUrl,u=t.assetUrl+l;i.push(u)}this._autoLoadInfoArr.num+=1}else if("cubeMap"==a)for(var n=r.Resres,s=0;s<n.length;s++){var h=n[s],l=h.resUrl,u=t.assetUrl+l;Laya.TextureCube.load(u,null)}else"u3d"==a?(this.onload3d(r,new Laya.Handler(this,this.onLoadOk,[o]),new Laya.Handler(this,this.onLoading,[o])),this._autoLoadInfoArr.num+=1):"audio"==a&&(this.onload(r,new Laya.Handler(this,this.onLoadOk,[o]),new Laya.Handler(this,this.onLoading,[o])),this._autoLoadInfoArr.num+=1)}},t.prototype.getCube=function(a,e){var r=this.getResObj(a);if(null!=r){for(var o=r.Resres,n=[],i=0;i<o.length;i++){var s=o[i].resUrl,l=t.assetUrl+s;Laya.TextureCube.load(l,new Laya.Handler(this,function(t){n[i]=t,e.runWith([t,i])}))}return n}},t.prototype.onLoading=function(t,a){this._autoLoadInfoArr[t].p=a;for(var e=this._autoLoadInfoArr.num,r=0,o=0;o<e;o++){var n=this._autoLoadInfoArr[o].p;null!=n&&(r+=n)}var i=r/this._autoLoadInfoArr.num*100;isNaN(i)&&(i=0),null!=this._autoLoadrCallbackProgress&&this._autoLoadrCallbackProgress.runWith([i])},t.prototype.onLoadOk=function(t,a){this._autoLoadInfoArr.cNum+=1,"ui"==this._autoLoadInfoArr[t].t?this._autoLoadInfoArr.uiArr.push(a):"u3d"==this._autoLoadInfoArr[t].t&&this._autoLoadInfoArr.u3dArr.push(a),this._autoLoadInfoArr.cNum>=this._autoLoadInfoArr.num&&null!=this._autoLoadrCallbackOk&&this._autoLoadrCallbackOk.runWith([this._autoLoadInfoArr.uiArr,this._autoLoadInfoArr.u3dArr])},t.isDebug=!1,t.assetUrl="",t}();e.Wmy_Load_Mag=n},{"./WmyUtils":3,"./d3/WmyLoad3d":5}],5:[function(t,a,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this._mArr=[],this._mNum=0,this._mP=0,this._mP2=0}return Object.defineProperty(t,"getThis",{get:function(){return null==t._this&&(t._this=new t),t._this},enumerable:!0,configurable:!0}),t.prototype.onload3d=function(t,a,e){this._urlList=[],this._callbackOk=a,this._callbackProgress=e;for(var r=0;r<t.length;r++){var o=t[r],n={};n.url=o.url,this._urlList.push(n),o.url=Laya.ResourceVersion.addVersionPrefix(o.url),o.url+="?wmy",t[r]=o}Laya.loader.load(t,Laya.Handler.create(this,this.__onlsUrlArrOk,[t]))},t.prototype.__onlsUrlArrOk=function(t){for(i=0;i<t.length;i++){var a=t[i].url,e=a.split("/"),r=a.replace(e[e.length-1],""),o=Laya.loader.getRes(a),n=JSON.parse(o);this.__tiQuUrl(n.data,r)}for(var i=0;i<this._mArr.length;i++)a=this._mArr[i],Laya.loader.create(a,Laya.Handler.create(this,this.__onArrOk),Laya.Handler.create(this,this.__onArrP))},t.prototype.__onArrP=function(t){(a=t*(this._mNum+1))>this._mP&&(this._mP=a),this._mP2=this._mP/this._mArr.length;var a=.98*this._mP2;null!=this._callbackProgress&&this._callbackProgress.runWith([a])},t.prototype.__onArrOk=function(){var t=this;this._mNum+=1,this._mNum>=this._mArr.length&&Laya.loader.create(this._urlList,Laya.Handler.create(this,function(){null!=t._callbackOk&&t._callbackOk.run()}))},t.prototype.__tiQuUrl=function(t,a){if(void 0===a&&(a=""),null!=t.props&&null!=t.props.meshPath){var e=a+t.props.meshPath;this._mArr.indexOf(e)<0&&this._mArr.push(e);var r=t.props.materials;if(null!=r)for(var o=0;o<r.length;o++){var n=a+r[o].path;this._mArr.indexOf(n)<0&&this._mArr.push(n)}}if(null!=t.components){var i=t.components;if(i.length>0)for(var s=0;s<i.length;s++){var l=i[s];if(null!=l.avatar){var u=a+l.avatar.path;this._mArr.indexOf(u)<0&&this._mArr.push(u)}if(null!=l.layers)for(var h=l.layers,c=0;c<h.length;c++)for(var d=h[c].states,f=0;f<d.length;f++){var _=a+d[f].clipPath;this._mArr.indexOf(_)<0&&this._mArr.push(_)}}}var p=t.child;if(null!=p&&p.length>0)for(var y=0;y<p.length;y++)this.__tiQuUrl(p[y],a)},t}();e.WmyLoad3d=r},{}]},{},[2]);