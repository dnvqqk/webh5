var WmyShaderMsg=function(){function e(){}return e.setShader=function(e,t,a,r,l,n){void 0===r&&(r=!1),void 0===l&&(l="null"),void 0===n&&(n="null");var s,i;i=e instanceof Laya.SkinnedMeshSprite3D?(s=e.skinnedMeshRenderer).sharedMaterial:(s=e.meshRenderer).sharedMaterial,r&&(i=i.clone(),s.sharedMaterial=i);for(var u in t)try{i[u]=t[u]}catch(e){}return Laya.loader.load(a,Laya.Handler.create(this,this.shaderConmplete,[i,l,n]),null,Laya.Loader.XML),i},e.shaderConmplete=function(e,t,a,r){if(null!=r){var l,n,s,i,u,o,d=r.firstChild,h=this.getAttributesValue(d,"name"),g={},f=this.getNode(d,"attributeMap"),c=this.getNodeArr(f,"data");for(l=0;l<c.length;l++)n=c[l],s=this.getAttributesValue(n,"name"),i=this.getAttributesValue(n,"v0"),g[s]=this.getV(i,"int");var V={},v=this.getNode(d,"uniformMap"),p=this.getNodeArr(v,"data");for(l=0;l<p.length;l++){o=null,n=p[l],s=this.getAttributesValue(n,"name"),i=this.getAttributesValue(n,"v0"),u=this.getAttributesValue(n,"v1");var y=[];if(y[0]=this.getV(i,"int"),y[1]=this.getV(u,"int"),V[s]=y,null!=e.wmyValues){if(null!=e.wmyValues.cube){var N=e.wmyValues.cube;Wmy_Load_Mag.getThis.getCube(N,new Laya.Handler(this,function(t,a){0==a&&e._shaderValues.setTexture(Laya.Scene3D.REFLECTIONTEXTURE,t)}))}o=e.wmyValues[s]}if(null!=o)if(4==(o=o.split(",")).length)e._shaderValues.setVector(y[0],new Laya.Vector4(parseFloat(o[0]),parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3])));else if(3==o.length)e._shaderValues.setVector(y[0],new Laya.Vector3(parseFloat(o[0]),parseFloat(o[1]),parseFloat(o[2])));else if(2==o.length)e._shaderValues.setVector(y[0],new Laya.Vector2(parseFloat(o[0]),parseFloat(o[1])));else if(1==o.length)if(isNaN(parseFloat(o[0]))){if("tex"==o[0]+""){var b=e[s];e._shaderValues.setTexture(y[0],b)}}else e._shaderValues.setNumber(y[0],parseFloat(o[0]))}"null"==t&&(t=Laya.SkinnedMeshSprite3D.shaderDefines),"null"==a&&(a=Laya.BlinnPhongMaterial.shaderDefines);var L=Laya.Shader3D.add(h,g,V,t,a),m=this.getNode(d,"SubShader"),M=this.getNode(d,"renderMode");if(null!=M){var S=this.getAttributesValue(M,"v");null!=S&&(e.renderMode=this.getV(S))}var A=this.getNodeArr(m,"Pass");for(l=0;l<A.length;l++){var F=A[l],_=this.getNode(F,"VERTEX").textContent;_=_.replace(/(\r)/g,"");var T=this.getNode(F,"FRAGMENT").textContent;if(T=T.replace(/(\r)/g,""),l>0){var w=e.getRenderState(0).clone();e._renderStates.push(w)}var R=this.getNode(F,"cull");if(null!=R){var C=this.getAttributesValue(R,"v");null!=C&&(e.getRenderState(l).cull=this.getV(C))}L._addShaderPass(_,T)}e._shader=L}},e.getV=function(e,t){void 0===t&&(t="null");var a,r,l;for("Laya"===(a=e.split("."))[0]?r=Laya:"laya"===a[0]&&(r=laya),l=1;l<a.length;l++)r=r[a[l]];return null!=r?r:"null"!=t?"int"==t?parseInt(e):e:null},e.colorStringToUint=function(e){return Number("0x"+e.replace("#",""))},e.getAttributesValue=function(e,t){return t in e.attributes?e.attributes[t].nodeValue:null},e.getNode=function(e,t){for(var a=e.childNodes,r=null,l=0;l<a.length;l++){var n=a[l];if(n.nodeName==t){r=n;break}}return r},e.getNodeArr=function(e,t){for(var a=e.childNodes,r=[],l=0;l<a.length;l++){var n=a[l];n.nodeName==t&&r.push(n)}return r},e}();