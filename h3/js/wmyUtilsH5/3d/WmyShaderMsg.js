var WmyShaderMsg=function(){function e(){}return e.setShader=function(e,t,a,r,l,n){void 0===r&&(r=!1),void 0===l&&(l="null"),void 0===n&&(n="null");var s,i;i=e instanceof Laya.SkinnedMeshSprite3D?(s=e.skinnedMeshRenderer).sharedMaterial:(s=e.meshRenderer).sharedMaterial,r&&(i=i.clone(),s.sharedMaterial=i);for(var u in t)try{i[u]=t[u]}catch(e){}return Laya.loader.load(a,Laya.Handler.create(this,this.shaderConmplete,[i,l,n])),i},e.shaderConmplete=function(e,t,a,r){if(null!=r){var l=null;try{l=Laya.Utils.parseXMLFromString(r)}catch(e){return}var n,s,i,u,o,h,d=l.firstChild,g=this.getAttributesValue(d,"name"),f={},c=this.getNode(d,"attributeMap"),V=this.getNodeArr(c,"data");for(n=0;n<V.length;n++)s=V[n],i=this.getAttributesValue(s,"name"),u=this.getAttributesValue(s,"v0"),f[i]=this.getV(u,"int");var v={},p=this.getNode(d,"uniformMap"),y=this.getNodeArr(p,"data");for(n=0;n<y.length;n++){h=null,s=y[n],i=this.getAttributesValue(s,"name"),u=this.getAttributesValue(s,"v0"),o=this.getAttributesValue(s,"v1");var N=[];if(N[0]=this.getV(u,"int"),N[1]=this.getV(o,"int"),v[i]=N,null!=e.wmyValues){if(null!=e.wmyValues.cube){var b=e.wmyValues.cube;Wmy_Load_Mag.getThis.getCube(b,new Laya.Handler(this,function(t,a){0==a&&e._shaderValues.setTexture(Laya.Scene3D.REFLECTIONTEXTURE,t)}))}h=e.wmyValues[i]}if(null!=h)if(4==(h=h.split(",")).length)e._shaderValues.setVector(N[0],new Laya.Vector4(parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3])));else if(3==h.length)e._shaderValues.setVector(N[0],new Laya.Vector3(parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])));else if(2==h.length)e._shaderValues.setVector(N[0],new Laya.Vector2(parseFloat(h[0]),parseFloat(h[1])));else if(1==h.length)if(isNaN(parseFloat(h[0]))){if("tex"==h[0]+""){var m=e[i];e._shaderValues.setTexture(N[0],m)}}else e._shaderValues.setNumber(N[0],parseFloat(h[0]))}"null"==t&&(t=Laya.SkinnedMeshSprite3D.shaderDefines),"null"==a&&(a=Laya.BlinnPhongMaterial.shaderDefines);var L=Laya.Shader3D.add(g,f,v,t,a),S=this.getNode(d,"SubShader"),M=this.getNode(d,"renderMode");if(null!=M){var A=this.getAttributesValue(M,"v");null!=A&&(e.renderMode=this.getV(A))}var F=this.getNodeArr(S,"Pass");for(n=0;n<F.length;n++){var _=F[n],T=this.getNode(_,"VERTEX").textContent;T=T.replace(/(\r)/g,"");var w=this.getNode(_,"FRAGMENT").textContent;if(w=w.replace(/(\r)/g,""),n>0){var R=e.getRenderState(0).clone();e._renderStates.push(R)}var C=this.getNode(_,"cull");if(null!=C){var E=this.getAttributesValue(C,"v");null!=E&&(e.getRenderState(n).cull=this.getV(E))}L._addShaderPass(T,w)}e._shader=L}},e.getV=function(e,t){void 0===t&&(t="null");var a,r,l;for("Laya"===(a=e.split("."))[0]?r=Laya:"laya"===a[0]&&(r=laya),l=1;l<a.length;l++)r=r[a[l]];return null!=r?r:"null"!=t?"int"==t?parseInt(e):e:null},e.colorStringToUint=function(e){return Number("0x"+e.replace("#",""))},e.getAttributesValue=function(e,t){return t in e.attributes?e.attributes[t].nodeValue:null},e.getNode=function(e,t){for(var a=e.childNodes,r=null,l=0;l<a.length;l++){var n=a[l];if(n.nodeName==t){r=n;break}}return r},e.getNodeArr=function(e,t){for(var a=e.childNodes,r=[],l=0;l<a.length;l++){var n=a[l];n.nodeName==t&&r.push(n)}return r},e}();